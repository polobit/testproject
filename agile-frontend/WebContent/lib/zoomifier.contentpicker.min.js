function loadFrame(){$.getScript("http://ve1.zoomifier.net/js/porthole.min.js",function(){windowProxy2=new Porthole.WindowProxy(servername+"docselect",currentPickerWindow.framename);windowProxy2.addEventListener(onMessage);currentPickerWindow.frameInstace.setAttribute("src",servername+"docselect")})}function calculateDialogDimensions(){screenWidth=$(window).width();screenHeight=$(window).height()-100;var e=3/4;if(screenWidth<screenHeight){dialogWidth=screenWidth*.9;dialogHeight=dialogWidth*3/4}else{dialogHeight=screenHeight*.9;dialogWidth=dialogHeight*4/3}leftPad=(screenWidth-dialogWidth)/2;topPad=(screenHeight-dialogHeight)/2+100}function closePicker(){currentPickerWindow=undefined;$(".zpicker-dialog").remove();$(".zpicker-dialog-bg").remove();$("#zpickerstyle").remove();windowProxy2.removeEventListener(onMessage)}function onMessage(e){if(e.data.action=="close"){closePicker()}else if(e.data.script!=undefined){if(currentPickerWindow!=undefined){if(currentPickerWindow.selectionHandler!=undefined){currentPickerWindow.selectionHandler(e.data.script)}}closePicker()}else if(e.data.connection=="started"){windowProxy2.post({init:currentPickerWindow.salesUser+"&"+currentPickerWindow.targetCustomer+"&"+currentPickerWindow.partnerkey})}}(function(){var e=document.getElementsByTagName("SCRIPT");var t="";if(e&&e.length>0){for(var n in e){if(e[n].src&&e[n].src.match(/zoomifier.contentpicker.js/)){t=e[n].src}}}var r=/onload=([^&]+)/;if(r.exec(t)!=undefined&&r.exec(t)[1]!=undefined&&r.exec(t)[1]!="")window[r.exec(t)[1]]()})();var Zoomifier={PickerBuilder:function(){this.selectionHandler=undefined;this.salesUser=undefined;this.partnerkey=undefined;this.targetCustomer=undefined;this.framename="docselframe";this.frameInstace=undefined;currentPickerWindow=this;this.setCallback=function(e){this.selectionHandler=e;return this};this.setSalesUser=function(e){this.salesUser=e;return this};this.setTargetCustomer=function(e){this.targetCustomer=e;return this};this.setPartnerKey=function(e){this.partnerkey=e;return this};this.build=function(){if($("#zpickerstyle").length==0){calculateDialogDimensions();var e=document.createElement("style");e.setAttribute("id","zpickerstyle");e.setAttribute("type","text/css");e.innerHTML=".zpicker-dialog-frame{width:100%;height:100%;border:0;overflow:hidden}.zpicker-dialog-bg{position:absolute;top:0;left:0;background-color:#fff}.zpicker-dialog{position:absolute;top:0;left:0;background-color:#fff;border:1px solid #acacac;width:auto;padding:0;z-index:1001;overflow:auto;-moz-box-shadow:rgba(0,0,0,.2) 0 4px 16px;-webkit-box-shadow:rgba(0,0,0,.2) 0 4px 16px;box-shadow:rgba(0,0,0,.2) 0 4px 16px}.zpicker-dialog-content{font-size:0;padding:0}.zpicker-dialog-title,.zpicker-dialog-buttons{display:none}";(document.head||document.body||document.documentElement).appendChild(e);var t=document.createElement("div");t.setAttribute("class","zpicker zpicker-dialog-bg");t.setAttribute("style","opacity: 0.5; width: "+screenWidth+"px; height: "+screenHeight+"px;");var n=document.createElement("div");n.setAttribute("class","zpicker zpicker-dialog");n.setAttribute("tabindex","0");n.setAttribute("role","dialog");n.setAttribute("style","left: "+leftPad+"px; top: "+topPad+"px;");var r=document.createElement("div");r.setAttribute("class","zpicker zpicker-dialog-content");r.setAttribute("style","width: "+dialogWidth+"px; height: "+dialogHeight+"px;");this.frameInstace=document.createElement("iframe");this.frameInstace.setAttribute("id",currentPickerWindow.framename);this.frameInstace.setAttribute("name",currentPickerWindow.framename);this.frameInstace.setAttribute("src",'data:text/html;charset=utf-8,%3Chtml%3E%3Cbody%3E %3Cimg src="http://ve4.zoomifier.net/agilecrm/bigLoader.gif"%3E %3C/body%3E%3C/html%3E');this.frameInstace.setAttribute("class","zpicker-frame zpicker-dialog-frame");this.frameInstace.setAttribute("frameborder","0");r.appendChild(this.frameInstace);n.appendChild(r);document.body.appendChild(t);document.body.appendChild(n);setTimeout(loadFrame,1)}return this}}};var currentPickerWindow=undefined;var servername="http://ve4.zoomifier.net/agilecrm/";var screenWidth=$(window).width();var screenHeight=$(window).height();var dialogWidth=566;var dialogHeight=350;var leftPad=(screenWidth-dialogWidth)/2;var topPad=(screenHeight-dialogHeight)/2;$(window).resize(function(){if(currentPickerWindow!=undefined){calculateDialogDimensions();$(".zpicker-dialog").css("left",leftPad+"px");$(".zpicker-dialog").css("top",topPad+"px");$(".zpicker-dialog-content").css("width",dialogWidth+"px");$(".zpicker-dialog-content").css("height",dialogHeight+"px");$(".zpicker-dialog-bg").css("width",screenWidth+"px");$(".zpicker-dialog-bg").css("height",screenHeight+"px")}});var windowProxy2