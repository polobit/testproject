function showQuickbooksContacts(){if(!Email){quickBooksError("Please provide email for this contact");return}console.log("In show Quickbooks Client"+QUICKBOOKS_PLUGIN_ID);var c=[];for(var a=0;a<EmailList.length;a++){c[a]=EmailList[a].value}queueGetRequest("widget_queue","/core/api/widgets/quickbooks/contacts/"+QUICKBOOKS_PLUGIN_ID+"/"+c,"json",function b(f){console.log("QuickBooks");console.log(f);if(f){var e=$("#"+QUICKBOOKS_PLUGIN_NAME).html(getTemplate("quickbooks-profile",f));console.log("libpath is"+LIB_PATH);console.log(e);head.js(LIB_PATH+"lib/jquery.timeago.js",function(){$(".time-ago",e).timeago()})}else{quickBooksError(f.responseText)}},function d(e){console.log("In Quickbooks error ");console.log(e.responseText);if(e.responseText=="Contact not Found"){$("#"+QUICKBOOKS_PLUGIN_NAME).html(getTemplate("quickbooks-profile-addcontact",{}))}else{if(e.responseText.indexOf("Exception Timeout while fetching")!=-1){quickBooksError("Timeout while fetching Please refresh ")}else{quickBooksError(e.responseText)}}})}function quickBooksError(b){var a={};a.message=b;console.log("error ");$("#"+QUICKBOOKS_PLUGIN_NAME).html(getTemplate("quickbooks-error",a))}function addContactToQuickbooks(b,a){console.log("in quickbooks add contact");$("#quickbooks_add_contact").attr("disabled",true);$.get("/core/api/widgets/quickbooks/add/contact/"+QUICKBOOKS_PLUGIN_ID+"/"+b+"/"+a+"/"+Email,function(c){console.log("In Quickbooks add contact ");console.log(c);if(c.Status="OK"){showQuickbooksContacts()}else{console.log(c);quickBooksError(c)}$("#quickbooks_add_contact").removeAttr("disabled")}).error(function(c){console.log("data is in add contact error");console.log(c);quickBooksError(c.responseText)})}$(function(){console.log("in quickbooks widget.js");QUICKBOOKS_PLUGIN_NAME="QuickBooks";QUICKBOOKS_PROFILE_LOAD_IMAGE='<center><img id="quickbooks_profile_load" src="img/ajax-loader-cursor.gif" style="margin-top: 10px;margin-bottom: 14px;"></img></center>';var b=agile_crm_get_widget(QUICKBOOKS_PLUGIN_NAME);QUICKBOOKS_PLUGIN_ID=b.id;console.log("plugin Id"+QUICKBOOKS_PLUGIN_ID);Email=agile_crm_get_contact_property("email");EmailList=agile_crm_get_contact_properties_list("email");var a=agile_crm_get_contact_property("first_name");var c=agile_crm_get_contact_property("last_name");if(c==undefined||c==null){c=" "}console.log("Email is"+Email);showQuickbooksContacts();$("#quickbooks_add_contact").die().live("click",function(d){d.preventDefault();addContactToQuickbooks(a,c,Email)})});