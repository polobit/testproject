function showQuickbooksContacts(){if(!Email){quickBooksError("Please provide email for this contact");return}console.log("In show Quickbooks Client"+QUICKBOOKS_PLUGIN_ID);var f=[];for(var h=0;h<EmailList.length;h++){f[h]=EmailList[h].value}queueGetRequest("widget_queue","/core/api/widgets/quickbooks/contacts/"+QUICKBOOKS_PLUGIN_ID+"/"+f,"json",function g(a){console.log("QuickBooks");console.log(a);if(a){var b=$("#"+QUICKBOOKS_PLUGIN_NAME).html(getTemplate("quickbooks-profile",a));console.log("libpath is"+LIB_PATH);console.log(b);head.js(LIB_PATH+"lib/jquery.timeago.js",function(){$(".time-ago",b).timeago()})}else{quickBooksError(a.responseText)}},function e(a){console.log("In Quickbooks error ");console.log(a.responseText);if(a.responseText=="Contact not Found"){$("#"+QUICKBOOKS_PLUGIN_NAME).html(getTemplate("quickbooks-profile-addcontact",{}))}else{if(a.responseText.indexOf("Exception Timeout while fetching")!=-1){quickBooksError("Timeout while fetching Please refresh ")}else{quickBooksError(a.responseText)}}})}function quickBooksError(c){var d={};d.message=c;console.log("error ");$("#"+QUICKBOOKS_PLUGIN_NAME).html(getTemplate("quickbooks-error",d))}function addContactToQuickbooks(c,d){console.log("in quickbooks add contact");$("#quickbooks_add_contact").attr("disabled",true);$.get("/core/api/widgets/quickbooks/add/contact/"+QUICKBOOKS_PLUGIN_ID+"/"+c+"/"+d+"/"+Email,function(a){console.log("In Quickbooks add contact ");console.log(a);if(a.Status="OK"){showQuickbooksContacts()}else{console.log(a);quickBooksError(a)}$("#quickbooks_add_contact").removeAttr("disabled")}).error(function(a){console.log("data is in add contact error");console.log(a);quickBooksError(a.responseText)})}$(function(){console.log("in quickbooks widget.js");QUICKBOOKS_PLUGIN_NAME="QuickBooks";QUICKBOOKS_PROFILE_LOAD_IMAGE='<center><img id="quickbooks_profile_load" src="img/ajax-loader-cursor.gif" style="margin-top: 10px;margin-bottom: 14px;"></img></center>';var f=agile_crm_get_widget(QUICKBOOKS_PLUGIN_NAME);QUICKBOOKS_PLUGIN_ID=f.id;console.log("plugin Id"+QUICKBOOKS_PLUGIN_ID);Email=agile_crm_get_contact_property("email");EmailList=agile_crm_get_contact_properties_list("email");var d=agile_crm_get_contact_property("first_name");var e=agile_crm_get_contact_property("last_name");if(e==undefined||e==null){e=" "}console.log("Email is"+Email);showQuickbooksContacts();$("#quickbooks_add_contact").die().live("click",function(a){a.preventDefault();addContactToQuickbooks(d,e,Email)})});