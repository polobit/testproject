Backbone.View.prototype.close=function(){this.remove();this.unbind();if(this.onClose){this.onClose()}};var BaseModel=Backbone.Model.extend({});var BaseCollection=Backbone.Collection.extend({model:BaseModel,initialize:function(b,a){this.restKey=a.restKey;if(a.sortKey){this.sortKey=a.sortKey}if(a.descending){this.descending=a.descending}this.sort_collection=a.sort_collection;if(this.sort_collection==false){this.comparator=false}},comparator:function(a){if(this.sortKey){if(this.descending==true){return -a.get(this.sortKey)}return a.get(this.sortKey)}return a.get("id")},parse:function(a){if(a&&a[this.restKey]){return a[this.restKey]}return a}});var Base_List_View=Backbone.View.extend({events:{"click .delete":"deleteItem","click .edit":"edit","delete-checked .agile_delete":"deleteItem","click .delete-model":"deleteModel","click .delete-confirm":"deleteConfirm"},initialize:function(){_.bindAll(this,"render","deleteItem","edit","deleteModel");this.model.bind("destroy",this.close,this);this.model.bind("change",this.render,this);this.model.bind("popoverChange",this.test,this)},deleteItem:function(a){a.preventDefault();this.model.destroy();this.remove()},deleteModel:function(a){a.preventDefault();showAlertModal("delete","confirm",function(){$.ajax({type:"DELETE",url:this.model.url(),success:function(){location.reload(true)}})})},deleteConfirm:function(c){var b=this;var a=$("#deleteConfirmationModal");a.html(getTemplate("modal-delete-confirm",{})).modal("show");$("#delete-confirm",a).click(function(d){d.preventDefault();var f=b.model.get("id");console.log(f);$(this).addClass("disabled");$.ajax({url:"core/api/users/"+f,type:"DELETE",success:function(){console.log("success");$("#deleteConfirmationModal").modal("hide");b.remove();if(!_billing_restriction.currentLimits.freePlan){var e;if(count>1){e=_agile_get_translated_val("users","deleted-users")}else{e=_agile_get_translated_val("users","deleted-user")}showNotyPopUp("information",e,"top",10000)}},error:function(e){console.log("error");a.find(".modal-footer").find("#delete-user").html('<small class="text-danger" style="font-size:15px;margin-right:172px;">'+_agile_get_translated_val("users","delete-user-error")+"</small>");console.log(e)}})})},edit:function(a){},test:function(c){var a=false;if(a){var b=this;getTemplate(b.options.template,b.model.toJSON(),undefined,function(d){$(b.el).html(d);$(b.el).data(b.model);console.log($(b.el));c(b.el)});return this}$(this.el).html(getTemplate(this.options.template,this.model.toJSON()));return this},render:function(c){var a=false;if(a){var b=this;getTemplate(b.options.template,b.model.toJSON(),undefined,function(d){$(b.el).html(d);$(b.el).data(b.model);console.log($(b.el));c(b.el)});return this}$(this.el).html(getTemplate(this.options.template,this.model.toJSON()));$(this.el).data(this.model);return this}});var Base_Collection_View=Backbone.View.extend({events:{"click .temp_collection_event":"tempEvent","click .searchFetchNext":"fetchNextCollectionModels",},initialize:function(){if(!this.options.no_transition_bar){showTransitionBar()}_.bindAll(this,"render","appendItem","appendItemOnAddEvent","appendItemsOnAddEvent","buildCollectionUI");if(this.options.data){this.collection=new BaseCollection(this.options.data,{restKey:this.options.restKey,sortKey:this.options.sortKey,descending:this.options.descending,sort_collection:this.options.sort_collection})}else{this.collection=new BaseCollection([],{restKey:this.options.restKey,sortKey:this.options.sortKey,descending:this.options.descending,sort_collection:this.options.sort_collection})}this.collection.url=this.options.url;this.model_list_template=$('<div class="model-list"></div>');this.collection.bind("sync",this.appendItem);this.collection.bind("add",this.appendItemOnAddEvent);this.collection.bind("addAll",this.appendItemsOnAddEvent);var c=this;this.collection.bind("reset",function(){c.render(true)});this.collection.bind("error",function(g,f){if(f.status==401){handleAjaxError();return}c.render(true,f)});this.render();if(this.options.cursor){this.page_size=this.options.page_size;this.global_sort_key=this.options.global_sort_key;this.request_method=this.options.request_method;this.post_data=this.options.post_data;if(!this.page_size){this.page_size=20}var c=this;this.infiniScroll=new Backbone.InfiniScroll(this.collection,{success:function(){$(".scroll-loading",c.el).remove();if(c.options.infini_scroll_cbk){c.options.infini_scroll_cbk()}if(!c.collection.last().get("cursor")||c.collection.first().get("count")==c.collection.models.length){$(".searchFetchNext",c.el).remove()}},untilAttr:"cursor",param:"cursor",strict:true,pageSize:this.page_size,target:this.options.scroll_target?this.options.scroll_target:$(window),onFetch:function(){var f="table";if(c.options.scroll_symbol){f="section"}if(c.options.custom_scrollable_element){f=c.options.custom_scrollable_element}$(f,c.el).after('<div class="scroll-loading" style="margin-left:50%">'+LOADING_ON_CURSOR+"</div>")}});addInfiniScrollToRoute(this.infiniScroll,this.options.infiniscroll_fragment);var b=this.page_size;var e=this.global_sort_key;var a=this.request_method;var d=this.post_data;this.collection.fetch=function(f){f||(f={});f.data||(f.data={});f.data.page_size=b;if(e&&e!=null){f.data.global_sort_key=e}if(a&&a!=null){f.type=a;if(a.toLowerCase()=="post"&&d&&d!=null){$.each(d,function(g,h){f.data[g]=h})}}return Backbone.Collection.prototype.fetch.call(this,f)}}},tempEvent:function(){console.log("tempEvent")},fetchNextCollectionModels:function(a){a.preventDefault();this.infiniScroll.fetchNext()},appendItem:function(b,a){if(a){$(this.model_list_element).append(this.createListView(b).render().el);return}console.log("appendItem");this.model_list_element_fragment.appendChild(this.createListView(b).render().el)},createListView:function(a){if(this.options.modelData){a.set(this.options.modelData)}var b=new Base_List_View({model:a,template:(this.options.templateKey+"-model"),tagName:this.options.individual_tag_name});return b},appendItemOnAddEvent:function(a){this.appendItem(a,true);var b=this.options.appendItemCallback;if(b&&typeof(b)==="function"){b($(this.el))}if($("table",this.el).length!=0){append_checkboxes(this.model_list_element)}},appendItemsOnAddEvent:function(c){this.model_list_element_fragment=document.createDocumentFragment();this.model_list_element=$("#"+this.options.templateKey+"-model-list",$(this.el));var b=this;$.each(c,function(d,e){b.appendItem(e)});$(this.model_list_element).append(this.model_list_element_fragment);if(!b.collection.last().get("cursor")||b.collection.first().get("count")==b.collection.models.length){$(".searchFetchNext",b.el).remove()}var a=this.options.appendItemCallback;if(a&&typeof(a)==="function"){a($(this.el))}if($("table").hasClass("onlySorting")){return}append_checkboxes(this.model_list_element)},render:function(d,c){if(d==undefined){var b=(this.options.customLoader)?getTemplate(this.options.customLoaderTemplate):"";$(this.el).html(b);return this}if($(this.el).html()==getRandomLoadingImg()){$(this.el).empty()}if(c){if(this.options.errorCallback&&typeof(this.options.errorCallback)=="function"){this.options.errorCallback(c)}else{$(this.el).html('<div style="padding:10px;font-size:14px"><b>'+c.responseText+"<b></div>")}return}var e=this;var a=this.buildCollectionUI;getTemplate((this.options.templateKey+"-collection"),this.collection.toJSON(),"yes",a);if(this.page_size&&(this.collection.length<this.page_size)){console.log("Disabling infini scroll");this.infiniScroll.destroy()}this.delegateEvents();return this},buildCollectionUI:function(a){$(this.el).html(a);if(this.collection.models.length==0){fill_slate("slate",this.el,this.options.slateKey)}this.model_list_element_fragment=document.createDocumentFragment();this.model_list_element=$("#"+this.options.templateKey+"-model-list",$(this.el));var b=document.createDocumentFragment();_(this.collection.models).each(function(d){this.appendItem(d)},this);$(this.model_list_element).append(this.model_list_element_fragment);var c=this.options.postRenderCallback;if(c&&typeof(c)==="function"){c($(this.el),this.collection)}hideTransitionBar();$("body").trigger("agile_collection_loaded",[this.el]);if(c&&typeof(c)==="function"){}return this},});Base_Collection_View.extend=function(b){var a=Backbone.View.extend.apply(this,arguments);a.prototype.events=_.extend({},this.prototype.events,b.events);return a};Base_List_View.extend=function(b){var a=Backbone.View.extend.apply(this,arguments);a.prototype.events=_.extend({},this.prototype.events,b.events);return a};var Base_Model_View=Backbone.View.extend({events:{"click .save":"save","click .saveAuthConform":"save","click .delete":"deleteItem"},initialize:function(){showTransitionBar();_.bindAll(this,"render","save","deleteItem","buildModelViewUI");if(this.options.data!=undefined){this.model=new Backbone.Model(this.options.data)}else{if(this.options.model){this.model=this.options.model}else{this.model=new Backbone.Model({})}}this.model.bind("change",this.onChange,this);this.model.bind("error",function(c,b){if(b.status==401){handleAjaxError();return}});if(this.options.url){this.model.url=this.options.url}if((!this.options.isNew)&&$.isEmptyObject(this.model.toJSON())){console.log("to fetch");var a=this;this.model.fetch({success:function(b){a.render(true)}})}},deleteItem:function(b){b.preventDefault();var c=this.options.deleteCallback;var a=this;showAlertModal("delete","confirm",function(){a.model.destroy({success:function(e,d){if(c&&typeof(c)==="function"){console.log(d);c(e,d)}if(this.options.no_reload_on_delete){return}location.reload(true)}})})},save:function(j){j.preventDefault();var c=j.currentTarget;if($(c).hasClass("saveAuth")){var b=this.options.saveAuth;if(b&&typeof(b)==="function"){this.targetEle=c;var h=b(this.el);if(h){return}}}if(this.targetEle){c=this.targetEle}trigger_tinymce_save();var q=$(this.el);var m=$(this.el).find("form").attr("id");var d=this.options.saveCallback;var f=this.options.errorCallback;var p=$("#"+m);console.log(p.find(".save"));
if($(c).attr("disabled")){return}disable_save_button($(c));var o,n;if($(this.el).find("form").length>1){n={};$.each($(this.el).find("form"),function(s,t){if(!isValidForm($(t))){o=false;return}var e=$(t).attr("id");var r=$(t).attr("name");if(r){n[r]=serializeForm(e)}else{$.each(serializeForm(e),function(u,v){n[u]=v})}})}if(o==false||!isValidForm(p)){enable_save_button($(c));return}var l=this.options.form_custom_validate;if(l&&!l()){enable_save_button($(j.currentTarget));return}this.model.clear({silent:true});if(!n){n=serializeForm(m)}this.model.set(n,{silent:true});var i=this.options.window;var a=this.options.reload;var k=this.options.modal;var g=this.options.prePersist;if(g&&typeof(g)==="function"){g(this.model)}this.model.save([],{wait:true,success:function(r,e){track_with_save_success_model($(c));enable_save_button($(c));if(d&&typeof(d)==="function"){console.log(e);d(e)}if(a){location.reload(true)}else{if(i){if(i=="back"){history.back(-1)}else{Backbone.history.navigate(i,{trigger:true})}p.each(function(){this.reset()});if(k){$(k).modal("hide")}}else{}}},error:function(r,e){enable_save_button($(c));console.log(e);if(f&&typeof(f)==="function"){f(e);return}$save_info=$('<div style="display:inline-block"><small><p style="color:#B94A48; font-size:14px"><i>'+e.responseText+"</i></p></small></div>");$(c).closest(".form-actions",this.el).append($save_info);if(e.status!=406){$save_info.show().delay(5000).hide(1)}}},{silent:true})},render:function(c){if(!this.model.isNew()||this.options.isNew||!$.isEmptyObject(this.model.toJSON())||c){$(this.el).html(getRandomLoadingImg());getTemplate(this.options.template,this.model.toJSON(),"yes",this.buildModelViewUI)}else{if(this.options.template=="portlets-leader-board-body-model"){var a=this.options.portletSizeY;var b=50*a;if(a==2||a==3){b+=50}$(this.el).html("<div class='text-center v-middle opa-half' style='margin-top:"+b+"px'><img src='"+updateImageS3Path("../flatfull/img/ajax-loader-cursor.gif")+"' style='width:12px;height:10px;opacity:0.5;' /></div>")}else{$(this.el).html(getRandomLoadingImg())}}return this},onChange:function(){if(this.options.change==false){return}this.render(true)},buildModelViewUI:function(a){hideTransitionBar();$(this.el).on("DOMNodeInserted",function(c){$(this).trigger("view_loaded")});$(this.el).html(a);var b=this.options.postRenderCallback;if(b&&typeof(b)==="function"){b($(this.el),this.model.toJSON())}if(this.options.isNew!=true){if($(this.el).find("form").length>1){deserializeMultipleForms(this.model.toJSON(),$(this.el).find("form"))}else{if($(this.el).find("form").length==1){deserializeForm(this.model.toJSON(),$(this.el).find("form"))}}}$(this.el).trigger("agile_model_loaded")}});function disable_save_button(b){var a=b.attr("data-loading-text");if(!a){a=_agile_get_translated_val("others","saving")}b.css("min-width",b.width()+"px").attr("disabled","disabled").attr("data-save-text",b.html()).text(a)}function enable_save_button(a){a.html(a.attr("data-save-text")).removeAttr("disabled data-save-text")}Base_Model_View.extend=function(b){var a=Backbone.View.extend.apply(this,arguments);a.prototype.events=_.extend({},this.prototype.events,b.events);return a};var INFINI_SCROLL_JSON={};function addInfiniScrollToRoute(a){var b=window.location.hash.split("#")[1];INFINI_SCROLL_JSON[b]=a}function activateInfiniScroll(){var a=window.location.hash.split("#")[1];$.each(INFINI_SCROLL_JSON,function(b,c){c.disableFetch()});if(INFINI_SCROLL_JSON[a]){INFINI_SCROLL_JSON[a].enableFetch()}}var HelpcenterRouter=Backbone.Router.extend({routes:{"":"categories",categories:"categories","section/:id":"sectionArticles","category/:categorie_id":"categorieSections","section/:name":"sectionArticles","article/:name":"viewArticle","search-article/:search_term":"searchArticle"},categories:function(){App_Helpcenter.renderHomeTemplate(function(){App_Helpcenter.categoriesCollection=new Base_Collection_View({url:"/helpcenterapi/api/knowledgebase/categorie",templateKey:"helpcenter-categories",individual_tag_name:"div",sort_collection:true,sortKey:"created_time",postRenderCallback:function(a,b){Helpcenter_Util.setBreadcrumbPath()}});App_Helpcenter.categoriesCollection.collection.fetch();$("#helpcenter-container").html(App_Helpcenter.categoriesCollection.el)})},categorieSections:function(a){App_Helpcenter.renderHomeTemplate(function(){var b=new Base_Model_View({isNew:false,template:"categorie",url:"/helpcenterapi/api/knowledgebase/categorie/"+a,postRenderCallback:function(c,d){if(!d.id){window.history.back()}Helpcenter_Util.setBreadcrumbPath("categorie-sections-breadcrumb",d);App_Helpcenter.sectionsCollection=new Base_Collection_View({url:"/helpcenterapi/api/knowledgebase/section/categorie/"+a,templateKey:"helpcenter-sections",individual_tag_name:"div"});App_Helpcenter.sectionsCollection.collection.fetch();$("#sections-collection",c).html(App_Helpcenter.sectionsCollection.el)}});$("#helpcenter-container").html(b.render().el)})},sectionArticles:function(a){var a=decodeURI(a);a=encodeURIComponent(a);App_Helpcenter.renderHomeTemplate(function(){var b=new Base_Model_View({isNew:false,template:"section",url:"/helpcenterapi/api/knowledgebase/section?name="+a,postRenderCallback:function(c,d){if(d.name==null){window.history.back()}Helpcenter_Util.setBreadcrumbPath("section-articles-breadcrumb",d);App_Helpcenter.articlesCollection=new Base_Collection_View({url:"/helpcenterapi/api/knowledgebase/article?section_name="+a,templateKey:"helpcenter-articles",individual_tag_name:"div",postRenderCallback:function(e){},});App_Helpcenter.articlesCollection.collection.fetch();$("#articles-collection").html(App_Helpcenter.articlesCollection.el)}});$("#helpcenter-container").html(b.render().el)})},viewArticle:function(a){App_Helpcenter.renderHomeTemplate(function(){var b=new Base_Model_View({isNew:false,template:"article",url:"/helpcenterapi/api/knowledgebase/article/"+a,postRenderCallback:function(c,d){if(d.title==null){window.history.back()}Helpcenter_Util.setBreadcrumbPath("article-breadcrumb",d)},});$("#helpcenter-container").html(b.render().el)})},renderHomeTemplate:function(a){if($("#helpcenter-container").length){a();return}getTemplate("home",{},undefined,function(b){if(!b){return}$("#content").html($(b));if(kbpagelpid==1){$(".search-box").addClass("search-box1");$(".search-box h1").css("color","#fff")}if(a){a()}})},searchArticle:function(a){App_Helpcenter.renderHomeTemplate(function(){App_Helpcenter.articlesCollection=new Base_Collection_View({url:"/helpcenterapi/api/knowledgebase/article/search/"+a,templateKey:"helpcenter-search-articles",individual_tag_name:"div",slateKey:"articles",postRenderCallback:function(b,c){Helpcenter_Util.setBreadcrumbPath("categorie-sections-breadcrumb",c);$("#hc_query").val("");var d=Backbone.history.getFragment();if(d.indexOf("categories")>=0){$("li#default a").attr("href","#")}},errorCallback:function(){$("#helpcenter-container").html(App_Helpcenter.articlesCollection.el)}});App_Helpcenter.articlesCollection.collection.fetch();$("#helpcenter-container").html(App_Helpcenter.articlesCollection.el)})}});function createCookie(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/"}function createCookieInAllAgileSubdomains(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/; domain=agilecrm.com"}function readCookie(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function eraseCookie(a){createCookie(a,"",-1)}function agile_is_mobile_browser(){return(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))}var Handlebars_Compiled_Templates={};function getTemplate(k,e,c,j,b){var d=j&&typeof(j)=="function";if(Handlebars_Compiled_Templates[k]){if(j){return j(Handlebars_Compiled_Templates[k](e))}else{return Handlebars_Compiled_Templates[k](e)}}else{Handlebars_Compiled_Templates={}}if(HANDLEBARS_PRECOMPILATION){var i=Handlebars.templates[k+"-template"];if(i){if(d){j(i(e));return}return i(e)}}else{var a=$("#"+k+"-template").html();if(a){var i=Handlebars.compile(a);Handlebars_Compiled_Templates[k]=i;if(d){j(i(e));return}return i(e)}}if(c=="no"){console.log("Not found "+k);return}if(b){try{var h=$(getRandomLoadingImg());$(b).html(h.css("margin","10px"))}catch(g){}}var f=getTemplateUrls(k);if(d){load_templates_async(k,e,f,j);return}load_templates_sync(f);return getTemplate(k,e,"no")}function _agile_get_translated_val(b,a){if(typeof _Agile_Resources_Json==="undefined"){_Agile_Resources_Json={}}if(!a){return _Agile_Resources_Json[b]}if(!_Agile_Resources_Json[b]){return""}return _Agile_Resources_Json[b][a]}(function(){try{var a=Handlebars.templates["agile-localization-template"]({});$("body").append('<script type="text/javascript">'+a+"<\/script>")}catch(b){}})();function deserializeForm(b,a){$.each(b,function(e,g){var d=a.find('*[name="'+e+'"]'),f="",c="";if(d.length>0){c=d[0].tagName.toLowerCase();if(c=="select"||c=="textarea"){$(d).val(g)}else{if(c=="input"){f=$(d[0]).attr("type");if(d.hasClass("date")){try{d.val(getDateInFormatFromEpoc(g))}catch(h){}d.datepicker({format:CURRENT_USER_PREFS.dateFormat,weekStart:CALENDAR_WEEK_START_DAY,autoclose:true})}else{if(f=="text"||f=="password"||f=="hidden"||f=="number"||f=="url"){d.val(g)}else{if(c=="select"){d.val(g).trigger("change")}else{if(f=="checkbox"){if(g){if(g==true){d.attr("checked","checked")}}else{d.removeAttr("checked")}}else{if(f=="radio"){d.filter('[value="'+g+'"]').attr("checked","checked")}}}}}}else{if(d.hasClass("multiSelect")&&c=="ul"){$.each(g,function(i,j){$("#multipleSelect",a).multiSelect("select",j)})}else{if(d.hasClass("tagsinput")&&c=="ul"&&d.hasClass("contacts")){$.each(b.contacts,function(j,i){var n;var m=i.id;
n=getContactName(i);var l="#contact/"+i.id;if(i.type=="COMPANY"){l="#company/"+i.id}var k=Handlebars.compile('<li class="tag btn btn-xs btn-primary m-r-xs m-b-xs inline-block" data="{{id}}"  style="display: inline-block; "><a class="text-white v-middle" href="{{link}}">{{name}}</a><a class="close m-l-xs" id="remove_tag">&times</a></li>');d.append(k({name:n,id:m,link:l}))})}else{if(d.hasClass("tagsinput")&&c=="ul"&&d.hasClass("deals")){$.each(b.deals,function(i,k){var m;var l=k.id;m=k.name.split(" ").join("");var j=Handlebars.compile('<li class="tag btn btn-xs btn-primary m-r-xs m-b-xs inline-block" data="{{id}}"><a href="#deal/{{id}}" class="text-white v-middle">{{name}}</a><a class="close m-l-xs" id="remove_tag">&times</a></li>');d.append(j({name:m,id:l}))})}else{if(d.hasClass("multiSelect")&&c=="ul"){$.each(g,function(i,j){$("#multipleSelect",a).multiSelect("select",j)})}else{if(d.hasClass("multiple-checkbox")){for(var e=0;e<g.length;e++){$('input:checkbox[value="'+g[e]+'"]',d).attr("checked","checked")}}else{if(d.hasClass("multiple-checkbox-adminprefs")){for(var e=0;e<g.length;e++){$('input:checkbox[value="'+g[e]+'"]',d).attr("checked","checked")}}else{if(d.hasClass("chainedSelect")){}}}}}}}}}}})}function deserializecontactsForm(b,a){$.each(b,function(e,g){var d=a.find('*[name="'+g+'"]'),f="",c="";if(d.length>0){$('input:checkbox[value="'+g+'"]',a).attr("checked","checked")}})}function deserializeMultipleForms(b,a){$.each(a,function(c,e){var d=$(e).attr("name");if(d&&b[d]){deserializeForm(b[d],$(e))}else{deserializeForm(b,$(e))}})}function deserializeChainedSelect(c,b,a){$.each(b,function(d,e){var h=($(c).find(".chained"))[0];if(d>0){var f=$(h).parent();h=$($(a).clone().find(".chained"))[0];$(h).find("i.filter-contacts-multiple-remove").css("display","inline-block");var g=$(h).find("i.filter-contacts-multiple-remove").css("display","inline-block");if($(c).hasClass("opportunity")){chainDealFilters(h)}else{chainFilters(h)}$(f).append(h);deserializeChainedElement(e,h);return}deserializeChainedElement(e,h)})}function deserializeChainedElement(a,b){$(b).removeClass("hide");$.each(a,function(k,o){var d=($(b).find('*[name="'+k+'"]').children())[0];if(!d){return}if(d.tagName.toLowerCase()=="input"){if($(d).hasClass("date")){$(d).val(getDateInFormatFromEpoc(o));$(d).datepicker({format:CURRENT_USER_PREFS.dateFormat,weekStart:CALENDAR_WEEK_START_DAY,autoclose:true});$(d).datepicker("update");return}if(($(d).closest("td").siblings("td.lhs-block").find("option:selected").attr("field_type")=="CONTACT"||$(d).closest("td").siblings("td.lhs-block").find("option:selected").attr("field_type")=="COMPANY")&&o!="Contact"&&o!="Company"){var n=Backbone.Model.extend({url:"/core/api/contacts/references?references="+o});var m=new n();m.fetch({success:function(i){$(d).val(getPropertyValue(i.get(0).properties,"first_name"))}});return}$(d).val(o);return}if($(d).closest("td").siblings("td.lhs-block").find("option:selected").val()=="track_milestone"&&a.LHS=="track_milestone"){var l=$(d).closest("td").siblings("td.rhs-block").find("#RHS");var h=l.find("input").attr("name");var p=a.RHS;var g=p.substring(0,p.indexOf("_"));var c=p.substring(p.indexOf("_")+1,p.length+1);var q={};q.pipeline_id=g;q.milestone=c;populateTrackMilestones(undefined,undefined,q,undefined,undefined,undefined,l,h);$(d).find('option[value="'+a.CONDITION+'"]').attr("selected","selected");return}if($(d).closest("td").siblings("td.lhs-block").find("option:selected").val()=="archived"&&a.LHS=="archived"){var l=$(d).closest("td").siblings("td.rhs-block").find("#RHS");var h=l.find("input").attr("name");var f=a.RHS;l.html(getTemplate("js-deal-filters",{field_name:h}));l.find("option[value='"+f+"']").attr("selected","selected");return}if($(d).closest("td").siblings("td.lhs-block").find("option:selected").val()=="country"&&a.LHS=="country"){var e="";if(a.CONDITION!="DEFINED"&&a.CONDITION!="NOT_DEFINED"){e=getTemplate("country-list",{})}$(d).closest("td").siblings("td.rhs-block").find("div").html(e);$(d).closest("td").siblings("td.rhs-block").find("div").find("select").find('option[value="'+a.RHS+'"]').attr("selected","selected");$(d).find('option[value="'+a.CONDITION+'"]').attr("selected","selected");return}var j=$("option",d);$.each(j,function(r,s){if($(s).prop("value")==o){$(s).attr("selected","selected");var i=$(s).attr("url");if(i){$(s).attr("data",a.RHS);console.log($(s))}$(d).trigger("change");return}})})}function deserializeChainedElementWebrule(a,b){$.each(a,function(c,f){if(f.value){f=f.value}var e=$(b).find('*[name="'+c+'"]').children();var h=e[0];if(!h){return}var g=h.tagName.toLowerCase();if(g!="input"&&g!="textarea"&&g!="select"&&e.length>1){$.each(e,function(j,i){if(j==0){return}g=i.tagName.toLowerCase();if(g=="input"||g=="textarea"||g=="select"){h=i;return false}})}if(!h){return}if(h.tagName.toLowerCase()=="input"||h.tagName.toLowerCase()=="textarea"){$(h).val(f);if($(h).hasClass("custom_html")){if(f.value){$(h).val(f.value)}}return}var d=$("option",h);$.each(d,function(i,j){if($(j).prop("value")==f){if((f=="UNSUBSCRIBE_CAMPAIGN"||f=="ASSIGN_CAMPAIGN")&&a.RHS){$(j).attr("data",a.RHS)}$(j).attr("selected","selected");$(h).trigger("change");return}})})}function deserializeChainedSelect1(e,d,c){var a=$(c).find(".webrule-actions")[0];var b=$(a).html();var f=($(e).find(".webrule-actions"))[0];$.each(d,function(h,i){if(h>0){var g=$(b).clone();$(g).find("i.webrule-multiple-remove").css("display","inline-block");var j=[];j.push(i);chainWebRules(g,d,false,j);deserializeChainedElementWebrule(i,g);$(f).append(g);return}deserializeChainedElementWebrule(i,f)})}function deserializeLhsFilters(b,d){var c=JSON.parse(d);var a=0;var e=0;$.each(c.rules,function(l,f){var n=f.LHS;var k=f.CONDITION;var h=f.RHS;var j=f.RHS_NEW;var o=n.replace(/ +/g,"_");o=o.replace(/#/g,"\\#").replace(/@/g,"\\@");var p=$(b).find("#"+o+"_div");$(".custom_contact").each(function(){if($(this).attr("name")==n){var r=this;var q=new Base_Collection_View({url:"/core/api/contacts/references?references="+h,sort_collection:false});q.collection.fetch({success:function(t){var s="";if(getPropertyValue(t.get(h).get("properties"),"first_name")){s+=getPropertyValue(t.get(h).get("properties"),"first_name")}if(getPropertyValue(t.get(h).get("properties"),"last_name")){s+=" "+getPropertyValue(t.get(h).get("properties"),"last_name")}$(r).parent().find("input").val(s);$(r).parent().find("input").attr("data",h);hideTransitionBar()}})}});$(".custom_company").each(function(){if($(this).attr("name")==n){var r=this;var q=new Base_Collection_View({url:"/core/api/contacts/references?references="+h,sort_collection:false});q.collection.fetch({success:function(s){$(r).parent().find("input").val(getPropertyValue(s.get(h).get("properties"),"name"));$(r).parent().find("input").attr("data",h);hideTransitionBar()}})}});if(n=="tags"||n=="campaign_status"){$("#"+n+"_div").parent().find("a").addClass("bold-text");$("#"+n+"_div").removeClass("hide");$("#"+n+"_div").prev().find("i").toggleClass("fa-plus-square-o").toggleClass("fa-minus-square-o");if((a==0&&n=="tags")||(e==0&&n=="campaign_status")){p=$("#"+n+"-lhs-filter-table").find("div.lhs-contact-filter-row:last");$("#"+n+"_div").prev().find("i").toggleClass("fa-plus").toggleClass("fa-minus")}else{var i=$("#"+n+"-lhs-filter-table").find("div.hide.master-"+n+"-add-div").clone();i.removeClass("hide").addClass("lhs-contact-filter-row");addTagsDefaultTypeahead(i);$(i).appendTo("#"+n+"-lhs-filter-table");p=$("#"+n+"-lhs-filter-table").find("div.lhs-contact-filter-row:last")}if(n=="tags"){a++}if(n=="campaign_status"){e++}}else{$(p).prev().find("i").toggleClass("fa-plus-square-o").toggleClass("fa-minus-square-o")}$(p).parent().find("a#lhs-filters-header").addClass("bold-text");$(p).find("a.clear-filter-condition-lhs").removeClass("hide");$(p).removeClass("hide");$(p).find('[name="CONDITION"]').val(k);$(p).find('[name="CONDITION"]').trigger("change");var m=$(p).find("."+k).find("#RHS").children();var g=$(p).find("."+k).find("#RHS_NEW").children();if($(m).hasClass("date")){h=getLocalTimeFromGMTMillisecondsforDynamicFilters(h);$(m).val(getDateInFormatFromEpoc(h));$(m).attr("prev-val",getDateInFormatFromEpoc(h))}else{$(m).val(h);$(m).attr("prev-val",h)}if(g){if($(g).hasClass("date")){j=getLocalTimeFromGMTMillisecondsforDynamicFilters(j);$(g).val(getDateInFormatFromEpoc(j));$(g).attr("prev-val",getDateInFormatFromEpoc(j))}else{$(g).val(j);$(g).attr("prev-val",j)}}});if(c.or_rules){$(".custom_contacts").each(function(){var i="";var f=[];var h=this;$.each(c.or_rules,function(k,l){var o=l.LHS;var n=l.CONDITION;var j=l.RHS;var m=l.RHS_NEW;var q=o.replace(/ +/g,"_");q=q.replace(/#/g,"\\#").replace(/@/g,"\\@");var p=$(b).find("#"+q+"_div");if($(h).attr("name")==o){i+=l.RHS+",";f.push(l.RHS);$(p).parent().find("a#lhs-filters-header").addClass("bold-text");$(p).find("a.clear-filter-condition-lhs").removeClass("hide");$(p).removeClass("hide");$(p).find('[name="CONDITION"]').val("IN");$(p).find('[name="CONDITION"]').trigger("change");$(p).prev().find("i").toggleClass("fa-plus-square-o").toggleClass("fa-minus-square-o")}});if(i){var g=new Base_Collection_View({url:"/core/api/contacts/references?references="+i,sort_collection:false});g.collection.fetch({success:function(j){$.each(f,function(l){var m=f[l];var k="";if(getPropertyValue(j.get(m).get("properties"),"first_name")){k=getPropertyValue(j.get(m).get("properties"),"first_name")}if(getPropertyValue(j.get(m).get("properties"),"last_name")){k+=" "+getPropertyValue(j.get(m).get("properties"),"last_name")}$(h).append('<li class="tag btn btn-xs btn-primary m-r-xs m-b-xs inline-block" data="'+j.get(m).id+'"><a href="#contact/'+j.get(m).id+'" class="text-white v-middle">'+k+'</a><a class="close m-l-xs" id="remove_contact_in_lhs">×</a></li>')});hideTransitionBar()}})}});$(".custom_companies").each(function(){var i="";var f=[];var h=this;$.each(c.or_rules,function(k,l){var o=l.LHS;var n=l.CONDITION;var j=l.RHS;var m=l.RHS_NEW;var q=o.replace(/ +/g,"_");q=q.replace(/#/g,"\\#").replace(/@/g,"\\@");
var p=$(b).find("#"+q+"_div");if($(h).attr("name")==o){i+=l.RHS+",";f.push(l.RHS);$(p).parent().find("a#lhs-filters-header").addClass("bold-text");$(p).find("a.clear-filter-condition-lhs").removeClass("hide");$(p).removeClass("hide");$(p).find('[name="CONDITION"]').val("IN");$(p).find('[name="CONDITION"]').trigger("change");$(p).prev().find("i").toggleClass("fa-plus-square-o").toggleClass("fa-minus-square-o")}});if(i){var g=new Base_Collection_View({url:"/core/api/contacts/references?references="+i,sort_collection:false});g.collection.fetch({success:function(j){$.each(f,function(k){var l=f[k];$(h).append('<li class="tag btn btn-xs btn-primary m-r-xs m-b-xs inline-block" data="'+j.get(l).id+'"><a href="#company/'+j.get(l).id+'" class="text-white v-middle">'+getPropertyValue(j.get(l).get("properties"),"name")+'</a><a class="close m-l-xs" id="remove_contact_in_lhs">×</a></li>')});hideTransitionBar()}})}})}}var Form_Collection_Events=Base_Collection_View.extend({events:{"click .codeshare":"codePublish",},codePublish:function(a){$("#modal-backdrop").hide();a.preventDefault();var b=$("#codeShareModal");getTemplate("formbuilder-codeshare",{},undefined,function(g){b.html(g).modal("show");var c=App_Forms.formsListView.collection.get($(a.currentTarget).data("formid"));c.attributes.formHtml=c.get("formHtml").replace('name="_agile_form_id" value="">','name="_agile_form_id" value="'+c.id+'">');b.find("#fullsourceArea").text(c.get("formHtml"));var f=window.location.protocol+"//"+window.location.host+"/forms/"+$(a.currentTarget).data("formid");b.find("#linkArea").text(f);var e='<iframe width="100%" height="100%" src="'+f+'" frameborder="0"></iframe>';b.find("#iframeArea").text(e);var d={};d.host=window.location.hostname.split(".")[0];d.formid=$(a.currentTarget).data("formid");d.link=f;b.find("#embedCodeArea").text(getTemplate("js-form-embed",d))})},});$("body").on("mouseenter","#forms-model-list tr",function(a){$(this).find("#formcode_manager").removeClass("hide")});$("body").on("mouseleave","#forms-model-list tr",function(a){$(this).find("#formcode_manager").addClass("hide")});$("#codeShareModal").on("focus",".form-control",function(){var a=$(this);a.select();a.mouseup(function(){a.unbind("mouseup");return false})});function serializeForm(b){var a=$("#"+b).serializeArray(),e={};a=a.concat($("#"+b+" input[type=checkbox]").map(function(){return{name:this.name,value:$(this).is(":checked")}}).get());a=a.concat($("#"+b+" input.date").map(function(){if(CURRENT_USER_PREFS.dateFormat.indexOf("dd/mm/yy")!=-1||CURRENT_USER_PREFS.dateFormat.indexOf("dd.mm.yy")!=-1){return{name:this.name,value:getFormattedDateObjectWithString(this.value).getTime()/1000}}else{return{name:this.name,value:getFormattedDateObjectWithString(this.value).getTime()/1000}}}).get());a=a.concat($("#"+b+" select.multi-select").map(function(){console.log($(this).val());return{name:this.name,value:$(this).val()}}).get());console.log(a);a=a.concat($("#"+b+' div[contenteditable="true"]').map(function(){var f=$('div[contenteditable="true"]');return{name:f.attr("data-name"),value:f.html()}}).get());a=a.concat($("#"+b+' [name="cc_emails"]').map(function(){var f=[];$.each($(this).children(),function(j,i){if($(i).attr("data")){f.push(($(i).attr("data")).toString())}});return{name:"cc_emails",value:f}}).get());a=a.concat($("#"+b+" .selected_columns").map(function(){return{name:$(this).attr("name"),value:$(this).sortable("toArray")}}).get());a=a.concat($("#"+b+" .array-input-fields").map(function(){console.log($(this).val());return{name:this.name,value:$(this).val()}}).get());a=a.concat(get_tags(b));a=a.concat(get_notes(b));a=a.concat(get_related_deals(b));a=a.concat($("#"+b+" .multiSelect").map(function(){var f=[];$.each($(this).children("li"),function(g,h){f.push(($(h).attr("ms-value")))});return{name:$(this).attr("name"),value:f}}).get());a=a.concat($("#"+b+" .chosen-select").map(function(){var f=[];return{name:$(this).attr("name"),value:$(this).val()}}).get());a=a.concat($("#"+b+" .multiple-input").map(function(){var f=[];$.each($(this).find("input"),function(g,h){if($(h).val()){f.push($(h).val())}});return{name:$(this).attr("name"),value:f}}).get());a=a.concat($("#"+b+" .multiple-checkbox").map(function(){var f=[];$("input:checkbox:checked",this).each(function(h,g){f.push($(g).val())});console.log(f);return{name:$(this).attr("name"),value:f}}).get());a=a.concat($("#"+b+" .multiple-checkbox-adminprefs").map(function(){var f=[];$("input:checkbox:checked",this).each(function(h,g){if(!($(this).closest(".multiple-checkbox"))==undefined){console.log("admin-prefs")}else{if(($(this).closest(".multiple-checkbox")).length==0){f.push($(g).val())}}});console.log(f);return{name:$(this).attr("name"),value:f}}).get());a=a.concat($("#"+b+" input.month_date").map(function(){return{name:this.name,value:getFormattedDateObjectForMonthWithString(this.value).getTime()/1000}}).get());var d=$("#"+b+" .chained-table:visible");$.each(d,function(f,g){var h=[];a=a.concat($(g).find(".chained:visible").map(function(){var i=serializeChainedElement(this);h.push(i);return{name:$(this).attr("name"),value:h}}).get())});for(var c=0;c<a.length;++c){e[a[c].name]=a[c].value}return e}function serializeChainedElement(b){var c={};$.each($(b).find("div").children(),function(f,i){var g=$(i)[0].tagName;if(!(g=="TEXTAREA"||g=="INPUT"||g=="SELECT")){return}var e=$(i).parent().attr("name");var h;if($(i).hasClass("date")){if($(i).closest("td").siblings("td.lhs-block").find("select#LHS").val()=="closed_time"&&$(i).closest("tr").parent().parent().hasClass("opportunity")){var d=getFormattedDateObjectWithString($(i).val());if(d){h=d.getTime()}}else{var d=getFormattedDateObjectWithString($(i).val());h=getGMTEpochFromDateForDynamicFilters(d)}}else{if($(i).hasClass("contact_custom_field")||$(i).hasClass("company_custom_field")){h=$(i).attr("data")}else{if(!c[e]){h=$(i).val()}}}if(h!=null&&h!=""){c[e]=h}});if(c.CONDITION=="BETWEEN"){var a=(c.RHS_NEW+(24*60*60*1000)-1);c.RHS_NEW=a}if(c.nested_condition=="BETWEEN"){var a=(c.nested_rhs+(24*60*60*1000)-1);c.nested_rhs=a}return c}$(function(){$.fn.focus_first=function(){var b=$(this).find("input:visible").not(".hide").get(0);var a=$("textarea:visible",this).get(0);if(a&&b){if(a.offsetTop<b.offsetTop){b=a}}if(b){$(b).focus()}return this};$(".modal").on("shown.bs.modal",function(a){var b=a.target.classList.length;if(a.target.classList[b-2]=="focusRelatedTo"){$("#opportunityUpdateForm").find("input[name='relates_to']").focus()}else{$("form",this).focus_first()}})});function serializeLhsFilters(a){var c=[];var d=[];var b={};$(a).find("a#lhs-filters-header").removeClass("bold-text");$.each($(a).find(".lhs-contact-filter-row"),function(l,h){var m={};var j=$(h)[0];var g,i;var k=$(j).find('[name="CONDITION"]').val();var n=$(j).find("."+k).find("#RHS").children();var f=$(j).find("."+k).find("#RHS_NEW").children();if($(n).val()!=undefined){g=$(n).val().trim()}if($(n).hasClass("date")&&g&&g!=""){var e=getFormattedDateObjectWithString($(n).val());g=getGMTEpochFromDateForDynamicFilters(e)}if($(n).hasClass("custom_contact")||$(n).hasClass("custom_company")){g=$(n).parent().find("input").attr("data")}if($(n).hasClass("custom_contacts")||$(n).hasClass("custom_companies")){$(n).find("li").each(function(){var r={};var v=$(this).attr("data");var s=$(j).find('[name="LHS"]').val();if(v){r.LHS=s;r.CONDITION="EQUALS";r.RHS=v;r.RHS_NEW="";d.push(r);var u=s.replace(/ +/g,"_");u=u.replace(/#/g,"\\#").replace(/@/g,"\\@").replace(/[\/]/g,"\\/");var t=$(a).find("#"+u+"_div");$(t).parent().find("a#lhs-filters-header").addClass("bold-text");$(t).find("a.clear-filter-condition-lhs").removeClass("hide")}})}i=$(f).val();if($(f).hasClass("date")&&i&&i!=""){var e=getFormattedDateObjectWithString($(f).val());if(k!="BETWEEN"){i=getGMTEpochFromDateForDynamicFilters(e)}else{e=new Date(getGMTEpochFromDateForDynamicFilters(e)+(24*60*60*1000)-1);i=e.getTime()}}if(i&&typeof i=="string"){i=i.trim()}if((g&&g!=null&&g!="")||k=="DEFINED"||k=="NOT_DEFINED"){if(f&&f.length>0){if(!i||i==null||i==""){return}}var o=$(j).find('[name="LHS"]').val();m.LHS=o;m.CONDITION=k;m.RHS=g;m.RHS_NEW=i;c.push(m);var p=o.replace(/ +/g,"_");p=p.replace(/#/g,"\\#").replace(/@/g,"\\@").replace(/[\/]/g,"\\/");var q=$(a).find("#"+p+"_div");$(q).parent().find("a#lhs-filters-header").addClass("bold-text");$(q).find("a.clear-filter-condition-lhs").removeClass("hide")}});b.rules=c;if(d){b.or_rules=d}b.contact_type=$(a).find("#contact_type").val();return b}function isValidForm(a){jQuery.validator.addMethod("choosen-select-input",function(d,c){if(!$("#bulk-labels").length){return true}var b=$("#bulk-labels .chosen-select").val();if(b){return true}return false},_agile_get_translated_val("validation-msgs","required"));jQuery.validator.addMethod("tickets_email",function(c,b){if(this.optional(b)){return true}return/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(c)},_agile_get_translated_val("validation-msgs","pls-enter-valid-email"));jQuery.validator.addMethod("atleastThreeMonths",function(f,d){var g=$(d).siblings("select.exp_month").val(),e=f;var c=new Date().setFullYear(e,g-1);var b=1000*60*60*24;return this.optional(d)||(((c-new Date().getTime())/b)>90)},_agile_get_translated_val("validation-msgs","card-3months-valid"));jQuery.validator.addMethod("multipleEmails",function(d,c){if(this.optional(c)){return true}var e=d.split(/[,]+/);valid=true;for(var b in e){d=e[b];valid=valid&&jQuery.validator.methods.email.call(this,$.trim(d),c)}return valid},_agile_get_translated_val("validation-msgs","pls-enter-valid-email-sep-by-comma"));jQuery.validator.addMethod("noSpecialChars",function(c,b){return isAlphaNumeric(c)},_agile_get_translated_val("validation-msgs","email-should-start-with-an-alphabet"));jQuery.validator.addMethod("email",function(c,b){if(this.optional(b)){return true}return/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(c)
},_agile_get_translated_val("validation-msgs","pls-enter-valid-email"));jQuery.validator.addMethod("phone",function(c,b){if(this.optional(b)){return true}return/^[^a-zA-Z]+$/.test(c)},_agile_get_translated_val("validation-msgs","Pls-enter-a-valid-ph-no"));jQuery.validator.addMethod("allow-char-phone",function(c,b){if(this.optional(b)){return true}return/^((\+)(\d)+)$/.test(c)},_agile_get_translated_val("validation-msgs","Pls-enter-valid-ph-no"));jQuery.validator.addMethod("multi-tags",function(e,b){var d=$(b).val();$(b).val("");if(d&&d.length>=0&&!(/^\s*$/).test(d)){var c=Handlebars.compile('<li class="tag" style="display: inline-block;" data="{{name}}">{{name}}<a class="close" id="remove_tag" tag="{{name}}">&times</a></li>');$(b).closest(".control-group").find("ul.tags").append(c({name:d}))}return $(b).closest(".control-group").find("ul.tags > li").length>0?true:false},_agile_get_translated_val("validation-msgs","this-field-is-required"));jQuery.validator.addMethod("ipValidation",function(c,b){if(this.optional(b)){return true}if(!c){return false}return is_valid_ip(c.trim())},_agile_get_translated_val("validation-msgs","ipaddress"));jQuery.validator.addMethod("formulaData",function(f,c){var e=$(c).val();var b;var g=true;try{b=Handlebars.precompile(e)}catch(d){d.message;g=false}return g?true:false},_agile_get_translated_val("validation-msgs","pls-enter-a-valid-formula"));jQuery.validator.addMethod("number_input",function(c,b){if(c==""){return false}return/^[0-9\-]+$/.test(c)},_agile_get_translated_val("validation-msgs","Pls-enter-valid-no"));jQuery.validator.addMethod("positive_number",function(c,b){if(c==""){return true}if(isNaN(c)){return false}if(!isNaN(c)&&parseFloat(c)>=0){return true}},_agile_get_translated_val("validation-msgs","value-validation"));jQuery.validator.addMethod("multi-select",function(e,d){var c=0;$(d).find(":selected").each(function(f,g){c++});var b=$(d).attr("limit");if(c>b){return false}return true},_agile_get_translated_val("validation-msgs","folder-select-validation"));jQuery.validator.addMethod("checkedMultiSelect",function(d,c){var b=$(c).find("option:selected").length;if(b==0){return false}return true},_agile_get_translated_val("validation-msgs","pls-select-atleast-one-option"));jQuery.validator.addMethod("checkedMultiCheckbox",function(d,c){console.log("value = "+d);console.log("element = "+c);var b=$(c).find("input:checked").length;if(b==0){return false}return true},_agile_get_translated_val("validation-msgs","pls-select-atleast-one-option"));jQuery.validator.addMethod("date",function(c,b){if(c==""){return true}return !/Invalid|NaN/.test(getFormattedDateObjectWithString(c))},_agile_get_translated_val("validation-msgs","Pls-enter-a-valid-date"));jQuery.validator.addMethod("isHttpsURL",function(d,c){var b=new RegExp("^(https://){1}([0-9A-Za-z]+.)");return b.test(d)},_agile_get_translated_val("validation-msgs","pls-enter-a-valid-https-url"));jQuery.validator.addMethod("date_input",function(c,b){if(c==""){return true}return !/Invalid|NaN/.test(getFormattedDateObjectWithString(c))},_agile_get_translated_val("validation-msgs","Pls-enter-a-valid-date"));jQuery.validator.addMethod("field_length",function(d,c){if(d==""){return true}var b=0;var e=$(c).attr("max_len");if(e==""){return true}if(d.length>e){return false}return true},function(c,b){return getTemplate("js-max-length-error",{length:$(b).attr("max_len")})});jQuery.validator.addMethod("domain_format",function(c,b){return/^[a-zA-Z][a-zA-Z0-9-_\.]{3,20}$/.test(c)},_agile_get_translated_val("validation-msgs","domain-validation"));jQuery.validator.addMethod("customFieldSpecialCharacter",function(d,c){var b=/^\s*[_a-zA-Z0-9\s]+\s*$/;return b.test(d)},_agile_get_translated_val("validation-msgs","formlabel-validation"));jQuery.validator.addMethod("duplicateWithSystemName",function(f,d){var b=[];b.cases="title,owner_id,status,description";b.contact="fname,lname,email,company,title,name,url,website,address,phone,skypephone,image,city,state,zip,country,tags";b.deal="name,probability,description,pipeline_milestone,close_date,deal_source_id,color1,relates_to,tags,expected_value";var e=$("#textModalForm").find("input[name='scope']").val();var c;if(e&&(e=="CONTACT"||e=="COMPANY")){var g=b.contact.split(",");for(c=0;c<g.length;c++){if(f.toLowerCase()==g[c]){return false}}}else{if(e&&e=="DEAL"){var g=b.deal.split(",");for(c=0;c<g.length;c++){if(f.toLowerCase()==g[c]){return false}}}else{if(e&&e=="CASE"){var g=b.cases.split(",");for(c=0;c<g.length;c++){if(f.toLowerCase()==g[c]){return false}}}}}return true},"Given name is a system field name. Please choose another name.");jQuery.validator.addMethod("tickets_group_name",function(c,b){return/^[a-zA-Z0-9._]*$/.test(c)},_agile_get_translated_val("validation-msgs","pls-use-only-letters"));jQuery.validator.addMethod("custom_field_keyword",function(c,b){if(c=="image"){return false}else{return true}},_agile_get_translated_val("validation-msgs","image-is-a-keyword-desc"));jQuery.validator.addMethod("verified-email",function(c,b){if($(b).find("option").length!=0){if(typeof($(b).find('option[value="'+c+'"]').attr("unverified"))=="undefined"){return true}return false}},_agile_get_translated_val("validation-msgs","verify-email"));jQuery.validator.addMethod("month_date",function(c,b){if(c==""){return true}return !/Invalid|NaN/.test(getFormattedDateObjectForMonthWithString(c))},_agile_get_translated_val("validation-msgs","date"));$(a).validate({ignoreTitle:true,rules:{atleastThreeMonths:true,multipleEmails:true,email:true,checkedMultiSelect:true,phone:true},debug:true,errorElement:"span",errorClass:"help-inline",ignore:":hidden:not(.checkedMultiSelect)",highlight:function(c,b){$(c).closest(".controls").addClass("single-error")},unhighlight:function(c,b){$(c).closest(".controls").removeClass("single-error")},invalidHandler:function(c,b){var d=b.numberOfInvalids()},errorPlacement:function(b,c){if(c.hasClass("checkedMultiSelect")){b.appendTo($(c).parent())}else{if(c.hasClass("choosen-select-input")){b.appendTo($("#bulk-labels .chosen-container"))}else{b.insertAfter(c)}}}});return $(a).valid()}function isNotValid(a){if(a==undefined){return true}if(a.length==0){return true}return false}function isValidField(b){var a=$("#"+b).val();return !isNotValid(a)}function isAlphaNumeric(b){b=b.toString();var a=new RegExp(/^[A-Za-z][a-zA-Z0-9]{3,20}$/);if(!a.test(b)){error=_agile_get_translated_val("validation-msgs","domain-validation");return false}return true}function isAlphaNumeric(b){b=b.toString();var a=new RegExp(/^[A-Za-z#@][A-Za-z0-9_:&@;/\s/g]*$/);if(!a.test(b)){return false}return true}function isValidContactCustomField(b){var a=$("#"+b).attr("name");if($('ul[name="'+a+'"]').find("li").length==0){return false}else{return true}}jQuery.extend(jQuery.validator.messages,{required:_agile_get_translated_val("validation-msgs","required"),remote:_agile_get_translated_val("validation-msgs","remote"),email:_agile_get_translated_val("validation-msgs","email"),url:_agile_get_translated_val("validation-msgs","url"),date:_agile_get_translated_val("validation-msgs","date"),dateISO:_agile_get_translated_val("validation-msgs","dateISO"),number:_agile_get_translated_val("validation-msgs","number"),digits:_agile_get_translated_val("validation-msgs","digits"),creditcard:_agile_get_translated_val("validation-msgs","creditcard"),equalTo:_agile_get_translated_val("validation-msgs","equalTo"),accept:_agile_get_translated_val("validation-msgs","accept"),maxlength:jQuery.validator.format(_agile_get_translated_val("validation-msgs","maxlength")),minlength:jQuery.validator.format(_agile_get_translated_val("validation-msgs","minlength")),rangelength:jQuery.validator.format(_agile_get_translated_val("validation-msgs","rangelength")),range:jQuery.validator.format(_agile_get_translated_val("validation-msgs","range")),max:jQuery.validator.format(_agile_get_translated_val("validation-msgs","max")),min:jQuery.validator.format(_agile_get_translated_val("validation-msgs","min"))});var TEMPLATE_LIB_PATH="";function downloadTemplate(c,g){var b="html",e=CLOUDFRONT_PATH;if(HANDLEBARS_PRECOMPILATION){c="tpl/min/precompiled/locales/"+_LANGUAGE+"/"+c}else{c="tpl/min/locales/"+_LANGUAGE+"/"+c}if(c.endsWith("js")&&HANDLEBARS_PRECOMPILATION){b="script";e=e.replace("flatfull/","");c=e+c}var f=c.split("/");f=f.length>0?f[f.length-1]:f;c+="?_="+_agile_get_file_hash(f);var a=false;if(g&&typeof(g)==="function"){a=true}console.log(c+" "+b+" "+a);var d=!LOCAL_SERVER;jQuery.ajax({url:c,dataType:b,cache:d,success:function(h){if(b=="html"){$("body").append((h))}if(a){g(h)}},async:a});return""}if(typeof String.prototype.endsWith!=="function"){String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1}}function getTemplateUrls(a){var b=[];if(a.indexOf("settings")==0){b.push("settings.js")}if(a.indexOf("admin-settings")==0){b.push("admin-settings.js")}if(a.indexOf("continue")==0){b.push("continue.js")}if(a.indexOf("all-domain")==0){b.push("admin.js")}if(a.indexOf("contact-detail")==0||a.indexOf("timeline")==0||a.indexOf("company-detail")==0){b.push("contact-detail.js");if(HANDLEBARS_PRECOMPILATION){b.push("contact-detail.html")}}if(a.indexOf("contact-filter")==0||a.indexOf("filter-contacts")==0){b.push("contact-filter.js")}if(a.indexOf("contact-view")==0||a.indexOf("contact-custom")==0||a.indexOf("contacts-custom")==0||a.indexOf("contacts-grid")==0||a.indexOf("company-view")==0||a.indexOf("companies-custom")==0){b.push("contact-view.js")}if(a.indexOf("bulk-actions")==0){b.push("bulk-actions.js")}if(a.indexOf("case")==0){b.push("case.js")}if(a.indexOf("document")==0){b.push("document.js")}if(a.indexOf("voice-mail")==0){b.push("voice-mail.js")}if(a.indexOf("gmap")==0){b.push("gmap.js")}if(a.indexOf("report")==0){b.push("report.js")}if(a.indexOf("webrule")==0){b.push("web-rules.js")}if(a.indexOf("workflow")==0||a.indexOf("campaign")==0||a.indexOf("trigger")==0||a.indexOf("automation")==0){b.push("workflow.js")}if(a.indexOf("purchase")==0||a.indexOf("subscription")==0||a.indexOf("subscribe")==0||a.indexOf("invoice")==0){b.push("billing.js")
}if(a.indexOf("widget")==0){b.push("widget.js")}if(a.indexOf("helpscout")==0){b.push("helpscout.js")}else{if(a.indexOf("clickdesk")==0){b.push("clickdesk.js")}else{if(a.indexOf("zendesk")==0){b.push("zendesk.js")}else{if(a.indexOf("freshbooks")==0){b.push("freshbooks.js")}else{if(a.indexOf("linkedin")==0){b.push("linkedin.js")}else{if(a.indexOf("rapleaf")==0){b.push("rapleaf.js")}else{if(a.indexOf("stripe")==0){b.push("stripe.js")}else{if(a.indexOf("twilioio")==0){b.push("twilioio.js")}else{if(a.indexOf("twilio")==0){b.push("twilio.js")}else{if(a.indexOf("sip")==0){b.push("sip.js")}else{if(a.indexOf("twitter")==0){b.push("twitter.js")}else{if(a.indexOf("googleplus")==0){b.push("googleplus.js")}else{if(a.indexOf("paypal")==0){b.push("paypal.js")}else{if(a.indexOf("xero")==0){b.push("xero.js")}else{if(a.indexOf("braintree")==0){b.push("braintree.js")}else{if(a.indexOf("quickbooks")==0){b.push("quickbooks.js")}else{if(a.indexOf("facebook")==0){b.push("facebook.js")}else{if(a.indexOf("callscript")==0){b.push("callscript.js")}}}}}}}}}}}}}}}}}}if(a.indexOf("chargify")==0){b.push("chargify.js")}if(a.indexOf("shopify")==0){b.push("shopify.js")}if(a.indexOf("socialsuite")==0){b.push("socialsuite.js")}if(a.indexOf("portlet")==0){b.push("portlets.js")}if(a.indexOf("deal-detail")==0){b.push("deal-detail.js")}if(a.indexOf("fbpagetab")==0){b.push("facebookpage.js")}if(a.indexOf("landingpages")==0){b.push("landingpages.js")}if(a.indexOf("emailbuilder")==0){b.push("emailbuilder.js")}if(a.indexOf("segmentation")==0){b.push("segmentation.js")}if(a.indexOf("ticket")==0){b.push("tickets.js")}if(a.indexOf("billing-settings")==0||a.indexOf("creditcard-update")==0){b.push("settings.js")}if(a.indexOf("bria")==0){b.push("bria.js")}if(a.indexOf("skype")==0){b.push("skype.js")}if(a.indexOf("formbuilder")==0){b.push("formbuilder.js")}if(a.indexOf("uservoice")==0){b.push("uservoice.js")}if(a.indexOf("dashboard")==0){b.push("dashboards.js")}if(a.indexOf("refer")==0){b.push("referals.js")}if(a.indexOf("helpcenter")==0){b.push("helpcenter.js")}if(a.indexOf("affiliate")==0){b.push("affiliate.js")}return b}function load_templates_async(a,c,d,e){var b=d.pop();if(!b){getTemplate(a,c,"no",e);return}downloadTemplate(b,function(){load_templates_async(a,c,d,e)})}function load_templates_sync(b){for(var a in b){downloadTemplate(b[a])}}String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1};function getPropertyValue(b,c){if(b==undefined){return}for(var d=0,a=b.length;d<a;d++){if(b[d].name==c){if(b[d].value!=null){b[d].value=b[d].value.trim()}return b[d].value}}}function getSystemPropertyValue(b,c){if(b==undefined){return}for(var d=0,a=b.length;d<a;d++){if(b[d].name==c&&b[d].type=="SYSTEM"){if(b[d].value!=null){b[d].value=b[d].value.trim()}return b[d].value}}}function getPropertyValueByCheckingExistance(d,g,a){if(d==undefined){return}var c=false;var f=false;for(var e=0,b=d.length;e<b;e++){if(d[e].name==g){if(d[e].value){c=true}}else{if(d[e].name==a){if(d[e].value){f=true}}}}if(c&&f){return","}}function getMarginLength(b,d){if(b==undefined){return}for(var c=0,a=b.length;c<a;c++){if(b[c].name==d){return"3px"}}return"0px"}function checkPropertyValueExistance(b,c,f){if(b==undefined){return"none"}var e=false;for(var d=0,a=b.length;d<a;d++){if(b[d].name==c||b[d].name==f){if(b[d].value){e=true}}}if(e==true){return"block"}else{return"none"}}function getAllPropertyValuesByName(b,c,g){if(b==undefined){return}var h="";for(var d=0,a=b.length;d<a;d++){if(b[d].name==c){var f=b[d].value;h+=f+g}}var e=new RegExp("(^"+g+")|("+g+"$)","g");h=h.replace(e,"");console.log(h);return h}function getProperty(b,c){if(b==undefined){return}for(var d=0,a=b.length;d<a;d++){if(b[d].name==c){return b[d]}}}function getCustomProperty(b,c){if(b==undefined){return}for(var d=0,a=b.length;d<a;d++){if(b[d].name==c&&b[d].type=="CUSTOM"){return b[d]}}}function getPropertyValueBySubtype(c,d,b){if(c==undefined){return}for(var e=0,a=c.length;e<a;e++){if(c[e].name==d&&c[e].subtype==b){return c[e].value}}}function getPropertyValueBytype(c,d,f,b){if(c==undefined){return}for(var e=0,a=c.length;e<a;e++){if(c[e].name==d){if(f&&f==c[e].type){if(b&&b==c[e].subtype){return c[e].value}}if(b&&b==c[e].subtype){return c[e].value}}}}function getPropertyValueInCheckbox(b,c,g,f){if(b==undefined){return}var e="";for(var d=0,a=b.length;d<a;d++){if(b[d].name===c){if(c==="website"){if(f==="checked"){e=e.concat('<label class="i-checks i-checks-sm"><input type="checkbox" field="'+c+'" subtype="'+get_subtype_value(b[d])+'" data="'+b[d].value+'" oid="'+g+'" checked="'+f+'"><i></i></label>'+b[d].value)}else{e=e.concat('<label class="i-checks i-checks-sm"><input type="checkbox" field="'+c+'" subtype="'+get_subtype_value(b[d])+'" data="'+b[d].value+'" oid="'+g+'"><i></i></label>'+b[d].value)}e=e.concat(get_website_icon(b[d]))}else{if(c==="phone"){if(f==="checked"){e=e.concat('<label class="i-checks i-checks-sm"><input type="checkbox" field="'+c+'" subtype="'+get_subtype_value(b[d])+'" data="'+b[d].value+'" oid="'+g+'" checked="'+f+'"><i></i></label>'+b[d].value)}else{e=e.concat('<label class="i-checks i-checks-sm"><input type="checkbox" field="'+c+'" subtype="'+get_subtype_value(b[d])+'" data="'+b[d].value+'" oid="'+g+'"><i></i></label>'+b[d].value)}e=e.concat(get_subtype(b[d]))}else{if(c==="email"){if(f==="checked"){e=e.concat('<label class="i-checks i-checks-sm"><input type="checkbox" field="'+c+'" subtype="'+get_subtype_value(b[d])+'" data="'+b[d].value+'" oid="'+g+'" checked="'+f+'"><i></i></label>'+b[d].value)}else{e=e.concat('<label class="i-checks i-checks-sm"><input type="checkbox" field="'+c+'" subtype="'+get_subtype_value(b[d])+'" data="'+b[d].value+'" oid="'+g+'"><i></i></label>'+b[d].value)}e=e.concat(get_subtype(b[d]))}}}}}return e}function get_website_icon(b){var a=get_social_icon(b.subtype);var c='<i class="'.concat(a).concat('"').concat(' style="font-size: 1.3em !important; margin-left:10px "></i> <br>');return c}function get_social_icon(b){if(!b){return"fa fa-globe"}var a={TWITTER:"fa fa-twitter",LINKEDIN:"fa fa-linkedin-square",URL:"fa fa-globe","GOOGLE-PLUS":"fa fa-google-plus-square",FACEBOOK:"fa fa-facebook-square",GITHUB:"fa fa-github",FEED:"icon-rss",XING:"fa fa-xing-square",SKYPE:"icon-skype",YOUTUBE:"fa fa-youtube-square",FLICKR:"fa fa-flickr"};b=b.trim();if(a[b]){return a[b]}return"fa fa-globe"}function get_subtype(a){if(a.subtype!=undefined&&a.subtype!=""){var b='<span style="margin:3px 0px 3px 10px">'.concat(a.subtype).concat("</span> <br>");return b}else{return"<br>"}}function get_subtype_value(a){if(a.subtype!=undefined&&a.subtype!=""){var b=a.subtype;return b}else{return""}}function getContactCustomProperties(items){if(items==undefined){return items}var fields=[];var fieldName="";var datajson={};for(var i=0;i<items.length;i++){if(items[i].type=="CUSTOM"&&items[i].name!="image"){if(fieldName==""){fieldName=items[i].name}fields.push(items[i]);datajson[""+items[i].name]=items[i].value}}var type="";if(App_Contacts.customFieldsList!=undefined&&App_Contacts.customFieldsList!=null){for(var i=0;i<App_Contacts.customFieldsList.collection.models.length;i++){if(App_Contacts.customFieldsList.collection.models[i].get("field_label")==fieldName){type=App_Contacts.customFieldsList.collection.models[i].get("scope");break}}}var formulaFields=[];var allCustomFields=[];var finalFields=[];if(App_Contacts.customFieldsList!=undefined&&App_Contacts.customFieldsList!=null){if(type==""){type="CONTACT"}for(var i=0;i<App_Contacts.customFieldsList.collection.models.length;i++){var json={};if(App_Contacts.customFieldsList.collection.models[i].get("scope")==type&&App_Contacts.customFieldsList.collection.models[i].get("field_type")=="FORMULA"){var tplEleData=Mustache.render(App_Contacts.customFieldsList.collection.models[i].get("field_data"),datajson);var evalFlag=true;var tplEleDataAftEval;try{tplEleDataAftEval=eval(tplEleData)}catch(err){console.log(err.message);evalFlag=false}if(!evalFlag){tplEleDataAftEval=tplEleData}if(evalFlag&&tplEleDataAftEval!=undefined&&tplEleDataAftEval!=null){json.name=App_Contacts.customFieldsList.collection.models[i].get("field_label");json.type="CUSTOM";json.position=App_Contacts.customFieldsList.collection.models[i].get("position");json.value=tplEleDataAftEval;json.field_type=App_Contacts.customFieldsList.collection.models[i].get("field_type");allCustomFields.push(json);formulaFields.push(json)}}else{if(App_Contacts.customFieldsList.collection.models[i].get("scope")==type){json.name=App_Contacts.customFieldsList.collection.models[i].get("field_label");json.type="CUSTOM";json.position=App_Contacts.customFieldsList.collection.models[i].get("position");json.field_type=App_Contacts.customFieldsList.collection.models[i].get("field_type");allCustomFields.push(json)}}}}if(fields.length>0){if(allCustomFields.length>0){for(var i=0;i<allCustomFields.length;i++){var isFieldExist=false;if(allCustomFields[i].field_type=="FORMULA"){if($.inArray(allCustomFields[i],finalFields)==-1){finalFields.push(allCustomFields[i])}}else{for(var j=0;j<fields.length;j++){if(allCustomFields[i].name==fields[j].name){if($.inArray(fields[j],finalFields)==-1){for(var m=0;m<allCustomFields.length;m++){if(fields[j].name==allCustomFields[m].name&&(allCustomFields[m].field_type=="CONTACT"||allCustomFields[m].field_type=="COMPANY")){fields[j].custom_field_type=allCustomFields[m].field_type}}finalFields.push(fields[j])}isFieldExist=true;break}if(!isFieldExist){if($.inArray(fields[j],finalFields)==-1){for(var m=0;m<allCustomFields.length;m++){if(fields[j].name==allCustomFields[m].name&&(allCustomFields[m].field_type=="CONTACT"||allCustomFields[m].field_type=="COMPANY")){fields[j].custom_field_type=allCustomFields[m].field_type}}finalFields.push(fields[j])}}}}}}else{for(var k=0;k<fields.length;k++){if($.inArray(fields[k],finalFields)==-1){finalFields.push(fields[k])}}}}else{for(var k=0;k<formulaFields.length;k++){if($.inArray(formulaFields[k],finalFields)==-1){finalFields.push(formulaFields[k])}}}return finalFields
}function getCompanyCustomProperties(items){if(items==undefined){return items}var fields=[];var fieldName="";var datajson={};for(var i=0;i<items.length;i++){if(items[i].type=="CUSTOM"&&items[i].name!="image"){if(fieldName==""){fieldName=items[i].name}fields.push(items[i]);datajson[""+items[i].name]=items[i].value}}var type="";if(App_Companies.customFieldsList!=undefined&&App_Companies.customFieldsList!=null){for(var i=0;i<App_Companies.customFieldsList.collection.models.length;i++){if(App_Companies.customFieldsList.collection.models[i].get("field_label")==fieldName){type=App_Companies.customFieldsList.collection.models[i].get("scope");break}}}var formulaFields=[];var allCustomFields=[];var finalFields=[];if(App_Companies.customFieldsList!=undefined&&App_Companies.customFieldsList!=null){if(type==""){type="CONTACT"}for(var i=0;i<App_Companies.customFieldsList.collection.models.length;i++){var json={};if(App_Companies.customFieldsList.collection.models[i].get("scope")==type&&App_Companies.customFieldsList.collection.models[i].get("field_type")=="FORMULA"){var tplEleData=Mustache.render(App_Companies.customFieldsList.collection.models[i].get("field_data"),datajson);var evalFlag=true;var tplEleDataAftEval;try{tplEleDataAftEval=eval(tplEleData)}catch(err){console.log(err.message);evalFlag=false}if(!evalFlag){tplEleDataAftEval=tplEleData}if(evalFlag&&tplEleDataAftEval!=undefined&&tplEleDataAftEval!=null){json.name=App_Companies.customFieldsList.collection.models[i].get("field_label");json.type="CUSTOM";json.position=App_Companies.customFieldsList.collection.models[i].get("position");json.value=tplEleDataAftEval;json.field_type=App_Companies.customFieldsList.collection.models[i].get("field_type");allCustomFields.push(json);formulaFields.push(json)}}else{if(App_Companies.customFieldsList.collection.models[i].get("scope")==type){json.name=App_Companies.customFieldsList.collection.models[i].get("field_label");json.type="CUSTOM";json.position=App_Companies.customFieldsList.collection.models[i].get("position");json.field_type=App_Companies.customFieldsList.collection.models[i].get("field_type");allCustomFields.push(json)}}}}if(fields.length>0){if(allCustomFields.length>0){for(var i=0;i<allCustomFields.length;i++){var isFieldExist=false;if(allCustomFields[i].field_type=="FORMULA"){finalFields.push(allCustomFields[i])}else{for(var j=0;j<fields.length;j++){if($.inArray(fields[j],finalFields)==-1){if(allCustomFields[i].name==fields[j].name){for(var m=0;m<allCustomFields.length;m++){if(fields[j].name==allCustomFields[m].name&&(allCustomFields[m].field_type=="CONTACT"||allCustomFields[m].field_type=="COMPANY")){fields[j].custom_field_type=allCustomFields[m].field_type}}finalFields.push(fields[j]);isFieldExist=true;break}}if(!isFieldExist){if($.inArray(fields[j],finalFields)==-1){for(var m=0;m<allCustomFields.length;m++){if(fields[j].name==allCustomFields[m].name&&(allCustomFields[m].field_type=="CONTACT"||allCustomFields[m].field_type=="COMPANY")){fields[j].custom_field_type=allCustomFields[m].field_type}}finalFields.push(fields[j])}}}}}}else{for(var k=0;k<fields.length;k++){if($.inArray(fields[k],finalFields)==-1){finalFields.push(fields[k])}}}}else{for(var k=0;k<formulaFields.length;k++){if($.inArray(fields[k],finalFields)==-1){finalFields.push(formulaFields[k])}}}return finalFields}function ucfirst(a){return(a&&typeof a==="string")?(a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()):""}function titleFromEnums(a){if(!a){return}var b=a.replace(/_/g," ");return ucfirst(b.toLowerCase())}function countJsonProperties(b){var c;var a=0;for(c in b){a++}return a}function getCurrentContactProperty(b){if(App_Contacts.contactDetailView&&App_Contacts.contactDetailView.model){var a=App_Contacts.contactDetailView.model.get("properties");return getPropertyValue(a,b)}}function getCount(a){if(a[0]&&a[0].count&&(a[0].count!=-1)){return"("+a[0].count+" "+_agile_get_translated_val("other","total")+")"}else{return"("+a.length+" "+_agile_get_translated_val("other","total")+")"}}function getTaskCount(a){if(a[0]&&a[0].count&&(a[0].count!=-1)){return a[0].count}else{return a.length}}function getIdFromHash(){var a=window.location.hash.substr(1);if(a.substr(-1)==="/"){a=a.replace(/\/$/,"")}var b=a.split("/").pop();return b}function updateCustomData(a){$(".custom-data",App_Contacts.contactDetailView.el).html(a)}function updateCompanyCustomData(a){$(".custom-data",App_Companies.companyDetailView.el).html(a)}function getDealCustomProperties(items){if(items==undefined){return items}var fields=[];var datajson={};for(var i=0;i<items.length;i++){fields.push(items[i]);datajson[""+items[i].name]=items[i].value}var formulaFields=[];var allCustomFields=[];var finalFields=[];if(App_Deals.customFieldsList!=undefined&&App_Deals.customFieldsList!=null){for(var i=0;i<App_Deals.customFieldsList.collection.models.length;i++){var json={};if(App_Deals.customFieldsList.collection.models[i].get("field_type")=="FORMULA"){var tplEleData=Mustache.render(App_Deals.customFieldsList.collection.models[i].get("field_data"),datajson);var evalFlag=true;var tplEleDataAftEval;try{tplEleDataAftEval=eval(tplEleData)}catch(err){console.log(err.message);evalFlag=false}if(!evalFlag){tplEleDataAftEval=tplEleData}if(evalFlag&&tplEleDataAftEval!=undefined&&tplEleDataAftEval!=null){json.name=App_Deals.customFieldsList.collection.models[i].get("field_label");json.position=App_Deals.customFieldsList.collection.models[i].get("position");json.value=tplEleDataAftEval;json.field_type=App_Deals.customFieldsList.collection.models[i].get("field_type");allCustomFields.push(json);formulaFields.push(json)}}else{json.name=App_Deals.customFieldsList.collection.models[i].get("field_label");json.position=App_Deals.customFieldsList.collection.models[i].get("position");json.field_type=App_Deals.customFieldsList.collection.models[i].get("field_type");allCustomFields.push(json)}}}if(fields.length>0){if(allCustomFields.length>0){for(var i=0;i<allCustomFields.length;i++){if(allCustomFields[i].field_type=="FORMULA"){finalFields.push(allCustomFields[i])}else{if(allCustomFields[i].field_type=="DATE"){for(var j=0;j<fields.length;j++){if(allCustomFields[i].name==fields[j].name){fields[j].is_date=true;if(!fields[j].value){return""}finalFields.push(fields[j]);break}}}else{for(var j=0;j<fields.length;j++){if(allCustomFields[i].name==fields[j].name){if(allCustomFields[i].field_type=="CONTACT"){fields[j].custom_field_type="CONTACT"}else{if(allCustomFields[i].field_type=="COMPANY"){fields[j].custom_field_type="COMPANY"}}finalFields.push(fields[j]);break}}}}}}else{for(var k=0;k<fields.length;k++){finalFields.push(fields[k])}}}else{for(var k=0;k<formulaFields.length;k++){finalFields.push(formulaFields[k])}}return finalFields}$(function(){Handlebars.registerHelper("getPropertyValue",function(f,g){return getPropertyValue(f,g)});Handlebars.registerHelper("getSystemPropertyValue",function(f,g){return getSystemPropertyValue(f,g)});Handlebars.registerHelper("stripeCreditConvertion",function(f){if(f==0){return(f)}else{if(f>0){return("-"+parseFloat(f/100))}else{return(Math.abs(parseFloat(f/100)))}}});Handlebars.registerHelper("getPropertyValueExists",function(g,h,f){return getPropertyValueByCheckingExistance(g,h,f)});Handlebars.registerHelper("checkPropertyValueExistance",function(f,g,h){return checkPropertyValueExistance(f,g,h)});Handlebars.registerHelper("getMarginLength",function(f,g){return getMarginLength(f,g)});Handlebars.registerHelper("getPropertyValueInCheckbox",function(f,g,i,h){return getPropertyValueInCheckbox(f,g,i,h)});Handlebars.registerHelper("get_correct_count",function(f){return f-1});Handlebars.registerHelper("getPropertyValueBySubtype",function(g,h,f){return getPropertyValueBySubtype(g,h,f)});Handlebars.registerHelper("getPropertyValueBytype",function(g,h,i,f){return getPropertyValueBytype(g,h,i,f)});Handlebars.registerHelper("getTwitterHandleByURL",function(f){f=f.substring(f.lastIndexOf("/")+1);console.log(f);return f});Handlebars.registerHelper("getContactCustomProperties",function(g,h){var f=getContactCustomProperties(g);if(f.length==0){return h.inverse(f)}return h.fn(f)});Handlebars.registerHelper("getContactCustomPropertiesExclusively",function(h,j){var l=["LINKEDIN","TWITTER"];var m=["title"];var g=getContactCustomProperties(h);var f=[];for(var k=0;k<g.length;k++){if(jQuery.inArray(g[k].name,m)!=-1||(g[k].subtype&&jQuery.inArray(g[k].subtype,l)!=-1)){continue}f.push(jQuery.extend(true,{},g[k]))}if(f.length==0){return j.inverse(f)}$.getJSON("core/api/custom-fields/type/DATE",function(r){if(r.length==0){return}for(var n=0;n<r.length;n++){for(var o=0;o<f.length;o++){if(f[o].name==r[n].field_label){try{var q=f[o].value;if(!isNaN(q)){f[o].value=q;f[o]["subtype"]=r[n].field_type}}catch(p){f[o].value=f[o].value}}}}updateCustomData(j.fn(f))});return j.fn(f)});Handlebars.registerHelper("getCompanyCustomPropertiesExclusively",function(h,j){var l=["LINKEDIN","TWITTER"];var m=["title"];var g=getCompanyCustomProperties(h);var f=[];for(var k=0;k<g.length;k++){if(jQuery.inArray(g[k].name,m)!=-1||(g[k].subtype&&jQuery.inArray(g[k].subtype,l)!=-1)){continue}f.push(jQuery.extend(true,{},g[k]))}if(f.length==0){return j.inverse(f)}$.getJSON("core/api/custom-fields/type/DATE",function(r){if(r.length==0){return}for(var n=0;n<r.length;n++){for(var o=0;o<f.length;o++){if(f[o].name==r[n].field_label){try{var q=f[o].value;if(!isNaN(q)){f[o].value=q;f[o]["subtype"]=r[n].field_type}}catch(p){f[o].value=f[o].value}}}}updateCompanyCustomData(j.fn(f))});return j.fn(f)});Handlebars.registerHelper("urlEncode",function(g,h,j){var f="&";if(g.indexOf("?")!=-1){f="&"}var i=g+f+h+"="+escape(JSON.stringify(j));return i});Handlebars.registerHelper("hasTagPermission",function(f){if(ACCOUNT_PREFS.tagsPermission){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("encodeString",function(f){return encodeURIComponent(f)});Handlebars.registerHelper("gravatarurl",function(n,g,o){if(n==undefined){return}var f=getPropertyValue(n,"image");if(f){return f
}var j=DEFAULT_GRAVATAR_url;var k="&d="+DEFAULT_GRAVARTAR_IMG+'" ';var h="";try{h=text_gravatar_initials(n,o)}catch(l){console.log(l)}if(h.length==0){k="&d="+DEFAULT_GRAVATAR_url+'" '}var i="";i='onLoad="image_load(this)" _data-name="'+h;var m=getPropertyValue(n,"email");if(m){return new Handlebars.SafeString("https://secure.gravatar.com/avatar/"+Agile_MD5(m)+".jpg?s="+g+k+i)}return new Handlebars.SafeString("https://secure.gravatar.com/avatar/"+Agile_MD5("")+".jpg?s="+g+""+k+i)});Handlebars.registerHelper("defaultGravatarurl",function(g){var f=DEFAULT_GRAVATAR_url;return"https://secure.gravatar.com/avatar/"+Agile_MD5("")+".jpg?s="+g+"&d="+escape(f)});Handlebars.registerHelper("emailGravatarurl",function(h,g){var f=DEFAULT_GRAVATAR_url;if(g){return"https://secure.gravatar.com/avatar/"+Agile_MD5(g)+".jpg?s="+h+"&d="+escape(f)}return"https://secure.gravatar.com/avatar/"+Agile_MD5("")+".jpg?s="+h+"&d="+escape(f)});Handlebars.registerHelper("nameAvatar",function(f,h){if(f==undefined){return}var i=getPropertyValue(f,"image");if(i){return i}var g=getPropertyValue(f,"email");if(g){return"https://secure.gravatar.com/avatar/"+Agile_MD5(g)+".jpg?s="+h+"&d=404"}return"https://secure.gravatar.com/avatar/"+Agile_MD5("")+".jpg?s="+h+"&d=404"});Handlebars.registerHelper("dataNameAvatar",function(f,g){if(f==undefined){return}return text_gravatar_initials(f,g)});Handlebars.registerHelper("icons",function(f){if(!f){return""}f=f.toLowerCase().trim();console.log(f);if(f=="email"){return"fa-envelope-o"}if(f=="phone"){return"fa-headphones"}if(f=="url"){return"fa-home"}if(f=="call"){return"fa-phone"}if(f=="follow_up"){return"fa-sign-out"}if(f=="meeting"){return"fa-group"}if(f=="milestone"){return"fa-cog"}if(f=="send"){return"fa-reply"}if(f=="tweet"){return"fa-share-square-o"}if(f=="other"){return"fa-tasks"}if(f=="twitter"){return"fa-twitter"}if(f=="facebook"){return"fa-facebook"}});Handlebars.registerHelper("eachkeys",function(i,h){var j=h.fn,f=h.inverse;var g="";var k=true;for(key in i){k=false;break}if(!k){for(key in i){g=g+j({key:key,value:i[key]})}}else{g=f(this)}return g});Handlebars.registerHelper("ucfirst",function(f){return(f&&typeof f==="string")?(f.charAt(0).toUpperCase()+f.slice(1).toLowerCase()):""});Handlebars.registerHelper("contactShortName",function(){if(App_Contacts.contactDetailView&&App_Contacts.contactDetailView.model&&!company_util.isCompany()){var g=App_Contacts.contactDetailView.model.get("properties");if(App_Contacts.contactDetailView.model.get("type")=="PERSON"){var f;for(var h=0;h<g.length;h++){if(g[h].name=="last_name"){f=g[h].value}else{if(g[h].name=="first_name"){return g[h].value}}}if(f&&f!=null){return f}return"Contact"}else{for(var h=0;h<g.length;h++){if(g[h].name=="name"){return g[h].value}}return"Company"}}else{if(App_Companies.companyDetailView&&App_Companies.companyDetailView.model){var g=App_Companies.companyDetailView.model.get("properties");for(var h=0;h<g.length;h++){if(g[h].name=="name"){return g[h].value}}return"Company"}}});Handlebars.registerHelper("isCompany",function(f){if(company_util.isCompany()){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("workflowName",function(){if(App_Workflows.workflow_model){var f=App_Workflows.workflow_model.get("name");return"'"+f+"'"}return"this"});Handlebars.registerHelper("task_property",function(f){if(f=="FOLLOW_UP"){return"Follow Up"}else{return ucfirst(f)}});Handlebars.registerHelper("show_custom_fields_for_merge",function(g,h){var f=show_custom_fields_helper_for_merge(g,h);return new Handlebars.SafeString(f)});Handlebars.registerHelper("add_dots_end",function(g){if(g){if(g.length>100){var f=g.substr(0,100);f=f+"....";return f}}return g});Handlebars.registerHelper("tagslist",function(n){console.log(n);var m={};for(var h=0;h<n.length;h++){var o=n[h].tag;var g=o.charAt(0).toUpperCase();var k=new Array();if(m[g]!=undefined){k=m[g]}k.push(o);m[g]=k}var l=Object.keys(m);l.sort();var j="";for(var h in l){var k=m[l[h]];j+="<div class='tag-element'><div class='tag-key'>"+l[h]+"</div> ";j+="<div class='tag-values'>";for(var h=0;h<k.length;h++){console.log("************************");console.log(k[h]);var f="#tags/"+encodeURIComponent(k[h]);j+=('<a href="'+f+'" >'+k[h]+"</a> ")}j+="</div></div>"}return j});Handlebars.registerHelper("setupTags",function(g){console.log(g);var l={};var m=[];for(var k=0;k<g.length;k++){var f=g[k].tag;var j=f.charAt(0).toUpperCase();if(jQuery.inArray(j,m)==-1){m.push(j)}}m.sort();console.log(m);var h="";for(var k=0;k<m.length;k++){h+="<div class='tag-element' style='margin-right:10px;'><div class='tag-key'>"+m[k]+"</div><div class='tag-values' tag-alphabet=\""+encodeURI(m[k])+'"></div></div>'}return new Handlebars.SafeString(h)});Handlebars.registerHelper("deals_by_milestones",function(h){var f="";var g=Object.keys(h).length;$.each(h,function(k,l){if(g==1&&k==""){f+='<div class="alert-info alert"><div class="slate-content"><div class="box-left pull-left m-r-md"><img alt="Clipboard" src="'+updateImageS3Path("/img/clipboard.png")+'"></div><div class="box-right pull-left"><h4 class="m-t-none">You have no milestones defined</h4><br><a href="#milestones" class="btn btn-default btn-sm m-t-xs"><i class="icon icon-plus-sign"></i> Add Milestones</a></div><div class="clearfix"></div></div></div>'}else{f+="<div class='milestone-column'><div class='dealtitle-angular'><p class='milestone-heading'>"+k+"</p><span></span></div><ul class='milestones' milestone='"+k+"'>";for(var j in l){if(l[j].id){f+="<li id='"+l[j].id+"'>"+getTemplate("opportunities-grid-view",l[j])+"</li>"}}f+="</ul></div>"}});return f});Handlebars.registerHelper("milestone_ul",function(l){var j="";var h="Deals with this milestone are considered as Won.";var k="Deals with this milestone are considered as Lost.";if(l){var g=l.milestones.split(",");for(var f in g){j+="<tr data='"+g[f]+"' style='display: table-row;'><td><div class='milestone-name-block inline-block v-top text-ellipsis' style='width:80%'>";if(g[f]==l.won_milestone){j+=g[f]+"<i data-toogle='tooltip' title='"+h+"' class='icon-like mark-won m-l-sm'></i></div></td><td class='b-r-none'><div class='m-b-n-xs'>";j+="<a class='milestone-won text-l-none-hover c-p text-xs hover-show disabled' style='visibility:hidden;' data-toggle='tooltip' title='Set as Won Milestone'><i class='icon-like'></i></a>";j+="<a class='milestone-lost text-l-none-hover c-p text-xs m-l-sm not-applicable hover-show' style='visibility:hidden;' data-toggle='tooltip' title='Set as Lost Milestone'><i class='icon-dislike'></i></a>"}else{if(g[f]==l.lost_milestone){j+=g[f]+"<i data-toogle='tooltip' title='"+k+"' class='icon-dislike mark-lost m-l-sm'></i></div></td><td class='b-r-none'><div class='m-b-n-xs'>";j+="<a class='milestone-won text-l-none-hover c-p text-xs not-applicable hover-show' style='visibility:hidden;' data-toggle='tooltip' title='Set as Won Milestone'><i class='icon-like'></i></a>";j+="<a class='milestone-lost text-l-none-hover c-p text-xs m-l-sm hover-show disabled' style='visibility:hidden;' data-toggle='tooltip' title='Set as Lost Milestone'><i class='icon-dislike'></i></a>"}else{j+=g[f]+"</div></td><td class='b-r-none'><div class='m-b-n-xs'>";j+="<a class='milestone-won text-l-none-hover c-p text-xs hover-show' style='visibility:hidden;' data-toggle='tooltip' title='Set as Won Milestone'><i class='icon-like'></i></a>";j+="<a class='milestone-lost text-l-none-hover c-p text-xs m-l-sm hover-show' style='visibility:hidden;' data-toggle='tooltip' title='Set as Lost Milestone'><i class='icon-dislike'></i></a>"}}j+="<a class='milestone-delete c-p m-l-sm text-l-none text-xs hover-show' style='visibility:hidden;' data-toggle='tooltip' title='Delete Milestone'><i class='icon icon-trash'></i></a><a class='text-l-none-hover c-p text-xs m-l-sm hover-show' style='visibility:hidden;'><i title='Drag' class='icon-move'></i></a></div></td></tr>"}}return j});Handlebars.registerHelper("epochToHumanDate",function(h,f){if(!h){h="mmm dd yyyy HH:MM:ss"}if(!f){return}console.log(h+" : "+f);if((f/100000000000)>1){return new Date(parseInt(f)).format(h,0)}var i="";try{i=new Date(parseInt(f)*1000).format(h)}catch(g){console.log("Invalid date for custom field.")}return i});Handlebars.registerHelper("paypalInvoiceDate",function(h,f){if(f){var g=f.replace(/-/g,"//");if(!h){h="ddd mmm dd yyyy"}var i=new Date(g).format(h);return i}});Handlebars.registerHelper("decodeString",function(f){return f});Handlebars.registerHelper("uservoicedate",function(g){if(g){var f=new Date(g);f=(f.getMonth()+1)+"/"+f.getDate()+"/"+f.getFullYear()+" "+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds();return f}});Handlebars.registerHelper("epochToHumanDateInFormat",function(f){if(!f){return}return getDateInFormatFromEpoc(f)});Handlebars.registerHelper("dateFormat",function(){return _agile_get_translated_val("contacts","select-date")});Handlebars.registerHelper("currentDateInFormat",function(f){if(!f){return}f=f.replace(/MM/g,"mmmm").replace(/M/g,"mmm").replace(/DD/g,"dddd").replace(/D/g,"ddd");return new Date().format(f)});Handlebars.registerHelper("stringToHumanDateInFormat",function(f){if(!f){return}var g=new Date(f);if(g=="Invalid Date"){return getDateInFormatFromEpoc(f)}else{return en.dateFormatter({raw:getGlobalizeFormat()})(g)}});Handlebars.registerHelper("toLocalTimezone",function(g){var f=new Date(g);return f.toDateString()+" "+f.toLocaleTimeString()});Handlebars.registerHelper("toLocalTimezoneFromUtc",function(g){var f=new Date(g+" GMT+0000");return f.toDateString()+" "+f.toLocaleTimeString()});Handlebars.registerHelper("epochToTaskDate",function(f){try{f=parseInt(f)}catch(i){}var h,j;if((f/100000000000)>1){h=new Date(f).getMonth();j=new Date(f).getDate()}else{h=new Date(parseInt(f)*1000).getMonth();j=new Date(parseInt(f)*1000).getDate()}var g=["Jan","Feb","March","April","May","June","July","Aug","Sept","Oct","Nov","Dec"];return(_agile_get_translated_val("months-xs",g[h])+" "+j)});Handlebars.registerHelper("task_label_color",function(f){if(f=="HIGH"||f=="red"){return"danger"
}if(f=="NORMAL"||f=="#36C"){return"info"}if(f=="LOW"){return"label bg-light dk"}if(f=="green"){return"success"}});Handlebars.registerHelper("event_priority",function(f){if(f=="red"||f=="#f05050"){return"High"}if(f=="#36C"||f=="#23b7e5"||f=="blue"){return"Normal"}if(f=="green"||f=="#bbb"){return"Low"}});Handlebars.registerHelper("event_label_color",function(f){if(f=="red"||f=="#f05050"){return"danger"}if(f=="#36C"||f=="#23b7e5"||f=="blue"){return"primary"}if(f=="green"||f=="#bbb"){return"warning"}});Handlebars.registerHelper("network",function(f){if(f=="GOOGLE"){return"Google Drive"}if(f=="S3"){return"Uploaded Doc"}});Handlebars.registerHelper("epochToDate",function(f,h){var k=JSON.parse(f);if(!k[h]){return"-"}if(h){if((k[h]/100000000000)>1){return new Date(parseInt(k[h])).format("mmm dd yyyy HH:MM:ss",0)}return new Date(parseInt(k[h])*1000).format("mmm dd yyyy HH:MM:ss",0)}else{var j=new Date(parseInt(k[h])*1000).getMonth();var l=new Date(parseInt(k[h])*1000).getDate();var i=new Date(parseInt(k[h])*1000).getFullYear();var g=["Jan","Feb","March","April","May","June","July","Aug","Sept","Oct","Nov","Dec"];return(_agile_get_translated_val("months-xs",g[j])+" "+l+", "+i)}});Handlebars.registerHelper("currencySymbol",function(){var g=((CURRENT_USER_PREFS.currency!=null)?CURRENT_USER_PREFS.currency:"USD-$");var f=((g.length<4)?"$":g.substring(4,g.length));if(f=="Rs"){f="Rs."}return f});Handlebars.registerHelper("mandrill_exist",function(f){if(IS_HAVING_MANDRILL){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("calculatePipeline",function(g,h){var f=parseInt(g)*parseInt(h)/100;return f});Handlebars.registerHelper("getRequiredLog",function(i,h){var f=JSON.parse(i);if(h=="t"){var g=new Date(f[0][h]*1000);return g}return f[0][h]});Handlebars.registerHelper("iscompactTabel",function(h,f){var g=(h!="PERSON")?_agile_get_prefs("companyTabelView"):_agile_get_prefs("contactTabelView");if(g){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("iscompactContactTabel",function(f){if(_agile_get_prefs("contactTabelView")){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("contactTableHeadings",function(h){var g="",f="";$.each(App_Contacts.contactViewModel[h],function(i,j){if(j=="basic_info"||j=="image"){if(_agile_get_prefs("contactTabelView")){if(j=="basic_info"){return}if(j=="image"){j="";f=""}}else{if(j=="image"){j="";f="compactcontact"}if(j=="basic_info"){j="Basic Info"}}}else{if(j.indexOf("CUSTOM_")==0){j=j.split("_")[1];f="text-muted"}else{j=j.replace("_"," ");f=""}}j=getTableLanguageConvertHeader(j);g=g.concat('<th class="'+f+'">'+ucfirst(j)+"</th>")});return new Handlebars.SafeString(g)});Handlebars.registerHelper("reportsContactTableHeadings",function(g){var f="";$.each(REPORT[g],function(h,i){if(i.indexOf("properties_")!=-1){i=i.split("properties_")[1]}if(i.indexOf("custom_")==0){i=i.split("custom_")[1]}i=i.replace("_"," ");f=f.concat("<th>"+ucfirst(i)+"</th>")});return new Handlebars.SafeString(f)});Handlebars.registerHelper("if_entity",function(g,f){if(this.entity_type==g){return f.fn(this)}if(!this.entity&&this[g]!=undefined){return f.fn(this)}});Handlebars.registerHelper("titleFromEnums",function(f){if(!f){return}var g=f.replace(/_/g," ");return ucfirst(g.toLowerCase())});Handlebars.registerHelper("actionTemplate",function(i){if(!i){return}var h={MODAL_POPUP:"Modal Popup",CORNER_NOTY:"Noty Message",CALL_POPUP:"Call Popup",SITE_BAR:"Site Bar",ASSIGN_CAMPAIGN:"Add to Campaign",UNSUBSCRIBE_CAMPAIGN:"Remove from Campaign",ADD_TAG:"Add Tag",REMOVE_TAG:"Remove Tag",ADD_SCORE:"Add Score",SUBTRACT_SCORE:"Substract Score",JAVA_SCRIPT:"Java Script",};var f=i.length;var g='<div class="table-resp">';$.each(i,function(j,k){if(--f==0){g=g.concat(titleFromEnums(h[k.action]?h[k.action]:k.action));return}g=g.concat(titleFromEnums(h[k.action]?h[k.action]:k.action)+", ")});g=g.concat("</div>");return new Handlebars.SafeString(g)});Handlebars.registerHelper("triggerType",function(g){var f={TAG_IS_ADDED:"Tag is added",TAG_IS_DELETED:"Tag is deleted",CONTACT_IS_ADDED:"Contact is added",DEAL_IS_ADDED:"Deal is added",DEAL_IS_DELETED:"Deal is deleted",DEAL_MILESTONE_IS_CHANGED:"Deal milestone is changed",RUNS_DAILY:"Daily",RUNS_WEEKLY:"Weekly",RUNS_MONTHLY:"Monthly",STRIPE_CHARGE_EVENT:"Stripe Event",INBOUND_MAIL_EVENT:"New Email",EMAIL_OPENED:"Email Opened",EMAIL_LINK_CLICKED:"Email Link Clicked",UNSUBSCRIBED:"Unsubscribed",SOFT_BOUNCE:"Soft Bounce",HARD_BOUNCE:"Hard Bounce",SPAM_REPORT:"Spam Report",EVENT_IS_ADDED:"Event is added",INBOUND_CALL:"Inbound Call",OUTBOUND_CALL:"Outbound Call",SHOPIFY_EVENT:"Shopify Event",FORM_SUBMIT:"Form Submit",NEW_TICKET_IS_ADDED:"New ticket is added",TICKET_NOTE_ADDED_BY_USER:"Note is added by user",TICKET_NOTE_ADDED_BY_CUSTOMER:"Note is added by customer",TICKET_IS_CLOSED:"Ticket is closed",TICKET_SLA_REACHED:"SLA reached",TICKET_ASSIGNEE_CHANGED:"Ticket assignee changed",TICKET_LABEL_IS_ADDED:"Ticket label is added",TICKET_LABEL_IS_DELETED:"Ticket label is deleted",};if(g=="ADD_SCORE"){return g.replace("ADD_SCORE","Score (>=)")}if(f[g]){return titleFromEnums(f[g])}return titleFromEnums(g)});Handlebars.registerHelper("if_notification_type",function(){if(this.type=="COMPANY"){var f=this.notification.split("_");var g=ucfirst(f[0].replace("CONTACT","COMPANY"))+" "+ucfirst(f[1]);return" - "+g}var i=this.notification.replace(/_/," ");switch(i){case"IS BROWSING":return i.toLowerCase()+" "+this.custom_value;case"CLICKED LINK":var h=JSON.parse(this.custom_value);if(h.workflow_name==undefined){return i.toLowerCase()+" "+h.url_clicked}return i.toLowerCase()+" "+h.url_clicked+'  of campaign "'+h.workflow_name+'"';case"OPENED EMAIL":var h=JSON.parse(this.custom_value);if(h.hasOwnProperty("workflow_name")){return i.toLowerCase()+'  of campaign "'+h.workflow_name+'"'}return i.toLowerCase()+' with subject "'+h.email_subject+'"';case"CONTACT ADDED":return" - "+ucfirst(i.split(" ")[0])+" "+ucfirst(i.split(" ")[1]);case"CONTACT DELETED":return" - "+ucfirst(i.split(" ")[0])+" "+ucfirst(i.split(" ")[1]);case"DEAL CREATED":return" - "+ucfirst(i.split(" ")[0])+" "+ucfirst(i.split(" ")[1]);case"DEAL CLOSED":return" - "+ucfirst(i.split(" ")[0])+" "+ucfirst(i.split(" ")[1]);case"TAG ADDED":return' - "'+this.custom_value+'" '+i.toLowerCase().split(" ")[0]+" has been "+i.toLowerCase().split(" ")[1];case"TAG DELETED":return' - "'+this.custom_value+'" '+i.toLowerCase().split(" ")[0]+" has been "+i.toLowerCase().split(" ")[1];default:return i.toLowerCase()}});Handlebars.registerHelper("epochToLogDate",function(f){return new Date(f*1000)});Handlebars.registerHelper("getCountryName",function(f){return getCode(f)});Handlebars.registerHelper("replace_plus_symbol",function(f){return f.replace(/\+/," ")});Handlebars.registerHelper("replace_minus_symbol",function(f){return f.replace(/\-/,"")});Handlebars.registerHelper("get_amount_with_possitive",function(f){if(f<0){return f/100*(-1)}else{return f/100}});Handlebars.registerHelper("removeSlash",function(f){if(f=="A/B"){return f.replace(/\//,"")}return f});Handlebars.registerHelper("if_property",function(g,l,k,m,h,j,i,f,n,o){if(this.name!=g&&this.name!=l&&this.name!=k&&this.name!=m&&this.name!=h&&this.name!=j&&this.name!=i&&this.name!=f&&this.name!=n){return o.fn(this)}});Handlebars.registerHelper("property_is_exists",function(g,h,f){if(getPropertyValue(h,g)){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("property_json_is_not_empty",function(g,h,f){var i=getPropertyValue(h,g);if(!i){return f.inverse(this)}try{i=JSON.parse(i)}catch(j){}if(i&&Object.keys(i)&&Object.keys(i).length>0){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("online_schedule_URL",function(){return ONLINE_SCHEDULING_URL});Handlebars.registerHelper("get_current_domain",function(){return CURRENT_DOMAIN_USER.domain});Handlebars.registerHelper("get_current_domain_email",function(){return CURRENT_DOMAIN_USER.email});Handlebars.registerHelper("get_current_domain_pic",function(){return CURRENT_DOMAIN_USER.pic});Handlebars.registerHelper("get_current_domain_name",function(){var f=CURRENT_DOMAIN_USER.name;return f.charAt(0).toUpperCase()+f.slice(1)});Handlebars.registerHelper("getPropertyFromUser",function(f){if(f){return CURRENT_DOMAIN_USER[f]}else{return""}});Handlebars.registerHelper("getAffiliateLink",function(f){var g="<a href='https://my.agilecrm.com/register?utm_affiliate="+CURRENT_DOMAIN_USER.id+"' target='_blank'><img alt='AgileCRM' src='"+f+"'/></a>";return g});Handlebars.registerHelper("comma_in_between_property",function(g,f,i,h){if(getPropertyValue(i,g)&&getPropertyValue(i,f)){return","}});Handlebars.registerHelper("property_subtype_is_exists",function(h,f,i,g){if(getPropertyValueBySubtype(i,h,f)){return g.fn(this)}return g.inverse(this)});Handlebars.registerHelper("multiple_Property_Element",function(g,h,f){var i=agile_crm_get_contact_properties_list(g);if(i.length>0){return f.fn(i)}});Handlebars.registerHelper("multiple_Company_Property_Element",function(g,h,f){var i=company_util.agile_crm_get_company_properties_list(g);if(i.length>0){return f.fn(i)}});Handlebars.registerHelper("address_Element",function(k){var f=0;for(var j=0,h=k.length;j<h;j++){if(k[j].name=="address"){var m="";var g={};try{g=JSON.parse(k[j].value)}catch(o){g.address=k[j].value}var n=countJsonProperties(g);if(f!=0){m=m.concat('<div class="contact-addressview text-xs"><div><div class="pull-left hide text-xs" style="width:18px"><i class="icon icon-pointer"></i></div><div class="custom-color text-xs">')}else{m=m.concat('<div class="contact-addressview text-xs"><div><div class="pull-left hide text-xs" style="width:18px"><i class="icon icon-pointer"></i></div><div class="custom-color text-xs">')}if(g.address!==undefined){m=m.concat(g.address+", ")}if(g.city!==undefined){m=m.concat(g.city+", ")}if(g.state!==undefined){m=m.concat(g.state+", ")}if(g.zip!==undefined){m=m.concat(g.zip+", ")}if(g.country!==undefined){m=m.concat(g.country+".")}if(k[j].subtype){m=m.concat('<span class="label bg-light dk text-tiny">'+k[j].subtype+"</span>")
}m=m.concat('</span>&nbsp;<span id="map_view_action"></span></div></div>');return new Handlebars.SafeString(m)}else{if(k[j].name=="phone"||k[j].name=="email"){++f}}}});Handlebars.registerHelper("address_Template",function(j){for(var h=0,g=j.length;h<g;h++){if(j[h].name=="address"){var k="";var f={};try{f=JSON.parse(j[h].value)}catch(n){f.address=j[h].value}var m=countJsonProperties(f);$.each(f,function(i,l){if(--m==0){k=k.concat(l+".");return}k=k.concat(l+", ")});return new Handlebars.SafeString(k)}}});Handlebars.registerHelper("numberWithCommas",function(f){if(f==0){return f}if(f){return f.toFixed(2).toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",").replace(".00","")}});Handlebars.registerHelper("field_Element",function(f){var g="";var h=f.length;$.each(f,function(i,j){if(j.indexOf("properties_")!=-1){j=j.split("properties_")[1]}else{if(j.indexOf("custom_")!=-1){j=j.split("custom_")[1]}else{if(j.indexOf("CUSTOM_")!=-1){j=j.split("CUSTOM_")[1]}else{if(j=="created_time"){j="Created Date"}else{if(j=="updated_time"){j="Updated Date"}}}}}j=j.replace("_"," ");j=getTableLanguageConvertHeader(j);if(--h==0){g=g.concat(j);return}g=g.concat(j+", ")});return new Handlebars.SafeString(g)});Handlebars.registerHelper("stringToJSON",function(g,h,f){console.log(g);console.log(h);if(h){try{g[h]=JSON.parse(g[h])}finally{return f.fn(g[h])}}try{return f.fn(JSON.parse(g))}catch(i){return f.fn(g)}});Handlebars.registerHelper("if_propertyName",function(g,f){var h=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;if(value.search(h)!=-1){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("show_link_in_statement",function(g){if(g){g=g.replace(/</g,"&lt;").replace(/>/g,"&gt;")}var h=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;try{g=g.replace(h,"<a href='$1' target='_blank' class='cd_hyperlink'>$1</a>");return new Handlebars.SafeString(g)}catch(f){return g}});Handlebars.registerHelper("displayPlan",function(f){return ucfirst(f).replaceAll("_"," ")});Handlebars.registerHelper("displayPlainText",function(f){return f.split("_").join(" ")});Handlebars.registerHelper("displayTaskStatus",function(f){var g=f.split("_").join("").trim().toLowerCase();if(g=="yettostart"){return _agile_get_translated_val("misc-keys","yet-to-start")}else{return ucfirst(f.split("_").join(" ").trim())}});Handlebars.registerHelper("getCurrentContactProperty",function(g){if(App_Contacts.contactDetailView&&App_Contacts.contactDetailView.model){var f=App_Contacts.contactDetailView.model.get("properties");console.log(App_Contacts.contactDetailView.model.toJSON());return getPropertyValue(f,g)}});Handlebars.registerHelper("getCurrentCompanyProperty",function(g){if(App_Companies.companyDetailView&&App_Companies.companyDetailView.model){var f=App_Companies.companyDetailView.model.get("properties");console.log(App_Companies.companyDetailView.model.toJSON());return getPropertyValue(f,g)}});Handlebars.registerHelper("safe_string",function(f){if(f&&f.indexOf("Tweet about Agile")==-1&&f.indexOf("Like Agile on Facebook")==-1){f=f.replace(/</g,"&lt;").replace(/>/g,"&gt;")}f=f.replace(/\n/,"<br/>");return new Handlebars.SafeString(f)});Handlebars.registerHelper("string_to_date",function(g,f){return new Date(f).format(g)});Handlebars.registerHelper("isArray",function(g,f){if(isArray(g)){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("is_string",function(g,f){if(typeof g=="string"){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("bindData",function(f){return JSON.stringify(f)});Handlebars.registerHelper("getCurrentUserPrefs",function(f){if(CURRENT_USER_PREFS){}return f.fn(CURRENT_USER_PREFS)});Handlebars.registerHelper("getCurrentDomain",function(g){var f=window.location.host;var h=/(\.)/;if(f.search(h)>=0){return f.split(h)[0]}return" "});Handlebars.registerHelper("getBase64Domain",function(){return window.btoa(window.location.host.split(".")[0])});Handlebars.registerHelper("getBase64ActualDomain",function(){return window.btoa(CURRENT_DOMAIN_USER.domain)});Handlebars.registerHelper("extractEmail",function(g,f){console.log(g);return f.fn(g.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi)[0])});Handlebars.registerHelper("getCurrentContactPropertyBlock",function(h,g){if(App_Contacts.contactDetailView&&App_Contacts.contactDetailView.model){var f=App_Contacts.contactDetailView.model.get("properties");console.log(App_Contacts.contactDetailView.model.toJSON());return g.fn(getPropertyValue(f,h))}});Handlebars.registerHelper("isDuplicateContactProperty",function(j,i,h){if(App_Contacts.contactDetailView&&App_Contacts.contactDetailView.model&&Current_Route.indexOf("contact/")==0){var g=App_Contacts.contactDetailView.model.get("properties");var f=getPropertyValue(g,i);var k=getPropertyValue(j,i);if(!f||!k){f=getPropertyValue(g,"first_name")+" "+getPropertyValue(g,"last_name");k=getPropertyValue(j,"first_name")+" "+getPropertyValue(j,"last_name")}if(App_Contacts.contactDetailView.model.get("type")=="COMPANY"){f=getPropertyValue(g,"name");k=getPropertyValue(j,"name")}if(f==k){return h.fn(this)}return h.inverse(this)}if(App_Companies.companyDetailView&&App_Companies.companyDetailView.model&&Current_Route.indexOf("company/")==0){var g=App_Companies.companyDetailView.model.get("properties");var f=getPropertyValue(g,i);var k=getPropertyValue(j,i);if(!f||!k){f=getPropertyValue(g,"first_name")+" "+getPropertyValue(g,"last_name");k=getPropertyValue(j,"first_name")+" "+getPropertyValue(j,"last_name")}if(App_Companies.companyDetailView.model.get("type")=="COMPANY"){f=getPropertyValue(g,"name");k=getPropertyValue(j,"name")}if(f&&k&&f.toLowerCase()==k.toLowerCase()){return h.fn(this)}return h.inverse(this)}});Handlebars.registerHelper("containString",function(g,h,f){if(h.search(g)!=-1){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("is_emailPlan",function(g,f){if(g.search("email")!=-1){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("is_userPlan",function(g,f){if(g.search("email")!=-1){return f.inverse(this)}return f.fn(this)});Handlebars.registerHelper("numeric_operation",function(i,h,g){var f="/*-+";if(f.indexOf(g)==-1){return""}if(g=="+"){return i+h}if(g=="-"){return i-h}if(g=="*"){return i*h}if(g=="/"){return i/h}});Handlebars.registerHelper("get_total_amount",function(g,f){return(g/100)*f});Handlebars.registerHelper("check_length",function(h,g,f){if(parseInt(h.length)>parseInt(g)){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("get_unrefunded_amount",function(g,f){return(g-f)/100});Handlebars.registerHelper("check_json_length",function(h,g,f){var j=0;for(var i in h){j++}if(j==parseInt(g)){for(var i in h){return f.fn({property:i,value:h[i],last:true})}}return f.inverse(h)});Handlebars.registerHelper("iterate_json",function(h,g){var f="";var j=0;var i=0;for(var k in h){i++}for(var k in h){j++;if(j==i){f=f+g.fn({property:k,value:h[k],last:true})}else{f=f+g.fn({property:k,value:h[k],last:false})}}console.log(f);return f});Handlebars.registerHelper("get_social_icon",function(f){return get_social_icon(f)});Handlebars.registerHelper("each_with_index",function(m,h){var f="";for(var k=0,g=m.length;k<g;k++){var l=m[k];l.index=k+1;console.log(l);f+=h.fn(l)}return f});Handlebars.registerHelper("if_json",function(h,f){try{var g=$.parseJSON(h);if(typeof g==="object"){return f.fn(this)}return f.inverse(this)}catch(i){return f.inverse(this)}});Handlebars.registerHelper("add_tag",function(f){addTagAgile(f)});Handlebars.registerHelper("set_up_dashboard_padcontent",function(f){return new Handlebars.SafeString(getTemplate("empty-collection-model",CONTENT_JSON.dashboard[f]))});Handlebars.registerHelper("removeSquareBrackets",function(f){return f.replace(/[\[\]]+/g,"")});Handlebars.registerHelper("removeDoubleCoutes",function(h){var f=h.replace(/[\[\]]+/g,"");var g=f.replace(/"/g,"'");return g});Handlebars.registerHelper("toLinkTrigger",function(l,h){var g="";for(var k=0,f=l.length;k<f;k++){g=g+h.fn(l[k]);if(k<f-1){g=g+", "}}return g});Handlebars.registerHelper("millSecondsToMinutes",function(g){if(isNaN(g)){return}var h=g/1000;var f=Math.floor(h/60);if(f<1){return Math.ceil(h)+" mins"}var i=Math.ceil(h%60);return f+" mins, "+i+" secs"});Handlebars.registerHelper("if_overflow",function(i,f,g){if(!i){return}console.log($("#Linkedin").width());i=i.trim();var h=$("<div style='width:"+$("#Linkedin").width()+"px;word-break:normal;word-wrap:break-word;display:none;'>"+i+"</div>");$("#content").append(h);console.log(h.height()+" "+parseInt(f));if(h.height()>parseInt(f)){return g.fn(this)}return g.inverse(this)});Handlebars.registerHelper("setupRating",function(h){var g="";for(var f=0;f<5;f++){if(f<parseInt(h)){g=g.concat('<li style="display: inline;"><img src="'+updateImageS3Path("img/star-on.png")+'" alt="'+f+'"></li>');continue}g=g.concat('<li style="display: inline;"><img src="'+updateImageS3Path("img/star-off.png")+'" alt="'+f+'"></li>')}return new Handlebars.SafeString(g)});Handlebars.registerHelper("setupCSVUploadOptions",function(j,m,f){var l;if(j=="contacts"){l=$(getTemplate("csv_upload_options",f))}else{if(j=="company"){l=$(getTemplate("csv_companies_upload_options",f))}else{if(j=="deals"){l=$(getTemplate("csv_deals_options",f))}}}m=m.replace("_"," ");var n=false;var o=0;var k=m.length;var m=m.toLowerCase();var g;var p;l.find("option").each(function(i,q){if($(q).text().toLowerCase().indexOf(m)!=-1){var r=k/$(q).text().length;if(o>=r){return}p=$(q);g=$(q).text();o=r}});console.log(g+", "+m+" : "+o);for(var h=0;h<m.length-3;h++){l.find("option").each(function(i,q){if($(q).text().toLowerCase().indexOf(m.substr(0,m.length-h).toLowerCase())!=-1){console.log(m.substr(0,m.length-h)+" , "+$(q).text());var r=m.substr(0,m.length-h).length/$(q).text().length;console.log(r);if(o>=r){return}p=$(q);g=$(q).text();o=r}})}$(p).attr("selected",true);return new Handlebars.SafeString($("<div>").html(l).html())});Handlebars.registerHelper("convertSecondsToHour",function(i){var g=parseInt(i/3600)%24;
var h=parseInt(i/60)%60;var j=i%60;if(g==0&&h==0){return(j+"s")}if(g==0){return(h+"m ")+(j+"s")}var f=(g+"h ")+(h+"m ")+(j+"s");return f});Handlebars.registerHelper("checkOriginalRef",function(g){if(!getCurrentContactProperty(g)){return"unknown"}var f=getCurrentContactProperty(g);f=f.split("/");f=(f[0]+"//"+f[2]);return new Handlebars.SafeString('<a style="text-decoration: none" target="_blank" href="'+getCurrentContactProperty(g)+'">'+f+"</a>")});Handlebars.registerHelper("queryWords",function(n){if(getCurrentContactProperty(n)){var l=getCurrentContactProperty(n);var f="www.google.";var k=l.split("/");k=k[2].slice(0,11);if(k===f){var m=document.createElement("a");m.href=l;var h=m.search;if(h.length>1){h=h.split("&");var j=h.length;for(var g=0;g<j;g++){if(h[g].indexOf("q=")!=-1){h=h[g].split("=");return new Handlebars.SafeString("( Keyword : "+h[1].split("+").join(" ")+" )")}}}}else{return}}});Handlebars.registerHelper("contact_name",function(g,h){if(h==="PERSON"){for(var f=0;f<g.length;f++){if(g[f].name==="last_name"){return(getPropertyValue(g,"first_name")+" "+g[f].value)}else{if(g[f].name==="first_name"){return g[f].value}}}return"Contact"}for(var f=0;f<g.length;f++){if(g[f].name==="name"){return g[f].value}}return"Company"});Handlebars.registerHelper("contact_name_necessary",function(f){return getContactName(f)});Handlebars.registerHelper("is_blank",function(g,f){g=g.trim();if(g==""){return f.fn(g)}else{return f.inverse(g)}});Handlebars.registerHelper("each_with_index1",function(m,h){console.log(m);var f="";for(var k=0,g=m.length;k<g;k++){var l={};l.value=m[k];console.log(l);l.index=k+1;console.log(l);f+=h.fn(l)}return f});Handlebars.registerHelper("if_log_type_equals",function(g,h,i,f){if(g[h]==i){return f.fn(g)}return f.inverse(g)});Handlebars.registerHelper("if_email_sent",function(f,l,o){var g="_aGiLeCrM";if(f[l]==="EMAIL_SENT"){var j=f.message.split(g,4);var m={};if(j===undefined){return o.inverse(f)}for(var h=0;h<j.length;h++){var n=j[h].split(":");var l=n[0];l=l.trim();var k=n.slice(1).join(":");k=k.trim();m[l]=k}m.time=f.time;return o.fn(m)}return o.inverse(f)});Handlebars.registerHelper("remove_spaces",function(f){if(f){f=f.replace(/ +/g,"")}return f});Handlebars.registerHelper("replace_spaces",function(f){if(f){f=f.replace(/ +/g,"_")}return f});Handlebars.registerHelper("if_same_campaign",function(j,m,h){var g=j[m];if(m===undefined||g===undefined){return}var l=getIdFromHash();for(var k=0,f=g.length;k<f;k++){if(g[k].campaign_id===l){return h.fn(g[k])}}});Handlebars.registerHelper("if_other_active_campaigns",function(g,j,o){if(g===undefined||g[j]===undefined){return}var f={};var k=[];var m=[];var p=g[j];var n=getIdFromHash();for(var h=0,l=p.length;h<l;h++){if(n===p[h].campaign_id){continue}if(p[h].status.indexOf("ACTIVE")!==-1){k.push(p[h])}if(p[h].status.indexOf("DONE")!==-1){m.push(p[h])}}f.active=k;f.done=m;return o.fn(f)});Handlebars.registerHelper("contact_campaigns",function(k,n,t){if(k===undefined||k[n]===undefined){return}var f={};var j=[];var g=[];var q=[];var u={};var s=k[n];var h=k.campaignStatus;var p={};for(var m=0,o=h.length;m<o;m++){var l=h[m];if(l){p[l.campaign_id]=l.campaign_name}}for(var m=0,o=s.length;m<o;m++){if(s[m].status){if(s[m].status.indexOf("ACTIVE")!==-1){j.push(s[m])}if(s[m].status.indexOf("DONE")!==-1){g.push(s[m])}}var r=false;if(s[m].unsubscribeType){if(typeof email_workflows_list!="undefined"){s[m].campaign_name=email_workflows_list[s[m].campaign_id]}if(s[m].unsubscribeType=="ALL"){if(!r){u.isAll=true;r=true}}q.push(s[m])}}if(q&&q.length>0){u.unsubscribed_campaigns=q}f.active=j;f.done=g;f.unsubscribed=u;return t.fn(f)});Handlebars.registerHelper("normalize_os",function(f){if(f===undefined||f.indexOf("_")===-1){return f}return f.split("_")[0]});Handlebars.registerHelper("hasKey",function(h,g,f){if(h.indexOf(g)==-1){return f.inverse(this)}return f.fn(this)});Handlebars.registerHelper("get_normal_name",function(f){if(!f){return}return getTranslatedPortletName(f)});Handlebars.registerHelper("referedUsersPlan",function(i){var h=[];h=i.plan_type.split("_");var f=h[0].toLowerCase();if(h.length==1){var g=i.quantity+" Users  "+f.charAt(0).toUpperCase()+f.slice(1)}else{var j=h[1].toLowerCase();var g=i.quantity+" Users  "+f.charAt(0).toUpperCase()+f.slice(1)+" ("+j.charAt(0).toUpperCase()+j.slice(1)+")"}return g});Handlebars.registerHelper("user_location",function(){var f=this.city=="?"?"":(this.city+", ");var h=this.region=="?"?"":(this.region+", ");var g=this.country;if(this.city=="?"&&this.region=="?"){g=this.country=="?"?this.city_lat_long:(this.city_lat_long+" ( "+this.country+" )")}return(f+h+g).trim()});Handlebars.registerHelper("trim_space",function(f){if(f===undefined){return f}return f.trim()});Handlebars.registerHelper("get_subaccount_reputation",function(k){var i="bg-light dk text-tiny";var g="Unknown";var f="";if(k>1&&k<40){i="label-danger text-tiny";g="Poor";f="progress-bar-danger"}else{if(k>=40&&k<75){i="label-warning text-tiny";g="Ok";f="progress-bar-warning"}else{if(k>=75&&k<90){i="label-primary text-tiny";g="Good";f="progress-bar-info"}else{if(k>=90){i="label-success text-tiny";g="Excellent";f="progress-bar-success"}}}}var j={type:i,reputation:g,value:k,badge:f};var h=getTemplate("reputation-progress",j);return h});Handlebars.registerHelper("get_id_from_hash",function(){return getIdFromHash()});Handlebars.registerHelper("isAdmin",function(f){if(CURRENT_DOMAIN_USER.is_admin){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("isNewVersionDomainUser",function(f){if(CURRENT_DOMAIN_USER.version){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("check_plan",function(g,f){console.log(g);if(!_billing_restriction){return f.fn(this)}if(_billing_restriction.currentLimits.planName==g){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("isSafariBrowser",function(f){if(navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("xeroType",function(f){return(f=="ACCPAY")?"Payable":"Receivable"});Handlebars.registerHelper("xeroTypeToolTip",function(f){return(f=="ACCPAY")?"Payable":"Receivable"});Handlebars.registerHelper("capFirstLetter",function(g){if(g){if(g==="DEFAULT"){return""}else{var f=g.toLowerCase();return f.charAt(0).toUpperCase()+f.slice(1)}}});Handlebars.registerHelper("qbStatus",function(f){console.log(this);console.log(this.TotalAmt);if(f==0){return"Paid"}else{return"Due"}});Handlebars.registerHelper("currencyFormat",function(f){return Number(f).toLocaleString("en")});Handlebars.registerHelper("formatAmount",function(f){f=parseFloat(f);return f.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")});Handlebars.registerHelper("QbDateFormat",function(g){var f=[];f=g.split("-");return f[0]+"-"+f[2]+"-"+f[1]});Handlebars.registerHelper("hasScope",function(f,g){if(CURRENT_DOMAIN_USER.scopes&&$.inArray(f,CURRENT_DOMAIN_USER.scopes)!=-1){return g.fn(this)}return g.inverse(this)});Handlebars.registerHelper("hasMenuScope",function(f,g){if(CURRENT_DOMAIN_USER.menu_scopes&&$.inArray(f,CURRENT_DOMAIN_USER.menu_scopes)!=-1){return g.fn(this)}console.log("menuscope "+g.fn(this));return g.inverse(this)});Handlebars.registerHelper("hasRestrictedMenuScope",function(f,g){if(CURRENT_DOMAIN_USER.restricted_scopes&&$.inArray(f,CURRENT_DOMAIN_USER.restricted_scopes)!=-1){return g.fn(this)}return g.inverse(this)});Handlebars.registerHelper("isRestrictedMenuScope",function(f,g){if(CURRENT_DOMAIN_USER.restricted_menu_scopes&&$.inArray(f,CURRENT_DOMAIN_USER.restricted_menu_scopes)!=-1){return g.fn(this)}return g.inverse(this)});Handlebars.registerHelper("canSyncContacts",function(f){if(canImportContacts()){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("hasMenuScope",function(g,f){if((CURRENT_DOMAIN_USER.menu_scopes).indexOf(g)!=-1){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("fetchXeroUser",function(f){return JSON.parse(f).xeroemail});Handlebars.registerHelper("getfbreturndomain",function(g){var f=window.location.href.split("/");return f[2]});Handlebars.registerHelper("tagManagementCollectionSetup",function(h){console.log(h);var l={};var m=[];for(var k=0;k<h.length;k++){var g=h[k].tag;var j=g.charAt(0).toUpperCase();if(jQuery.inArray(j,m)==-1){m.push(j)}}console.log(m);var f="";for(var k=0;k<m.length;k++){f+="<div class='row b-b p-b-md'><div class='col-md-1 p-t' style='font-size:16px;padding-top:20px;'>"+m[k]+"</div><div class='col-md-10'><div tag-alphabet=\""+encodeURI(m[k])+'"><ul class="tags-management tag-cloud" style="list-style:none;"></ul></div></div></div>'}console.log(f);return new Handlebars.SafeString(f)});Handlebars.registerHelper("containsScope",function(g,h,f){if(h.length==0||!g){return f.inverse(this)}if(jQuery.inArray(g,h)==-1){return f.inverse(this)}return f.fn(this)});Handlebars.registerHelper("isOwnerOfContact",function(g,f){if(CURRENT_DOMAIN_USER.id==g){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("canEditContact",function(g,f){if(canEditContact(g)){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("canEditCurrentContact",function(g,f){if(canEditCurrentContact()){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("gateway_exists",function(j,k,g){for(var h=0;h<k.length;h++){var f=JSON.parse(k[h].prefs);if(k[h].name=="EmailGateway"){if(f.email_api==j){return g.fn(k[h])}}if(k[h].name=="SMS-Gateway"){if(f.sms_api==j){return g.fn(k[h])}}}return g.inverse(this)});Handlebars.registerHelper("each_index_slice",function(l,h,g){var f="";for(var j=h;j<l.length;j++){var k=l[j];console.log(k);f+=g.fn(k)}return f});Handlebars.registerHelper("gateway_exists",function(j,k,g){for(var h=0;h<k.length;h++){var f=JSON.parse(k[h].prefs);if(k[h].name=="EmailGateway"){if(f.email_api==j){return g.fn(k[h])}}if(k[h].name=="SMS-Gateway"){if(f.sms_api==j){return g.fn(k[h])}}}return g.inverse(this)});Handlebars.registerHelper("isOwnerOfContact",function(g,f){if(CURRENT_DOMAIN_USER.id==g){return f.fn(this)
}return f.inverse(this)});Handlebars.registerHelper("canEditContact",function(g,f){if((hasScope("UPDATE_CONTACTS")||hasScope("EDIT_CONTACT"))||CURRENT_DOMAIN_USER.id==g){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("getAccountPlanName",function(f){if(!f){return"Free"}var g=f.split("_");return ucfirst(g[0])});Handlebars.registerHelper("getFullAccountPlanName",function(f){if(!f){return"Free"}var g=f.split("_");return ucfirst(g[0])+" ("+ucfirst(g[1])+")"});Handlebars.registerHelper("getAccountPlanInteval",function(f){if(!f){return"Monthly"}var g=f.split("_");return ucfirst(g[1])});Handlebars.registerHelper("getSubscriptionBasedOnPlan",function(i,h,f){var g=getSubscriptionWithAmount(i,h);if(g!=null){return f.fn(g)}return f.inverse(this)});Handlebars.registerHelper("iso_date_to_normalizeDate",function(g){if(g.length<=0){return}var f=g.split("T");console.log("normalize date "+f[0]);return f[0]});Handlebars.registerHelper("getMonthFromIndex",function(h){var g=["January","february","March","April","May","June","July","August","September","October","November","December"];var f="";if(h>12){f=g[11]}f=g[h-1];return _agile_get_translated_val("months",f)});Handlebars.registerHelper("xeroOrganisationShortCode",function(f){if(typeof SHORT_CODE=="undefined"||SHORT_CODE==""){return false}else{return SHORT_CODE}});Handlebars.registerHelper("if_id",function(g,f){if(this.type==g){return f.fn(this)}});Handlebars.registerHelper("getTime",function(h){if(!h){return}if((h/100000000000)>1){var j=new Date(parseInt(h));var f=j.getHours();if(f>12){f=f-12}var i=j.getMinutes();if(i==0){i="00"}var g=f>=12?"PM":"AM";return f+":"+i+" "+g}var j=new Date(parseInt(h)*1000);var f=j.getHours();if(f>12){f=f-12}var i=j.getMinutes();if(i==0){i="00"}var g=f>=12?"PM":"AM";return f+":"+i+" "+g});Handlebars.registerHelper("getCustomDateWithTime",function(l,f){var k=a(l);var j=a(f);var h=b(l);var g=b(f);var i=c(f);if(k!=j){return h+" - "+g}else{return h+" - "+i}});function c(h){if(!h){return}if((h/100000000000)>1){var j=new Date(parseInt(h));var f=j.getHours();var i=j.getMinutes();if(i==0){i="00"}var g=f>=12?"PM":"AM";if(f>12){f=f-12}return f+":"+i+" "+g}var j=new Date(parseInt(h)*1000);var f=j.getHours();var i=j.getMinutes();if(i==0){i="00"}var g=f>=12?"PM":"AM";if(f>12){f=f-12}return f+":"+i+" "+g}function a(f){if((f/100000000000)>1){var g=new Date(parseInt(f));return g.getDate()}else{var g=new Date(parseInt(f)*1000);return g.getDate()}}Handlebars.registerHelper("buildOptions",function(h){var f=h.split(";");var g="";$.each(f,function(i,j){if(j!=""){g=g.concat('<option value="'+j+'">'+j+"</option>")}});return g});Handlebars.registerHelper("address_Template",function(j){for(var h=0,g=j.length;h<g;h++){if(j[h].name=="address"){var k="";var f={};try{f=JSON.parse(j[h].value)}catch(n){f.address=j[h].value}var m=countJsonProperties(f);$.each(f,function(i,l){if(--m==0){k=k.concat(l+".");return}k=k.concat(l+", ")});return new Handlebars.SafeString(k)}}});Handlebars.registerHelper("related_to_contacts",function(i,f){var g="";var h=i.length;$.each(i,function(k,l){var j=getTemplate("related-to-contacts",l);if(--h==0){g=g.concat(j);return}g=g.concat(j+",")});return new Handlebars.SafeString(g)});Handlebars.registerHelper("related_to_one",function(i,f){var g="";var h=i.length;$.each(i,function(k,l){if(k<=3){var j=getTemplate("related-to-contacts",l);j=j.trim();if(--h==0||k==3){g=g.concat(j);return}g=g.concat(j+", ")}});return new Handlebars.SafeString(g)});Handlebars.registerHelper("numberWithCommas",function(f){if(f){return f.toFixed(2).toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",").replace(".00","")}});Handlebars.registerHelper("stringToJSON",function(g,h,f){console.log(g);console.log(h);if(h){try{g[h]=JSON.parse(g[h])}finally{return f.fn(g[h])}}try{return f.fn(JSON.parse(g))}catch(i){return f.fn(g)}});Handlebars.registerHelper("if_propertyName",function(h,f){for(var g=0;g<this.properties.length;g++){if(this.properties[g].name==h){return f.fn(this.properties[g])}}return f.inverse(this)});Handlebars.registerHelper("getCompanyImage",function(k,j){var f=parseInt(k);var h=4+((f-32)/2);var m="src='"+updateImageS3Path("img/com-default-img.png")+"' style='width:"+f+"px; height="+f+"px;"+j+"'";var g="";for(var l=0;l<this.properties.length;l++){if(this.properties[l].name=="image"){m="src='"+this.properties[l].value+"' style='width:"+f+"px; height="+f+"px;"+j+";'";g="this.src='"+updateImageS3Path("img/com-default-img.png")+"'; this.onerror=null;";break}if(this.properties[l].name=="url"){m="src='https://www.google.com/s2/favicons?domain="+this.properties[l].value+"' style='width:"+f+"px; height="+f+"px; padding:"+h+"px; "+j+" ;'";g="this.src='"+updateImageS3Path("img/com-default-img.png")+"'; $(this).css('width','"+k+"px'); $(this).css('height','"+k+"px');$(this).css('padding','4px'); this.onerror=null;"}}return new Handlebars.SafeString(m+' onError="'+g+'"')});Handlebars.registerHelper("getHyperlinkFromURL",function(f){if(f.match(/((http|http[s]|ftp|file):\/\/)/)!=null){return f}return"http://"+f});Handlebars.registerHelper("getSkypeURL",function(f){if(f.match("skype:")!=null){return f}return"skype:"+f});Handlebars.registerHelper("getFacebookURL",function(f){return f.replace("@","")});Handlebars.registerHelper("count",function(){return getCount(this)});Handlebars.registerHelper("contacts_count",function(){var f;if(this[0]&&this[0].count&&(this[0].count!=-1)){if(this[0].count>9999&&(_agile_get_prefs("contact_filter")||_agile_get_prefs("dynamic_contact_filter"))){f="<small> ("+10000+"+ "+_agile_get_translated_val("other","total")+' ) </small><span style="vertical-align: text-top; margin-left: -5px"><img border="0" src="'+updateImageS3Path("/img/help.png")+'"style="height: 10px; vertical-align: middle" rel="popover"data-placement="bottom" data-title="Lead Score"data-content="'+_agile_get_translated_val("results","over-count")+'"id="element" data-trigger="hover"></span>'}else{f="<small> ("+this[0].count+" "+_agile_get_translated_val("other","total")+" ) </small>"}}else{f="<small> ("+this.length+" "+_agile_get_translated_val("other","total")+" ) </small>"}return new Handlebars.SafeString(f)});Handlebars.registerHelper("duplicate_contacts_count",function(){var g;if(this[0]&&this[0].count&&(this[0].count!=-1)){var f=this[0].count-1;g="<small> ("+f+" "+_agile_get_translated_val("other","total")+" ) </small>"}else{g="<small> ("+this.length+" "+_agile_get_translated_val("other","total")+" ) </small>"}return new Handlebars.SafeString(g)});Handlebars.registerHelper("subscribers_count",function(){if(this[0]&&this[0].count&&(this[0].count!=-1)){return this[0].count}return this.length});Handlebars.registerHelper("toLowerCase",function(f){if(!f){return}return f.toLowerCase()});Handlebars.registerHelper("toUpperCase",function(f){if(!f){return}return f.toUpperCase()});Handlebars.registerHelper("if_contact_type",function(g,f){if(this.type==g){return f.fn(this)}});Handlebars.registerHelper("collection_contact_type",function(g,f){if(this&&this[0]&&this[0].type==g){return f.fn(this)}});Handlebars.registerHelper("wrap_entity",function(g,f){if(g){return f.fn(g)}});Handlebars.registerHelper("tl_log_string",function(f){return f.replace("Sending email From:","Email sent From::")});Handlebars.registerHelper("lead_score",function(f){return this.lead_score});Handlebars.registerHelper("task_status",function(f){if(f){return true}return"false"});Handlebars.registerHelper("if_equals",function(g,h,f){if((typeof h==="undefined")||(typeof g==="undefined")){return f.inverse(this)}if(g.toString().trim()==h.toString().trim()){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("if_hasWriteAccess",function(h){var g=false;var j=agile_crm_get_widget("Stripe");if(j!=undefined){if(j.prefs!=undefined){var f=JSON.parse(j.prefs);var i=f.scope;if(i=="read_write"){g=true}}}if(g){return h.fn(this)}else{return h.inverse(this)}});Handlebars.registerHelper("if_not_equals",function(g,h,f){if((typeof h==="undefined")||(typeof g==="undefined")){return f.inverse(this)}if(g.toString().trim()!=h.toString().trim()){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("if_greater",function(g,h,f){if(parseInt(h)>g){return f.inverse(this)}else{return f.fn(this)}});Handlebars.registerHelper("if_less_than",function(g,h,f){if(h<g){return f.inverse(this)}else{return f.fn(this)}});Handlebars.registerHelper("if_keyboard_shortcuts_enabled",function(f){if(CURRENT_USER_PREFS.keyboard_shotcuts){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("campaigns_heading",function(g,f){var h=0;if(g&&g[0]&&g[0].count){h=g[0].count}if(h<=20){return"Workflows"}return"("+h+_agile_get_translated_val("other","total")+" )"});Handlebars.registerHelper("show_custom_fields",function(h,f){var g=show_custom_fields_helper(h,f);return new Handlebars.SafeString(fill_custom_field_values($(g),f))});Handlebars.registerHelper("is_property_custom_field",function(g,f){if(g.indexOf("CUSTOM_")!=-1){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("is_property_custom_field_date_type",function(i,g,h,f){if(h){h=h.split("CUSTOM_")[1]}var j=getProperty(g,h);if(isDateCustomField(i,j)){return f.fn(j)}else{return f.inverse(j)}});Handlebars.registerHelper("is_link",function(g,f){var h=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;if(g&&g.search(h)!=-1){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("displayPlan",function(f){return ucfirst(f).replaceAll("_"," ")});Handlebars.registerHelper("displayPlainText",function(f){return ucfirst(f).replace("_"," ")});Handlebars.registerHelper("getCurrentContactProperty",function(g){if(App_Contacts.contactDetailView&&App_Contacts.contactDetailView.model){var f=App_Contacts.contactDetailView.model.get("properties");console.log(App_Contacts.contactDetailView.model.toJSON());return getPropertyValue(f,g)}});Handlebars.registerHelper("string_to_date",function(g,f){return new Date(f).format(g)
});Handlebars.registerHelper("isArray",function(g,f){if(isArray(g)){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("is_string",function(g,f){if(typeof g=="string"){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("bindData",function(f){return JSON.stringify(f)});Handlebars.registerHelper("getCurrentUserPrefs",function(f){if(CURRENT_USER_PREFS){}return f.fn(CURRENT_USER_PREFS)});Handlebars.registerHelper("getCurrentDomain",function(g){var f=window.location.host;var h=/(\.)/;if(f.search(h)>=0){return f.split(h)[0]}return" "});Handlebars.registerHelper("date-range",function(h,g,i){var j=Date.parse(h);var f=Date.today().add({days:parseInt(g)});return f.toString("MMMM d, yyyy")+" - "+j.toString("MMMM d, yyyy")});Handlebars.registerHelper("month-range",function(g){var h=Date.today().moveToFirstDayOfMonth();var f=Date.today().moveToLastDayOfMonth();return h.toString("MMMM d, yyyy")+" - "+f.toString("MMMM d, yyyy")});Handlebars.registerHelper("extractEmail",function(g,f){console.log(g);return f.fn(g.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi)[0])});Handlebars.registerHelper("if_keyboard_shortcuts_enabled",function(f){if(CURRENT_USER_PREFS.keyboard_shotcuts){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("getCurrentContactPropertyBlock",function(h,g){if(App_Contacts.contactDetailView&&App_Contacts.contactDetailView.model){var f=App_Contacts.contactDetailView.model.get("properties");console.log(App_Contacts.contactDetailView.model.toJSON());return g.fn(getPropertyValue(f,h))}});Handlebars.registerHelper("containString",function(g,h,f){if(h.search(g)!=-1){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("is_emailPlan",function(g,f){if(g.search("email")!=-1){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("is_userPlan",function(g,f){if(g.search("email")!=-1){return f.inverse(this)}return f.fn(this)});Handlebars.registerHelper("numeric_operation",function(i,h,g){var f="/*-+";if(f.indexOf(g)==-1){return""}if(g=="+"){return i+h}if(g=="-"){return i-h}if(g=="*"){return i*h}if(g=="/"){return i/h}});Handlebars.registerHelper("get_total_amount",function(g,f){return(g/100)*f});Handlebars.registerHelper("check_length",function(h,g,f){if(parseInt(h.length)>parseInt(g)){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("check_json_length",function(h,g,f){var j=0;for(var i in h){j++}if(j==parseInt(g)){for(var i in h){return f.fn({property:i,value:h[i],last:true})}}return f.inverse(h)});Handlebars.registerHelper("iterate_json",function(h,g){var f="";var j=0;var i=0;for(var k in h){i++}for(var k in h){j++;if(j==i){f=f+g.fn({property:k,value:h[k],last:true})}else{f=f+g.fn({property:k,value:h[k],last:false})}}console.log(f);return f});Handlebars.registerHelper("get_social_icon",function(f){return get_social_icon(f)});Handlebars.registerHelper("each_with_index",function(m,h){var f="";for(var k=0,g=m.length;k<g;k++){var l=m[k];l.index=k+1;console.log(l);f+=h.fn(l)}return f});Handlebars.registerHelper("if_json",function(h,f){try{var g=$.parseJSON(h);if(typeof g==="object"){return f.fn(this)}return f.inverse(this)}catch(i){return f.inverse(this)}});Handlebars.registerHelper("add_tag",function(f){addTagAgile(f)});Handlebars.registerHelper("set_up_dashboard_padcontent",function(f){return new Handlebars.SafeString(getTemplate("empty-collection-model",CONTENT_JSON.dashboard[f]))});Handlebars.registerHelper("removeSquareBrackets",function(f){return f.replace(/[\[\]]+/g,"")});Handlebars.registerHelper("removeDoubleCoutes",function(h){var f=h.replace(/[\[\]]+/g,"");var g=f.replace(/"/g,"'");return g});Handlebars.registerHelper("toLinkTrigger",function(l,h){var g="";for(var k=0,f=l.length;k<f;k++){g=g+h.fn(l[k]);if(k<f-1){g=g+", "}}return g});Handlebars.registerHelper("if_overflow",function(i,f,g){if(!i){return}console.log($("#Linkedin").width());i=i.trim();var h=$("<div style='width:"+$("#Linkedin").width()+"px;word-break:normal;word-wrap:break-word;display:none;'>"+i+"</div>");$("#content").append(h);console.log(h.height()+" "+parseInt(f));if(h.height()>parseInt(f)){return g.fn(this)}return g.inverse(this)});Handlebars.registerHelper("setupRating",function(h){var g="";for(var f=0;f<5;f++){if(f<parseInt(h)){g=g.concat('<li style="display: inline;"><img src="'+updateImageS3Path("img/star-value-on.png")+'" alt="'+f+'"></li>');continue}g=g.concat('<li style="display: inline;"><img src="'+updateImageS3Path("img/star-value-off.png")+'" alt="'+f+'"></li>')}return new Handlebars.SafeString(g)});Handlebars.registerHelper("setupCSVUploadOptions",function(j,m,f){var l;if(j=="contacts"){getTemplate("csv_upload_options",f,undefined,function(i){if(!i){return}l=$(i)},null)}else{if(j=="company"){getTemplate("csv_companies_upload_options",f,undefined,function(i){if(!i){return}l=$(i)},null)}else{if(j=="deals"){getTemplate("csv_deals_options",f,undefined,function(i){if(!i){return}l=$(i)},null)}}}m=m.replace("_"," ");var n=false;var o=0;var k=m.length;var m=m.toLowerCase();var g;var p;l.find("option").each(function(i,q){if($(q).text().toLowerCase().indexOf(m)!=-1){var r=k/$(q).text().length;if(o>=r){return}p=$(q);g=$(q).text();o=r}});console.log(g+", "+m+" : "+o);for(var h=0;h<m.length-3;h++){l.find("option").each(function(i,q){if($(q).text().toLowerCase().indexOf(m.substr(0,m.length-h).toLowerCase())!=-1){console.log(m.substr(0,m.length-h)+" , "+$(q).text());var r=m.substr(0,m.length-h).length/$(q).text().length;console.log(r);if(o>=r){return}p=$(q);g=$(q).text();o=r}})}$(p).attr("selected",true);return new Handlebars.SafeString($("<div>").html(l).html())});Handlebars.registerHelper("convertSecondsToHour",function(i){var g=parseInt(i/3600)%24;var h=parseInt(i/60)%60;var j=i%60;if(g==0&&h==0){return(j+"s")}if(g==0){return(h+"m ")+(j+"s")}var f=(g+"h ")+(h+"m ")+(j+"s");return f});Handlebars.registerHelper("checkOriginalRef",function(g){if(!getCurrentContactProperty(g)){return"unknown"}var f=getCurrentContactProperty(g);f=f.split("/");f=(f[0]+"//"+f[2]);return new Handlebars.SafeString('<a style="text-decoration: none" target="_blank" href="'+getCurrentContactProperty(g)+'">'+f+"</a>")});Handlebars.registerHelper("queryWords",function(n){if(getCurrentContactProperty(n)){var l=getCurrentContactProperty(n);var f="www.google.";var k=l.split("/");k=k[2].slice(0,11);if(k===f){var m=document.createElement("a");m.href=l;var h=m.search;if(h.length>1){h=h.split("&");var j=h.length;for(var g=0;g<j;g++){if(h[g].indexOf("q=")!=-1){h=h[g].split("=");return new Handlebars.SafeString("( Keyword : "+h[1].split("+").join(" ")+" )")}}}}else{return}}});Handlebars.registerHelper("contact_name",function(g,h){if(h==="PERSON"){for(var f=0;f<g.length;f++){if(g[f].name==="last_name"){return(getPropertyValue(g,"first_name")+" "+g[f].value)}else{if(g[f].name==="first_name"){return g[f].value}}}return"Contact"}for(var f=0;f<g.length;f++){if(g[f].name==="name"){return g[f].value}}return"Company"});Handlebars.registerHelper("contact_name_necessary",function(f){return getContactName(f)});Handlebars.registerHelper("is_blank",function(g,f){g=g.trim();if(g==""){return f.fn(g)}else{return f.inverse(g)}});Handlebars.registerHelper("each_with_index1",function(m,h){console.log(m);var f="";for(var k=0,g=m.length;k<g;k++){var l={};l.value=m[k];console.log(l);l.index=k+1;console.log(l);f+=h.fn(l)}return f});Handlebars.registerHelper("if_log_type_equals",function(g,h,i,f){if(g[h]==i){return f.fn(g)}return f.inverse(g)});Handlebars.registerHelper("if_email_sent",function(f,l,o){var g="_aGiLeCrM";if(f[l]==="EMAIL_SENT"){var j=f.message.split(g,4);var m={};if(j===undefined){return o.inverse(f)}for(var h=0;h<j.length;h++){var n=j[h].split(":");var l=n[0];l=l.trim();var k=n.slice(1).join(":");k=k.trim();m[l]=k}m.time=f.time;return o.fn(m)}return o.inverse(f)});Handlebars.registerHelper("remove_spaces",function(f){if(f){f=f.replace(/ +/g,"")}return f});Handlebars.registerHelper("replace_spaces",function(f){if(f){f=f.replace(/ +/g,"_")}return f});Handlebars.registerHelper("if_same_campaign",function(j,m,h){var g=j[m];if(m===undefined||g===undefined){return}var l=getIdFromHash();for(var k=0,f=g.length;k<f;k++){if(g[k].campaign_id===l){return h.fn(g[k])}}});Handlebars.registerHelper("if_other_active_campaigns",function(g,j,o){if(g===undefined||g[j]===undefined){return}var f={};var k=[];var m=[];var p=g[j];var n=getIdFromHash();for(var h=0,l=p.length;h<l;h++){if(n===p[h].campaign_id){continue}if(p[h].status.indexOf("ACTIVE")!==-1){k.push(p[h])}if(p[h].status.indexOf("DONE")!==-1){m.push(p[h])}}f.active=k;f.done=m;return o.fn(f)});Handlebars.registerHelper("contact_model",function(f){if(App_Contacts.contactDetailView&&App_Contacts.contactDetailView.model){return f.fn(App_Contacts.contactDetailView.model.toJSON())}});Handlebars.registerHelper("if_more_urls",function(l,j,g){var f=3;var m=[];var k={};if(j<f){return g.inverse(l)}for(var h=0;h<l.length;h++){if(h===f){break}m.push(l[h])}k.urls=m;k.more=j-f;return g.fn(k)});Handlebars.registerHelper("safe_tweet",function(f){f=f.trim();return new Handlebars.SafeString(f)});Handlebars.registerHelper("get_stream_icon",function(g){if(!g){return}var f={Home:"icon-home",Retweets:"icon-retweet",DM_Inbox:"icon-download-alt",DM_Outbox:"icon-upload-alt",Favorites:"icon-star",Sent:"icon-share-alt",Search:"icon-search",Scheduled:"icon-time",All_Updates:"icon-home",My_Updates:"icon-share-alt"};g=g.trim();if(f[g]){return f[g]}return"icon-globe"});Handlebars.registerHelper("get_normal_activity_type",function(g){if(!g){return}g=g.trim();var f=_agile_get_translated_val("activity_type");if(f[g]){return f[g]}return g});Handlebars.registerHelper("user_location",function(){var f=this.city=="?"?"":(this.city+", ");var h=this.region=="?"?"":(this.region+", ");var g=this.country;if(this.city=="?"&&this.region=="?"){g=this.country=="?"?this.city_lat_long:(this.city_lat_long+" ( "+this.country+" )")}return(f+h+g).trim()});Handlebars.registerHelper("trim_space",function(f){if(f===undefined){return f
}return f.trim()});Handlebars.registerHelper("get_subaccount_reputation_duplicate",function(h){var g="bg-light dk text-tiny";var f="Unknown";if(h>1&&h<40){g="label-danger text-tiny";f="Poor"}else{if(h>=40&&h<75){g="bg-light text-tiny";f="Ok"}else{if(h>=75&&h<90){g="label-success";f="Good"}else{if(h>=90){g="label-success";f="Excellent"}}}}f=_agile_get_translated_val("reputation",f);return"<span style='top: -3px' class='text-sm pos-rlt label "+g+"'>"+f+"</span> <!--<span class='badge badge-"+g+"'>"+h+"</span>-->"});Handlebars.registerHelper("get_id_from_hash",function(){return getIdFromHash()});Handlebars.registerHelper("get_subscribers_type_from_hash",function(){var h=window.location.hash.substr(1);var g=_agile_get_translated_val("subscriber_type");for(var f in g){if(h.indexOf(f)!=-1){return g[f]}}});Handlebars.registerHelper("check_plan",function(g,f){console.log(g);if(!_billing_restriction){return f.fn(this)}if(_billing_restriction.currentLimits.planName==g){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("isSafariBrowser",function(f){if(navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("xeroType",function(f){return(f=="ACCPAY")?"Payable":"Receivable"});Handlebars.registerHelper("xeroTypeToolTip",function(f){return(f=="ACCPAY")?"Payable":"Receivable"});Handlebars.registerHelper("capFirstLetter",function(g){if(g){if(g==="DEFAULT"){return""}else{var f=g.toLowerCase();return f.charAt(0).toUpperCase()+f.slice(1)}}});Handlebars.registerHelper("qbStatus",function(f){console.log(this);console.log(this.TotalAmt);if(f==0){return"Paid"}else{return"Due"}});Handlebars.registerHelper("currencyFormat",function(f){return Number(f).toLocaleString("en")});Handlebars.registerHelper("QbDateFormat",function(g){var f=[];f=g.split("-");return f[0]+"-"+f[2]+"-"+f[1]});Handlebars.registerHelper("hasScope",function(f,g){if(CURRENT_DOMAIN_USER.scopes&&$.inArray(f,CURRENT_DOMAIN_USER.scopes)!=-1){return g.fn(this)}return g.inverse(this)});Handlebars.registerHelper("hasMenuScope",function(f,g){if(CURRENT_DOMAIN_USER.menu_scopes&&$.inArray(f,CURRENT_DOMAIN_USER.menu_scopes)!=-1){return g.fn(this)}return g.inverse(this)});Handlebars.registerHelper("canSyncContacts",function(f){if(canImportContacts()){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("hasMenuScope",function(g,f){if((CURRENT_DOMAIN_USER.menu_scopes).indexOf(g)!=-1){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("fetchXeroUser",function(f){return JSON.parse(f).xeroemail});Handlebars.registerHelper("isContactType",function(h,g,f){if(!h&&g=="PERSON"){return f.fn(this)}else{if(h==g){return f.fn(this)}}return f.inverse(this)});Handlebars.registerHelper("getfbreturndomain",function(g){var f=window.location.href.split("/");return f[2]});Handlebars.registerHelper("tagManagementCollectionSetup",function(h){console.log(h);var l={};var m=[];for(var k=0;k<h.length;k++){var g=h[k].tag;var j=g.charAt(0).toUpperCase();if(jQuery.inArray(j,m)==-1){m.push(j)}}console.log(m);m.sort();var f="";for(var k=0;k<m.length;k++){f+="<div class='row b-b p-b-md'><div class='col-md-1' style='font-size:16px;padding-top:20px;'>"+m[k]+"</div><div class='col-md-10'><div tag-alphabet=\""+encodeURI(m[k])+'"><ul class="tags-management tag-cloud" style="list-style:none;"></ul></div></div></div>'}console.log(f);return new Handlebars.SafeString(f)});Handlebars.registerHelper("containsScope",function(g,h,f){if(h.length==0||!g){return f.inverse(this)}if(jQuery.inArray(g,h)==-1){return f.inverse(this)}return f.fn(this)});Handlebars.registerHelper("isOwnerOfContact",function(g,f){if(CURRENT_DOMAIN_USER.id==g){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("getAccountOwnerId",function(f){return CURRENT_DOMAIN_USER.id});Handlebars.registerHelper("canEditContact",function(g,f){if(canEditContact(g)){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("canEditCurrentContact",function(g,f){if(canEditCurrentContact()){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("gateway_exists",function(j,k,g){for(var h=0;h<k.length;h++){var f=JSON.parse(k[h].prefs);if(k[h].name=="EmailGateway"){if(f.email_api==j){return g.fn(k[h])}}if(k[h].name=="SMS-Gateway"){if(f.sms_api==j){return g.fn(k[h])}}}return g.inverse(this)});Handlebars.registerHelper("each_index_slice",function(l,h,g){var f="";for(var j=h;j<l.length;j++){var k=l[j];console.log(k);f+=g.fn(k)}return f});Handlebars.registerHelper("gateway_exists",function(j,k,g){for(var h=0;h<k.length;h++){var f=JSON.parse(k[h].prefs);if(k[h].name=="EmailGateway"){if(f.email_api==j){return g.fn(k[h])}}if(k[h].name=="SMS-Gateway"){if(f.sms_api==j){return g.fn(k[h])}}}return g.inverse(this)});Handlebars.registerHelper("isOwnerOfContact",function(g,f){if(CURRENT_DOMAIN_USER.id==g){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("canEditContact",function(g,f){if((hasScope("UPDATE_CONTACTS")||hasScope("EDIT_CONTACT"))||CURRENT_DOMAIN_USER.id==g){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("getAccountPlanName",function(f){if(!f){return"Free"}var g=f.split("_");return ucfirst(g[0])});Handlebars.registerHelper("getAccountPlanInteval",function(f){if(!f){return"Monthly"}var g=f.split("_");return ucfirst(g[1])});Handlebars.registerHelper("getSubscriptionBasedOnPlan",function(i,h,f){var g=getSubscriptionWithAmount(i,h);if(g!=null){return f.fn(g)}return f.inverse(this)});Handlebars.registerHelper("iso_date_to_normalizeDate",function(g){if(g.length<=0){return}var f=g.split("T");console.log("normalize date "+f[0]);return f[0]});Handlebars.registerHelper("getMonthFromIndex",function(h){var g=["January","February","March","April","May","June","July","August","September","October","November","December"];var f="";if(h>12){f=g[11]}else{f=g[h-1]}return _agile_get_translated_val("months",f)});Handlebars.registerHelper("xeroOrganisationShortCode",function(f){if(typeof SHORT_CODE=="undefined"||SHORT_CODE==""){return false}else{return SHORT_CODE}});Handlebars.registerHelper("buildOptions",function(h){var f=h.split(";");var g="";$.each(f,function(i,j){if(j!=""){g=g.concat('<option value="'+j+'">'+j+"</option>")}});return g});Handlebars.registerHelper("get_avatars_template",function(f){var g=getTemplate("choose-avatar-images-modal",{});getTemplate("choose-avatar-images-modal",{},undefined,function(i){if(!i){return}var h=$(i)},null);return g});Handlebars.registerHelper("if_email_type_is_agile",function(h,f){var g=email_server_type;if(g){if(h===g){return f.fn(this)}else{return f.inverse(this)}}else{return f.fn(this)}});Handlebars.registerHelper("read_global_var",function(){var f=email_server_type;if(f){return f}else{return"agilecrm"}});Handlebars.registerHelper("if_non_pro_plan",function(f){if(!_billing_restriction){return f.inverse(this)}if(_billing_restriction.currentLimits.planName!=="PRO"){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("has_email_account_limit_reached",function(f){var g=HAS_EMAIL_ACCOUNT_LIMIT_REACHED;if(g){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("pick_random_avatar_url",function(f){return choose_random_avatar()});Handlebars.registerHelper("getRemaininaEmails",function(){return getPendingEmails()});Handlebars.registerHelper("getLastPurchasedCount",function(){var f=getMaxEmailsLimit();if(f==0){return"-"}else{return getPendingEmails()}});Handlebars.registerHelper("getFreeEmailsCount",function(){var f=getMaxEmailsLimit();if(f==0){return"5000"}else{return"-"}});Handlebars.registerHelper("getEmailCreditsCount",function(){return getEmailCreditsCount()});Handlebars.registerHelper("inboundMail",function(){var f=window.location.hostname.split(".")[0]+"-"+_AGILE_API_KEY+"@agle.cc";return new Handlebars.SafeString(f)});Handlebars.registerHelper("getTime",function(h){if(!h){return}if((h/100000000000)>1){var j=new Date(parseInt(h));var f=j.getHours();if(f>12){f=f-12}var i=j.getMinutes();if(i==0){i="00"}var g=f>=12?"PM":"AM";return f+":"+i+" "+g}var j=new Date(parseInt(h)*1000);var f=j.getHours();if(f>12){f=f-12}var i=j.getMinutes();if(i==0){i="00"}var g=f>=12?"PM":"AM";return f+":"+i+" "+g});Handlebars.registerHelper("getCustomDateWithTime",function(l,f){var k=a(l);var j=a(f);var h=b(l);var g=b(f);var i=c(f);if(k!=j){return h+" - "+g}else{return h+" - "+i}});function b(i){var f=["Jan","Feb","March","April","May","Jun","July","Aug","Sept","Oct","Nov","Dec"];if(!i){return}if((i/100000000000)>1){var m=new Date(parseInt(i));var g=m.getHours();var k=m.getFullYear();var i=m.getDate();var l=m.getMonth();var j=m.getMinutes();if(j==0){j="00"}var h=g>=12?"PM":"AM";if(g>12){g=g-12}return _agile_get_translated_val("months-xs",f[l])+" "+i+", "+k+" "+g+":"+j+" "+h}var m=new Date(parseInt(i)*1000);var g=m.getHours();var k=m.getFullYear();var i=m.getDate();var l=m.getMonth();var j=m.getMinutes();if(j==0){j="00"}var h=g>=12?"PM":"AM";if(g>12){g=g-12}return _agile_get_translated_val("months-xs",f[l])+" "+i+", "+k+" "+g+":"+j+" "+h}function c(h){if(!h){return}if((h/100000000000)>1){var j=new Date(parseInt(h));var f=j.getHours();var i=j.getMinutes();if(i==0){i="00"}var g=f>=12?"PM":"AM";if(f>12){f=f-12}return f+":"+i+" "+g}var j=new Date(parseInt(h)*1000);var f=j.getHours();var i=j.getMinutes();if(i==0){i="00"}var g=f>=12?"PM":"AM";if(f>12){f=f-12}return f+":"+i+" "+g}function a(f){if((f/100000000000)>1){var g=new Date(parseInt(f));return g.getDate()}else{var g=new Date(parseInt(f)*1000);return g.getDate()}}Handlebars.registerHelper("getContactDisplayValue",function(f){var g;var m=f.type;var k=f.properties;if(k){if(m=="COMPANY"){for(var j=0;j<k.length;j++){if(k[j].name=="name"){g=k[j].value;break}}}else{var l;var h;for(var j=0;j<k.length;j++){if(k[j].name=="first_name"){l=k[j].value}if(k[j].name=="last_name"){h=k[j].value}}if(!l){l=""}if(!h){h==""}g=l+" "+h}}return g});Handlebars.registerHelper("getGoogleEventCustomTime",function(i,g){var f=new Date(i);
var h=new Date(g);return e(f.getTime(),h.getTime())});function e(h,j){var n=a(h);var m=a(j);var g=b(h);var f=b(j);var i=c(j);var o=d(h);if(o==0||o==1){var l=c(h);var k=c(j);if(l&&k){return l+" - "+k}if(k){return l+" - "+k}else{return l}}else{if(n!=m){if(f){return g+" - "+f}else{return g}}else{return g+" - "+i}}}Handlebars.registerHelper("displayCustomDateTime",function(m,f){var h=get_activity_created_time(m);var l=a(m);var k=a(f);var i=b(m);var g=b(f);var j=c(f);if(h==0||eventCreatedTime==1){return j}else{if(l!=k){return i+" - "+g}else{return i+" - "+j}}});function d(h){var g=new Date(h);h=g.getTime()/1000;var f=new Date();f.setHours(0,0,0,0);f=f.getTime()/1000;return Math.floor((h-f)/(24*3600))}Handlebars.registerHelper("arrayToCamelcase",function(g){var f="";for(var h=0;h<g.length;h++){f+=ucfirst(g[h]);if(h+1<g.length){f+=", "}}return f});Handlebars.registerHelper("namesFromObject",function(h,j){var f="";console.log(h.length);for(var g=0;g<h.length;g++){f+=h[g][j];if(g+1<h.length){f+=", "}}return f});Handlebars.registerHelper("secondsToFriendlyTime",function(i){var g=Math.floor(i/3600);if(g>0){i=i-g*60*60}var h=Math.floor(i/60);var j=i-h*60;var f="";if(g==1){f=g+"h "}if(g>1){f=g+"h "}if(h>0){f+=h+"m "}if(j>0){f+=j+"s "}if(f!=""){return" - "+f}return f});Handlebars.registerHelper("pick_random_avatar_url",function(f){return choose_random_avatar()});Handlebars.registerHelper("choose_custom_field_font_icon",function(g){var f="";if(g=="TEXT"){f="icon-text-height"}else{if(g=="TEXTAREA"){f="icon-file-alt"}else{if(g=="DATE"){f="icon-calendar"}else{if(g=="CHECKBOX"){f="icon-check"}else{if(g=="LIST"){f="icon-list-ul"}else{if(g=="NUMBER"){f="icon-text-height"}}}}}}return f});Handlebars.registerHelper("choose_custom_field_type",function(g){var f="";if(g=="TEXT"){f="Text Field"}else{if(g=="TEXTAREA"){f="Text Area"}else{if(g=="DATE"){f="Date Field"}else{if(g=="CHECKBOX"){f="Checkbox"}else{if(g=="LIST"){f="List"}else{if(g=="NUMBER"){f="Number"}else{if(g=="FORMULA"){f="Formula"}}}}}}}return f});Handlebars.registerHelper("ifCond",function(i,g,h,f){if(!i||!h){return f.inverse(this)}switch(g){case"greaterthan":if(parseInt(i)>parseInt(h)){return f.fn(this)}break;case"lessthan":if(parseInt(i)<parseInt(h)){return f.fn(this)}break;case"equals":if(parseInt(i)===parseInt(h)){return f.fn(this)}break}return f.inverse(this)});Handlebars.registerHelper("callActivityFriendlyStatus",function(f,g){switch(f){case"completed":case"answered":case"inquiry":case"interest":case"no interest":case"incorrect referral":case"meeting scheduled":case"new oppurtunity":return _agile_get_translated_val("call_activity","duration");break;case"busy":case"no-answer":if(g=="outgoing"){return _agile_get_translated_val("call_activity","busy")}else{return _agile_get_translated_val("call_activity","no_answer")}break;case"failed":return _agile_get_translated_val("call_activity","fail");break;case"missed":return _agile_get_translated_val("call_activity","missed");break;case"in-progress":case"voicemail":return _agile_get_translated_val("call_activity","voicemail");break;case"missed":return _agile_get_translated_val("call_activity","missed");break;default:return""}});Handlebars.registerHelper("shopifyWebhook",function(){var f=agileWindowOrigin()+"/shopifytrigger?api-key="+_AGILE_API_KEY;return new Handlebars.SafeString(f)});Handlebars.registerHelper("toProperFormat",function(f){if(f=="0"){return"0 s"}return twilioSecondsToFriendly(f)});Handlebars.registerHelper("get_portlet_name",function(f){var g="";if(f=="Filter Based"){g="contact-list"}else{if(f=="Emails Opened"){g="email-opens"}else{if(f=="Emails Sent"){g="emails"}else{if(f=="Growth Graph"){g="tag-graph"}else{if(f=="Calls Per Person"){g="calls"}else{if(f=="Pending Deals"){g="pending-deals"}else{if(f=="Deals By Milestone"){g="deals-by-milestone"}else{if(f=="Closures Per Person"){g="closures-per-person"}else{if(f=="Deals Won"){g="deals-won"}else{if(f=="Deals Funnel"){g="deals-funnel"}else{if(f=="Deals Assigned"){g="deals-assigned"}else{if(f=="Agenda"){g="events"}else{if(f=="Today Tasks"){g="tasks"}else{if(f=="Agile CRM Blog"){g="agile-crm-blog"}else{if(f=="Task Report"){g="task-report"}else{if(f=="Stats Report"){g="activity-overview"}else{if(f=="Campaign stats"){g="campaign-stats"}else{if(f=="Campaign graph"){g="campaign-status"}else{if(f=="Average Deviation"){g="task_deviation"}else{if(f=="Webstat Visits"){g="visits"}else{if(f=="Referralurl stats"){g="ref-url-stats"}else{if(f=="Lost Deal Analysis"){g="deals-lost-reason"}else{if(f=="Revenue Graph"){g="revenue-graph"}else{if(f=="Mini Calendar"){g="mini-calendar"}else{if(f=="Deal Goals"){g="deal-goals"}else{if(f=="Incoming Deals"){g="incoming-deals"}else{if(f=="Leaderboard"){g="leaderboard"}else{if(f=="Account Details"){g="account-details"}else{if(f=="User Activities"){g="user-activities"}else{g=f}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return _agile_get_translated_val("portlets",g)});Handlebars.registerHelper("get_portlet_icon",function(f){var g="";if(f=="Filter Based"){g="icon-user"}else{if(f=="Emails Opened"){g="icon-envelope"}else{if(f=="Emails Sent"){g="icon-envelope"}else{if(f=="Growth Graph"||f=="Incoming Deals"){g="icon-graph"}else{if(f=="Calls Per Person"){g="icon-call-end"}else{if(f=="Pending Deals"||f=="Average Deviation"){g="icon-clock"}else{if(f=="Deals By Milestone"){g="icon-flag"}else{if(f=="Closures Per Person"){g="icon-thumbs-up"}else{if(f=="Deals Won"){g="icon-briefcase"}else{if(f=="Deals Funnel"){g="icon-filter"}else{if(f=="Deals Assigned"){g="icon-user"}else{if(f=="Agenda"||f=="Mini Calendar"){g="icon-calendar"}else{if(f=="Today Tasks"||f=="Task Report"||f=="Referralurl stats"){g="icon-tasks"}else{if(f=="Agile CRM Blog"){g="icon-feed"}else{if(f=="Stats Report"){g="icon-speedometer"}else{if(f=="Leaderboard"){g="icon-trophy"}else{if(f=="User Activities"){g="icon-cogs"}else{if(f=="Account Details"){g="icon-info"}else{if(f=="Revenue Graph"){g="icon-graph"}else{if(f=="Campaign stats"){g="icon-sitemap"}else{if(f=="Campaign graph"){g="icon-pie-chart"}else{if(f=="Deal Goals"){g="icon-flag"}else{if(f=="Lost Deal Analysis"){g="icon-pie-chart"}else{if(f=="Webstat Visits"){g="icon-globe"}}}}}}}}}}}}}}}}}}}}}}}}return g});Handlebars.registerHelper("if_equals_or",function(){var f=arguments[arguments.length-1];try{for(var g=0;g<arguments.length-1;g=g+2){value=arguments[g];target=arguments[g+1];if((typeof target==="undefined")||(typeof value==="undefined")){return f.inverse(this)}if(value.toString().trim()==target.toString().trim()){return f.fn(this)}}return f.inverse(this)}catch(h){console.log("error while if_equals_or of handlebars helper : "+h.message);return f.inverse(this)}});Handlebars.registerHelper("buildFacebookProfileURL",function(f){return buildFacebookProfileURL(f)});Handlebars.registerHelper("getTracksCount",function(f){if(parseInt(DEAL_TRACKS_COUNT)>1){return f.fn(this)}else{return f.inverse(this)}});Handlebars.registerHelper("get_AM_PM_format",function(g){var i=new Date(g*1000);var f=i.getHours();var j=i.getMinutes();var h=f>=12?"pm":"am";f=f%12;f=f?f:12;j=j<10?"0"+j:j;if(f<10){f="0"+f}var k=f+":"+j+""+h;return k});Handlebars.registerHelper("get_duration",function(f,k){var j="";var l=0;var h=0;var i=0;var g=k-f;l=Math.floor(g/(24*60*60));h=Math.floor((g%(24*60*60))/(60*60));i=Math.floor(((g%(24*60*60))%(60*60))/60);if(l!=0&&l==1){j+=""+l+"d "}else{if(l!=0&&l>1){j+=""+l+"d "}}if(h!=0&&h==1){j+=""+h+"h "}else{if(h!=0&&h>1){j+=""+h+"h "}}if(i!=0&&i==1){j+=""+i+"m"}else{if(i!=0&&i>1){j+=""+i+"m"}}return j});Handlebars.registerHelper("displayActivityFieldText",function(h){var f=h.replace(/[^a-zA-Z ^,]/g," ").split(",");var j="";if(f.length>1){for(var g=0;g<f.length-1;g++){j+=" "+f[g].trim();if(g!=f.length-2){j+=","}}j+=" and "+f[f.length-1].trim()}else{j=f[f.length-1].trim()}j=j.replace("subject","Title");j=j.replace("priority type","Priority");j=j.replace("task type","Category");j=j.replace("due date","Due date");j=j.replace("name","Name");j=j.replace("probability","Probability");j=j.replace("expected value","Expected value");j=j.replace("close date","Close date");j=j.replace("close date","Close date");j=j.replace("end date","End time");j=j.replace("priority","Priority");j=j.replace("title","Title");j=j.replace("task description","Description");j=j.replace("description","Description");return j});Handlebars.registerHelper("numberWithCommasForActivities",function(f){f=parseFloat(f);if(f==0){return f}if(f){return f.toFixed(2).toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",").replace(".00","")}});Handlebars.registerHelper("get_event_rescheduled",function(k,h){console.log(k);var g=k.replace(/[^a-zA-Z ^,]/g," ").split(",");var f=[];if(g){for(var j=0;j<g.length;j++){f.push(g[j].trim())}}if(f.indexOf("start date")!=-1){return h.fn(k)}if(f.indexOf("due date")!=-1){return h.fn(k)}return h.inverse(k)});Handlebars.registerHelper("getDueDateOfTask",function(f,g){var m=f.replace(/[^a-zA-Z ^,]/g," ").split(",");var l=g.replace(/[^a-zA-Z0-9 ^,]/g," ").split(",");var j={};for(var n=0;n<m.length;n++){m[n]=m[n].trim();l[n]=l[n].trim()}for(var h=0;h<m.length;h++){j[m[h]]=l[h]}if(m.indexOf("due date")!=-1){var k=parseFloat(j["due date"]);return convertToHumanDate("ddd mmm dd yyyy h:MM TT",k)}if(m.indexOf("start date")!=-1){var k=parseFloat(j["start date"]);return convertToHumanDate("ddd mmm dd yyyy h:MM TT",k)}});Handlebars.registerHelper("getDealCustomProperties",function(g,h){var f=getDealCustomProperties(g);if(f.length==0){return h.inverse(f)}return h.fn(f)});Handlebars.registerHelper("getFormNameFromId",function(g){var f="<div id='"+getFormNameCellIDForFormSubmitTriggers(g)+"'></div>";return new Handlebars.SafeString(f)});Handlebars.registerHelper("isTracksEligible",function(f){if(_billing_restriction.currentLimits.addTracks){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("hasSingleTrack",function(f){try{var g=App_Admin_Settings.pipelineGridView.collection.length;if(g>1){return f.fn(this)}}catch(h){console.log(h)}return f.inverse(this)});Handlebars.registerHelper("get_subject",function(g){var f="Email subject: ";
try{if(g){return g.slice(g.indexOf(f)+f.length,g.length)}}catch(h){return g}return g});Handlebars.registerHelper("isCurrentDeal",function(g,f){var h="";if(App_Deal_Details.dealDetailView){h=App_Deal_Details.dealDetailView.model.id}if(g&&g==h){return f.fn(this)}return f.inverse(this)});Handlebars.registerHelper("trigger_milestone",function(g,f){if(!g){return g}var h=g.split("_");if(h.length==1){return g}if(h.length>1&&h[0]!=" "&&!isNaN(Number(h[0]))){h.splice(0,1);return h.join("_")}});Handlebars.registerHelper("get_url",function(g){if(g){if(g.indexOf("fwd=cd")==-1){return new Handlebars.SafeString(g)}var f;if(g.indexOf("?fwd=cd")!=-1){f="?fwd=cd"}else{f="&fwd=cd"}try{if(f){return new Handlebars.SafeString(g.split(f)[0])}}catch(h){console.log("Error in get_limiter:"+h);return new Handlebars.SafeString(g)}}return new Handlebars.SafeString(g)});Handlebars.registerHelper("get_limiter",function(g,f){try{if(g&&f){return g.slice(g.indexOf(f)+f.length,g.length)}}catch(h){console.log("Error in get_limiter:"+h);return g}return g});Handlebars.registerHelper("isAllowedInCurrentPlan",function(g,f){if(_plan_restrictions[g]&&_plan_restrictions[g][0]&&_plan_restrictions[g][0]()){return f.fn(this)}else{if(_plan_restrictions[g]&&_plan_restrictions[g][1]){return f.inverse(_plan_restrictions[g][1]())}else{return f.inverse(this)}}});Handlebars.registerHelper("toSafeString",function(f){return new Handlebars.SafeString(f)});Handlebars.registerHelper("getPlanLimits",function(f){if(_billing_restriction.currentLimits.planName=="PRO"||_billing_restriction.currentLimits.planName=="ENTERPRISE"){return"Unlimited"}else{return _billing_restriction.currentLimits[f]}});Handlebars.registerHelper("getLeaderboardCateCount",function(f){var g=0;if(f.revenue){g++}if(f.dealsWon){g++}if(f.calls){g++}if(f.tasks){g++}return g});Handlebars.registerHelper("getIndexIncrementByOne",function(f){return ++f});Handlebars.registerHelper("get_portlet_duration",function(f){console.log("duration = "+f);if(!f){f="today"}return _agile_get_translated_val("portlets",f)});Handlebars.registerHelper("get_campaign_reports_duration",function(g){console.log("duration = "+g);var f={DAILY:"Daily",WEEKLY:"Weekly",MONTHLY:"Monthly",};return f[g]});Handlebars.registerHelper("timeAgo",function(j){var g=new Date();try{var l="-";var h=new RegExp(l,"g");j=j.replace(h,"/");j=j.match(/[^:]+(\:[^:]+)?/g);g=new Date(j[0]+" UTC")}catch(i){console.log("Error in parsing date")}var k=Math.floor((new Date()-g)/1000);var f=Math.floor(k/31536000);if(f>1){return f+" "+_agile_get_translated_val("misc-keys","yrs_ago")}f=Math.floor(k/2592000);if(f>1){return f+" "+_agile_get_translated_val("misc-keys","mnths_ago")}f=Math.floor(k/86400);if(f>1){return f+" "+_agile_get_translated_val("misc-keys","days_ago")}f=Math.floor(k/3600);if(f>1){return f+" "+_agile_get_translated_val("misc-keys","hrs_ago")}f=Math.floor(k/60);if(f>1){return f+" "+_agile_get_translated_val("misc-keys","mins_ago")}return new Handlebars.SafeString(Math.floor(k)+" "+_agile_get_translated_val("misc-keys","secs_ago"))});Handlebars.registerHelper("capitalizeFirstLetter",function(g,f){return new Handlebars.SafeString(g.charAt(0).toUpperCase()+g.slice(1)+", "+f)});Handlebars.registerHelper("getDefaultImage",function(){return new Handlebars.SafeString(updateImageS3Path(FLAT_FULL_PATH+"images/flatfull/user-default.jpg"))});Handlebars.registerHelper("companyTableHeadings",function(h){var g="",f="";$.each(App_Companies.companyViewModel[h],function(i,j){if(j=="basic_info"||j=="image"){if(_agile_get_prefs("companyTabelView")){if(j=="basic_info"){return}if(j=="image"){j="";f=""}}else{if(j=="image"){j="";f="compactcontact"}if(j=="basic_info"){j="Basic Info"}}}else{if(j=="url"){g=g.concat('<th class="'+f+'">URL</th>');return}else{if(j.indexOf("CUSTOM_")==0){j=j.split("_")[1];f="text-muted"}else{j=j.replace("_"," ");f=""}}}j=getTableLanguageConvertHeader(j);g=g.concat('<th class="'+f+'">'+ucfirst(j)+"</th>")});return new Handlebars.SafeString(g)});Handlebars.registerHelper("companies_count",function(){var f;if(this[0]&&this[0].count&&(this[0].count!=-1)){if(this[0].count>9999&&(_agile_get_prefs("company_filter")||_agile_get_prefs("dynamic_company_filter"))){f="<small> ("+10000+"+ "+_agile_get_translated_val("other","total")+') </small><span style="vertical-align: text-top; margin-left: -5px"><img border="0" src="'+updateImageS3Path("/img/help.png")+'"style="height: 10px; vertical-align: middle" rel="popover"data-placement="bottom" data-title="Lead Score"data-content="'+_agile_get_translated_val("results","over-count")+'"id="element" data-trigger="hover"></span>'}else{f="<small> ("+this[0].count+" "+_agile_get_translated_val("other","total")+") </small>"}}else{f="<small> ("+this.length+" "+_agile_get_translated_val("other","total")+") </small>"}return new Handlebars.SafeString(f)});Handlebars.registerHelper("getSubscriptionDate",function(i,g){if(!i){return 0}var f=getLastDateOfSubscription(i);if(!f){return 0}var h=Math.round(new Date().getTime()/1000);if(f<h){return 0}return f})});function getEventCreatedTime(c){var b=new Date(c);c=b.getTime()/1000;var a=new Date();a.setHours(0,0,0,0);a=a.getTime()/1000;return Math.floor((c-a)/(24*3600))}Handlebars.registerHelper("getcircle",function(a){prec=(360*a)/100;if(prec<=180){return"background-image :linear-gradient("+(prec+90)+"deg, transparent 50%, #e8eff0 50%),linear-gradient(90deg, #e8eff0  50%, transparent 50%)"}else{return"background-image :linear-gradient("+(prec-90)+"deg, transparent 50%, #39B4CC 50%), linear-gradient(90deg, #e8eff0 50%, transparent 50%)"}});Handlebars.registerHelper("ONBOARDING_CALENDAR_URL",function(){return ONBOARDING_SCHEDULE_URL});Handlebars.registerHelper("SUPPORT_CALENDAR_URL",function(){return SUPPORT_SCHEDULE_URL});Handlebars.registerHelper("SALES_CALENDAR_URL",function(){return SALES_SCHEDULE_URL});Handlebars.registerHelper("get_portlet_description",function(a){var b="";if(a=="Filter Based"){b="contact-list-desc"}else{if(a=="Emails Opened"){b="email-opens-desc"}else{if(a=="Growth Graph"){b="tag-graph-desc"}else{if(a=="Calls Per Person"){b="calls-desc"}else{if(a=="Pending Deals"){b="pending-deals-desc"}else{if(a=="Deals By Milestone"){b="deals-by-milestone-desc"}else{if(a=="Deals Funnel"){b="deals-funnel-desc"}else{if(a=="Agenda"){b="events-desc"}else{if(a=="Today Tasks"){b="tasks-desc"}else{if(a=="Task Report"){b="task-report-desc"}else{if(a=="Agile CRM Blog"){b="agile-crm-blog-desc"}else{if(a=="Stats Report"){b="stats-report-desc"}else{if(a=="Leaderboard"){b="leaderboard-desc"}else{if(a=="User Activities"){b="user-activities-desc"}else{if(a=="Account Details"){b="account-details-desc"}else{if(a=="Revenue Graph"){b="revenue-graph-desc"}else{if(a=="Mini Calendar"){b="mini-calendar-desc"}else{if(a=="Campaign stats"){b="campaign-stats-desc"}else{if(a=="Campaign graph"){b="campaign-graph-desc"}else{if(a=="Deal Goals"){b="deal-goals-desc"}else{if(a=="Incoming Deals"){b="incoming-deals-desc"}else{if(a=="Lost Deal Analysis"){b="lost-deals-description"}else{if(a=="Average Deviation"){b="average-deviation-desc"}else{if(a=="Webstat Visits"){b="webstat-visits-desc"}else{if(a=="Referralurl stats"){b="top-ref-url-desc"}}}}}}}}}}}}}}}}}}}}}}}}}return _agile_get_translated_val("portlets",b)});Handlebars.registerHelper("trialEndDate",function(e,i){var h={};var a=new Date().getTime()/1000;a=Math.round(a);if(!e){return i.inverse(this)}console.log(e);if(e.metadata&&e.metadata.trial_end&&e.metadata.trial_end>a){var g=(parseInt(e.metadata.trial_end)-a)/(24*60*60);g=Math.round(g);var f=(e.metadata.trial_end)/(24*60*60);if(g>0){h.trial_exists=true;h.days_left=g;var d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var b=new Date();b.setDate(b.getDate()+g);var c=b.getDate()+" "+(d[b.getMonth()])+" "+b.getFullYear();h.trial_date=c;console.log("trial in json is:"+h.trial_date)}else{h.trial_exists=false}}else{h.trial_exists=false}return i.fn(h)});Handlebars.registerHelper("trialEnd",function(g,d){var e={};var f=new Date().getTime()/1000;f=Math.round(f);if(!g){return d.inverse(this)}console.log(g);if(g.metadata&&g.metadata.trial_end&&g.metadata.trial_end>f){var a=(parseInt(g.metadata.trial_end)-f)/(24*60*60);a=Math.floor(a);if(a>0){e.trial_exists=true;e.days_left=a;var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var b=new Date();b.setDate(b.getDate()+a);var h=b.getDate()+" "+(c[b.getMonth()])+" "+b.getFullYear();h=JSON.stringify(h);console.log(h);e.trial_date=h}else{e.trial_exists=false}}else{e.trial_exists=false}return d.fn(e)});Handlebars.registerHelper("toggle_contacts_filter",function(a){if(_agile_get_prefs(CONTACTS_DYNAMIC_FILTER_COOKIE_STATUS)=="hide"){return"none"}});Handlebars.registerHelper("toggle_companies_filter",function(a){return _agile_get_prefs("companiesFilterStatus")});Handlebars.registerHelper("contact_filter_tooltip",function(a){if(_agile_get_prefs(CONTACTS_DYNAMIC_FILTER_COOKIE_STATUS)=="hide"){return"Show Filters"}else{return"Hide Filters"}});Handlebars.registerHelper("company_filter_tooltip",function(a){if(_agile_get_prefs("companiesFilterStatus")=="display:none"){return"Show Filters"}else{return"Hide Filters"}});Handlebars.registerHelper("totalTimeFormat",function(a){if(a=="0"){return"0 sec"}return SecondsToCampaignTime(a)});Handlebars.registerHelper("allowed_domain_list",function(d){var c="";if(d){var b=d.split(",");for(var a in b){b[a]=b[a].trim();c+="<tr data='"+b[a]+"' style='display: table-row;'><td><div class='inline-block v-top text-ellipsis' style='width:80%'>";c+=b[a]+"</div></td><td class='b-r-none'><div class='m-b-n-xs' style='display:none;'><a class='allowed-domain-delete c-p m-l-sm text-l-none text-xs'  data-toggle='modal' role='button' href='#'><i title='Delete Allowed Domain' class='task-action icon icon-trash'></i></a></div></td></tr>"}}return c});Handlebars.registerHelper("blocked_ips_list",function(d){var c="";if(d){var a=d.split(",");for(var b in a){a[b]=a[b].trim();c+="<tr data='"+a[b]+"' style='display: table-row;'><td><div class='inline-block v-top text-ellipsis' style='width:80%'>";
c+=a[b]+"</div></td><td class='b-r-none'><div class='m-b-n-xs' style='display:none;'><a class='blocked-ip-delete c-p m-l-sm text-l-none text-xs'  data-toggle='modal' role='button' href='#'><i title='Delete Blocked IP' class='task-action icon icon-trash'></i></a></div></td></tr>"}}return c});Handlebars.registerHelper("hide_allowed_domains_text",function(b,a){if(b&&b!="localhost, *"){return a.inverse(this)}return a.fn(this)});Handlebars.registerHelper("proToEnterprise",function(e,d){var c="Free";if(e.indexOf("PRO")>=0){e=e.replace("PRO","ENTERPRISE")}var a=e.split("_");var b="Monthly";if(a.length>1){b=ucfirst(a[1]);c=ucfirst(a[0]);return c+" ("+b+")"}});Handlebars.registerHelper("invoice_description",function(a){console.log(a);if(!a){return a}if(a.indexOf("Unused time on")!=-1){a=_agile_get_translated_val("billing","invoice-bal-from")}else{if(a.indexOf("Remaining")!=-1){a=_agile_get_translated_val("billing","invoice-changed-on")+a.substring(a.indexOf("after")+5)}}return a+" "});Handlebars.registerHelper("is_unsubscribed_all",function(d){var c=App_Contacts.contactDetailView.model.toJSON();var f=getPropertyValue(c.properties,"first_name");if(c&&c.unsubscribeStatus&&c.unsubscribeStatus.length>0){var g=c.unsubscribeStatus;for(var e=0,a=g.length;e<a;e++){var b=g[e];if(b.unsubscribeType&&b.unsubscribeType=="ALL"){return d.fn({first_name:f,campaign_id:b.campaign_id})}}}return d.inverse(this)});Handlebars.registerHelper("is_mobile",function(a){if(agile_is_mobile_browser()){return a.fn(this)}else{return a.inverse(this)}});Handlebars.registerHelper("getS3ImagePath",function(a){return new Handlebars.SafeString(updateImageS3Path(a))});Handlebars.registerHelper("is_trial_exist",function(b,a){if(b&&b.subscriptions){var c=false;$.each(b.subscriptions.data,function(e,f){if(!f.plan.id.indexOf("email")>-1&&f.trialStart&&f.trialEnd&&f.trialEnd>=(new Date().getTime()/1000)){var g=f.trialStart;var d=f.trialEnd;if(d-g<=864000){c=true;return false}}});if(c){return a.fn(this)}else{return a.inverse(this)}}else{return a.inverse(this)}});Handlebars.registerHelper("is_greater",function(b,c,a){if(parseInt(c)<b){return a.fn(this)}else{return a.inverse(this)}});Handlebars.registerHelper("is_domain_owner",function(a){if(CURRENT_DOMAIN_USER.is_account_owner){return a.fn(this)}else{return a.inverse(this)}});Handlebars.registerHelper("is_not_allowed_trial",function(a){if(IS_TRIAL&&IS_ALLOWED_TRIAL){return a.inverse(this)}else{return a.fn(this)}});Handlebars.registerHelper("getContactTypeCustomFields",function(d,h,a,b){if(d!="CONTACT"&&d!="COMPANY"){return h}var f="";var c;try{c=$.parseJSON(h)}catch(e){}var g="";if(c){$.each(c,function(i,j){if(i!=c.length-1){g+=j+","}else{g+=j}});App_Contacts.referenceContactsCollection=new Base_Collection_View({url:"/core/api/contacts/references?references="+g,sort_collection:false});App_Contacts.referenceContactsCollection.collection.fetch({success:function(i){if(i&&i.length>0){if(d=="CONTACT"){$.each(c,function(p,v){var u=i.get(v).get("properties");var k=40;var o="";if(u==undefined){return}var j=getPropertyValue(u,"image");if(j){o=j}else{var n=DEFAULT_GRAVATAR_url;var r='&d=404" ';var l="";try{l=text_gravatar_initials(u)}catch(q){console.log(q)}if(l.length==0){r="&d="+DEFAULT_GRAVATAR_url+'" '}var m="";m='onLoad="image_load(this)" onError="image_error(this)"_data-name="'+l;var t=getPropertyValue(u,"email");if(t){o=new Handlebars.SafeString("https://secure.gravatar.com/avatar/"+Agile_MD5(t)+".jpg?s="+k+r+m)}o=new Handlebars.SafeString("https://secure.gravatar.com/avatar/"+Agile_MD5("")+".jpg?s="+k+""+r+m)}var s=getPropertyValue(i.get(v).get("properties"),"first_name");var w=getPropertyValue(i.get(v).get("properties"),"last_name");if(w){s+=" "+w}f+='<a href="#contact/'+v+'" class="activate-link thumb m-b-xs m-r-xs"><img  data-name="" src="'+o+'"  title="'+s+'" /></a>'})}else{if(d=="COMPANY"){$.each(c,function(n,t){var o="50";var s="display:inline";var q=parseInt(o);var r=4+((q-32)/2);var p=i.get(t).get("properties");var m="";var j="src='"+updateImageS3Path("img/com-default-img.png")+"' style='width:"+q+"px; height="+q+"px;"+s+"'";var k="";for(var l=0;l<p.length;l++){if(p[l].name=="image"){j="src='"+p[l].value+"' style='width:"+q+"px; height="+q+"px;"+s+";'";k="this.src='"+updateImageS3Path("img/com-default-img.png")+"'; this.onerror=null;";break}if(p[l].name=="url"){j="src='https://www.google.com/s2/favicons?domain="+p[l].value+"' style='width:"+q+"px; height="+q+"px; padding:"+r+"px; "+s+" ;'";k="this.src='"+updateImageS3Path("img/com-default-img.png")+"'; $(this).css('width','"+o+"px'); $(this).css('height','"+o+"px');$(this).css('padding','4px'); this.onerror=null;"}}m=new Handlebars.SafeString(j+' onError="'+k+'"');f+='<a href="#company/'+t+'" class="activate-link thumb m-b-xs m-r-xs"><img  '+m+' title="'+getPropertyValue(i.get(t).get("properties"),"name")+'"/></a>'})}}$('.custom-value[name="'+a+'"]').html(f)}hideTransitionBar()}})}});Handlebars.registerHelper("convert_toISOString",function(b,a){try{return new Date(b).toISOString()}catch(c){}return b});Handlebars.registerHelper("emails_next_renewal_time",function(a,b){return getEmailsNextRenewalTime()});Handlebars.registerHelper("is_paid_emails",function(b){var a=getMaxEmailsLimit();if(a>0){return b.fn(this)}else{return b.inverse(this)}});Handlebars.registerHelper("getCurrentUserDashboards",function(d,b){var e="";if(d=="portlet"){e+=getTemplate("js-dashboards-options")}if(CURRENT_USER_DASHBOARDS){CURRENT_USER_DASHBOARDS.sort(function(g,f){return g.name.trim()<f.name.trim()?-1:g.name.trim()>f.name.trim()?1:0});var a=false;var c=_agile_get_prefs("dashboard_"+CURRENT_DOMAIN_USER.id);$.each(CURRENT_USER_DASHBOARDS,function(f,g){if(c==this.id){a=true}});$.each(CURRENT_USER_DASHBOARDS,function(g,h){if(d=="portlet"){var f=this.name;if(f){f=f.trim()}if(f&&f.length>15){f=f.substring(0,15)+"..."}if(this.name){e+="<option value="+this.id+" class='user-dashboard' title='"+this.name.trim()+"'>"+f+"</option>"}}else{var f=this.name;if(f){f=f.trim()}if(f&&f.length>30){f=f.substring(0,30)+"..."}if(g==0&&(!c||!a)){e+="<li class='active'><a id='Dashboard' class='user-defined-dashboard predefined-dashboard' href='#'>Dashboard</a></li>"}else{if(g==0){e+="<li><a id='Dashboard' class='user-defined-dashboard predefined-dashboard' href='#'>Dashboard</a></li>"}}if(c==this.id){e+="<li class='active'><a id="+this.id+" title='"+this.name.trim()+"' class='user-defined-dashboard' href='#'>"+f+"</a></li>"}else{e+="<li><a id="+this.id+" title='"+this.name.trim()+"' class='user-defined-dashboard' href='#'>"+f+"</a></li>"}if(g==CURRENT_USER_DASHBOARDS.length-1){e+=getTemplate("js-dashboards-options-newui")}}});if(CURRENT_USER_DASHBOARDS.length==0&&d=="dashboard"){e+="<li><a id='Dashboard' class='user-defined-dashboard predefined-dashboard' href='#'>Dashboard</a></li>";e+=getTemplate("js-dashboards-options-newui")}}return e});Handlebars.registerHelper("getTruncatedDashboardName",function(a){if(a&&a.trim().length>30){return a.trim().substring(0,30)+"..."}return a});Handlebars.registerHelper("is_acl_allowed",function(a){if(_plan_restrictions.is_ACL_allowed[0]()||checkForACLExceptionalUsers()){return a.inverse(this)}else{return a.fn(this)}});Handlebars.registerHelper("check_plan_interval",function(a,b){var d=USER_BILLING_PREFS.plan.plan_type;var c=d.split("_");if(!c[1]||!a){return b.inverse(this)}if(c[1]==a.toUpperCase()){return b.fn(this)}return b.inverse(this)});Handlebars.registerHelper("check_admin_ip",function(a){if($.inArray(CURRENTIP,IPCHECK)!=-1){return a.fn(this)}else{return a.inverse(this)}});Handlebars.registerHelper("getCredit",function(b,a){if(!b){return 0}return(b/100)*(-1).toFixed(2)});Handlebars.registerHelper("event_format_time",function(c,b,a){return c.format(b)});Handlebars.registerHelper("dottedEventDescription",function(b,a){return addDotsAtEnd(b)});Handlebars.registerHelper("get_template_type",function(a){return new Handlebars.SafeString(getTemplate(a,this))});Handlebars.registerHelper("is_IE_browser",function(a){return(isIEBrowser()?a.fn(this):a.inverse(this))});Handlebars.registerHelper("brainTreeStatus",function(b){var a={AUTHORIZED:"Authorized",VOIDED:"Voided",SUBMITTED_FOR_SETTLEMENT:"Submitted For Settlement",SETTLED:"Settled",AUTHORIZATION_EXPIRED:"Authorization Expired",AUTHORIZING:"Authorizing",SETTLEMENT_PENDING:"Settlement Pending",SETTLEMENT_CONFIRMED:"Settlement Confirmed",SETTLEMENT_DECLINED:"Settlement Declined",FAILED:"Failed",GATEWAY_REJECTED:"Gateway Rejected",PROCESSOR_DECLINED:"Processor Declined",SETTLING:"Settling"};return a[b]});function agile_is_mobile_browser(){return(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))}function isIEBrowser(){var a=(window.navigator.userAgent.indexOf("MSIE")!=-1);var b=(window.navigator.userAgent.indexOf("rv:11")!=-1);if(a||b){return true}return false}Handlebars.registerHelper("multiple_Property_Element_List",function(b,c,e,a){var d=agile_crm_get_List_contact_properties_list(b);if(d.length>0){return a.fn(d)}});Handlebars.registerHelper("getAliasFromArry",function(b,a){return b[0]});Handlebars.registerHelper("stringToHumanDateInFormat",function(a){if(!a){return}var b=new Date(a);if(b=="Invalid Date"){return getDateInFormatFromEpoc(a)}else{return en.dateFormatter({raw:getGlobalizeFormat()})(b)}});Handlebars.registerHelper("getSuggestionName",function(a){if(a){return uservoiceOBJ.suggestions[a]}});Handlebars.registerHelper("stringifyObject",function(a){var b={};b.id=a.id;b.name=a.name;if(a.display_name){b.display_name=a.display_name}else{b.display_name=a.name}b.listOfUsers=a.listOfUsers;return JSON.stringify(b)});Handlebars.registerHelper("removeSpecialCharacter",function(a){var a=a.replace(/[^\w\s]/gi,"-");return a});Handlebars.registerHelper("canDeleteContact",function(b,a){if(hasScope("DELETE_CONTACT")){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("isInCurrentView",function(f,d,c){try{var b;var g;if(window.location.hash.indexOf("#contact/")!=-1||window.location.hash.indexOf("#company/")!=-1){var a=window.location.hash.split("/")[1];
var i=this.id;if(a==i){return c.fn(this)}}}catch(h){}return c.inverse(this)});function getLastDateOfSubscription(b){if(b.subscriptions&&b.subscriptions.data.length>0){var a;$.each(b.subscriptions.data,function(c,d){if(d.plan.id.indexOf("email")==-1){if(d.trial_end&&d.trialEnd!=null){a=d.trialEnd}else{a=d.currentPeriodEnd;var e=d.plan.id.split("-");if(e.length>0&&e[1]==24){a=a+31557600}}}});return a}return}Handlebars.registerHelper("validateSendgridWhitelabel",function(a){if(a){return"<i class='fa fa-check icon-2x' style='color:green;'></i>"}return"<i class='fa fa-times icon-2x' style='color:red;'></i>"});Handlebars.registerHelper("scope_type",function(b,a){if(b=="CONTACT"||b=="COMPANY"){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("if_equals_lowerCase",function(b,c,a){if((typeof c==="undefined")||(typeof b==="undefined")){return a.inverse(this)}if(b.toString().trim().toLowerCase()==c.toString().trim().toLowerCase()){return a.fn(this)}else{return a.inverse(this)}});Handlebars.registerHelper("if_equals_sork_key",function(b,c,a){if(b&&b.lastIndexOf("-",0)===0){b=b.substr(1)}if(b&&c&&c==b){return a.fn(this)}else{return a.inverse(this)}});Handlebars.registerHelper("if_asc_sork_key",function(b,a){if(b&&b.lastIndexOf("-",0)===0){return a.inverse(this)}else{return a.fn(this)}});Handlebars.registerHelper("affiliateCommission",function(a,b){if(!a||!b){return 0}return(((a/100)*b)/100).toFixed(2)});Handlebars.registerHelper("get_default_label",function(c,d,b){var a="admin-settings-tasks";if(d=="category"){a="admin-settings-tasks"}if(_Agile_Resources_Json[a]&&_Agile_Resources_Json[a][c]){return _Agile_Resources_Json[a][c]}else{return c}});Handlebars.registerHelper("get_widget_translation",function(c,b,a){if(!b){b="content"}var d=_agile_get_translated_val("widgets",c+"-"+b);if(!d){return c}return d});Handlebars.registerHelper("get_datasync_translation",function(b,c,a){if(!c){c="content"}return _agile_get_translated_val("prefs-data-sync",b+"-"+c)});function getTableLanguageConvertHeader(a){if(!a){return a}if(_agile_get_translated_val("contacts-view",a)){return _agile_get_translated_val("contacts-view",a)}a=ucfirst(a);if(_agile_get_translated_val("contacts-view",a)){return _agile_get_translated_val("contacts-view",a)}a=a.replace(/\w\S*/g,function(b){return b.charAt(0).toUpperCase()+b.substr(1).toLowerCase()});if(_agile_get_translated_val("contacts-view",a)){return _agile_get_translated_val("contacts-view",a)}return a}Handlebars.registerHelper("is_Particular_Domain",function(a){if(CURRENT_DOMAIN_USER.domain=="fieldglobal"){return a.fn(this)}else{return a.inverse(this)}});$(function(){Handlebars.registerHelper("checkSpamScore",function(a){if(a>5){return"danger"}else{if(a<1){return"success"}}return"info"});Handlebars.registerHelper("checkSpamScoreError",function(a){if(a>=1){return"danger"}else{if(a<=0){return"success"}}return"warning"});Handlebars.registerHelper("checkSpamMessage",function(a){if(a>5){return"Your email template needs 'Rework'"}else{if(a<1){return"Your email template looks 'Good Score'"}}return"Your email template looks 'OK'"})});Handlebars.registerHelper("is_filtered_ticket",function(a){if(Ticket_Filter_ID){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("get_ticket_filter_id",function(a){return Ticket_Filter_ID});Handlebars.registerHelper("ticket_collection_exists",function(a){if(App_Ticket_Module.ticketsCollection&&App_Ticket_Module.ticketsCollection.collection&&App_Ticket_Module.ticketsCollection.collection.length>0){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("get_ticket_id",function(b,a){return Tickets.get_next_prev_ticket_id(b)});Handlebars.registerHelper("calculate_due_date",function(c,a){var b=new Date().getTime();if(c<b){return"Overdue by "+Ticket_Utils.dateDiff(b,c)}return"Due in "+Ticket_Utils.dateDiff(b,c)});Handlebars.registerHelper("getInitials",function(b,a){return Ticket_Utils.getInitials(b)});Handlebars.registerHelper("ticket_contact_exists",function(a){if(Ticket_Utils.Current_Ticket_Contact&&!($.isEmptyObject(Ticket_Utils.Current_Ticket_Contact.toJSON()))){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("get_contact_image",function(b){if(Ticket_Utils.Current_Ticket_Contact&&!($.isEmptyObject(Ticket_Utils.Current_Ticket_Contact.toJSON()))){var g=Ticket_Utils.Current_Ticket_Contact.toJSON();var k=g.properties;var a=getPropertyValue(k,"image");if(a){return a}var j=getPropertyValue(k,"email");var f=DEFAULT_GRAVATAR_url;var i='&d=404" ';var c="";try{c=text_gravatar_initials(k)}catch(h){console.log(h)}if(c.length==0){i="&d="+DEFAULT_GRAVATAR_url+'" '}var d="";d='onLoad="image_load(this)" onError="image_error(this)"_data-name="'+c;var j=getPropertyValue(k,"email");if(j){return new Handlebars.SafeString("https://secure.gravatar.com/avatar/"+Agile_MD5(j)+".jpg?s="+b+i+d)}}return new Handlebars.SafeString("https://secure.gravatar.com/avatar/"+Agile_MD5("")+".jpg?s="+b+""+i+d)});Handlebars.registerHelper("get_due_date_badge",function(c,a){var b=new Date().getTime();if(c<b){return'<span class="label bg-danger first-letter-cap inline-block" title="Overdue by '+Ticket_Utils.dateDiff(b,c)+'">Overdue</span>'}return'<span class="label bg-light first-letter-cap inline-block">Due in '+Ticket_Utils.dateDiff(b,c)+"</span>"});Handlebars.registerHelper("get_current_ticket_filter",function(a){return Ticket_Filter_ID});Handlebars.registerHelper("contains_string",function(b,c,a){if(c.search(b)!=-1){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("array_contains",function(c,b,a){if(c.indexOf(b)!=-1){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("is_labels_collection_empty",function(a){if(!Ticket_Labels.labelsCollection||Ticket_Labels.labelsCollection.toJSON().length==0){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("selected_all_tickets",function(a){if(Ticket_Bulk_Ops.selected_all_filter_tickets){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("get_ticket_labels_from_ids",function(e,c,b){if(!Ticket_Labels.labelsCollection||!e){return}var d={};$.each(Ticket_Labels.labelsCollection.toJSON(),function(f,g){d[g.id]=g});var a=[];$.each(e,function(f,g){if(d[g]){a.push(d[g])}});c.labelsJSON=a;return b.fn(c)});Handlebars.registerHelper("get_label_from_label_id",function(d,a){if(!Ticket_Labels.labelsCollection||!d){return}for(var b=0;b<Ticket_Labels.labelsCollection.toJSON().length;b++){var c=Ticket_Labels.labelsCollection.toJSON()[b];if([c.id]==d){return c.label}}return});Handlebars.registerHelper("compile_template",function(d,c,a){var b=Handlebars.compile(d);return b(c)});Handlebars.registerHelper("get_template",function(a,c,b){return getTemplate(a,c)});Handlebars.registerHelper("is_ticket_reply_activity",function(a,b){var c=["TICKET_CREATED","TICKET_REQUESTER_REPLIED","TICKET_ASSIGNEE_REPLIED"];if(a&&$.inArray(a,c)!=-1){return b.fn(this)}return b.inverse(this)});Handlebars.registerHelper("is_ticket_requester_activity",function(a,b){var c=["TICKET_CREATED","TICKET_REQUESTER_REPLIED"];if(a&&$.inArray(a,c)!=-1){return b.fn(this)}return b.inverse(this)});Handlebars.registerHelper("is_single_row_view",function(a){if(Tickets.isSingleRowView()){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("get_status_label",function(a,b){switch(a){case"NEW":return'<span class="label label-warning cus-pad">N</span>';break;case"OPEN":return'<span class="label label-danger cus-pad">O</span>';break;case"PENDING":return'<span class="label label-info cus-pad">P</span>';break;case"CLOSED":return'<span class="label label-success cus-pad">C</span>';break}});Handlebars.registerHelper("get_palin_text_from_html",function(c,a){var b=document.createElement("DIV");b.innerHTML=c;return b.textContent||b.innerText||""});Handlebars.registerHelper("get_current_user_prefs",function(b,a){b.current_logged_in_user=CURRENT_DOMAIN_USER;return a.fn(b)});Handlebars.registerHelper("agile_compare_prefs",function(c,d,b){var a=_agile_get_prefs(c);console.log(a==d);if(a&&a==d){return b.fn(this)}return b.inverse(this)});Handlebars.registerHelper("is_lhs_filter_disabled",function(a){if(_agile_get_prefs("hide_ticket_lhs_filter")){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("is_column_selected",function(c,b){var a=CURRENT_DOMAIN_USER.helpdeskSettings.choosed_columns;if(!a||!a.length){a=["id","subject","requester_name","due_date","priority","status","assignee","group",]}if(a.indexOf(c)!=-1){return b.fn(this)}return b.inverse(this)});Handlebars.registerHelper("is_ticket_collection_available",function(a){try{if(App_Ticket_Module.ticketsCollection&&App_Ticket_Module.ticketsCollection.collection.toJSON().length>0&&App_Ticket_Module.ticketsCollection.collection.get(Current_Ticket_ID)){return a.fn(this)}}catch(b){}return a.inverse(this)});Handlebars.registerHelper("convert_to_html",function(c,a){if(!c){return""}c=c.trim();try{}catch(b){}return c});Handlebars.registerHelper("replace_newline_with_br",function(b,a){if(!b){return""}b=b.trim();b=b.replace(/(?:\r\n|\r|\n)/g,"<br />");return b});Handlebars.registerHelper("get_ticket_uri",function(b,a){if(Ticket_Filter_ID){return"#tickets/filter/"+Ticket_Filter_ID}return"#tickets"});Handlebars.registerHelper("getGravatarFromEmail",function(a,b){if(a){return"https://secure.gravatar.com/avatar/"+Agile_MD5(a)+".jpg?s="+b+"&d=404"}return"https://secure.gravatar.com/avatar/"+Agile_MD5("")+".jpg?s="+b+"&d=404"});Handlebars.registerHelper("get_current_filter_name",function(a){return Ticket_Filters.getCurrentFilterName()});Handlebars.registerHelper("get_filters_select_options",function(b){var d=App_Ticket_Module.ticketFiltersList.collection.toJSON();var a='<option value="{{id}}">{{name}}</option>',c="";d.forEach(function(e){c+=a.replace("{{id}}",e.id).replace("{{name}}",e.name)});return c});Handlebars.registerHelper("is_current_opend_ticket",function(b,a){if(b==Current_Ticket_ID){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("is_helpdesk_enabled",function(a){if(Helpdesk_Enabled){return a.fn(this)
}return a.inverse(this)});Handlebars.registerHelper("is_current_logged_in_user",function(b,a){if(CURRENT_DOMAIN_USER.id==b){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("replace_br_with_space",function(c,a){if(!c){return}var b=/<br\s*[\/]?>/gi;return c.replace(b," ")});Handlebars.registerHelper("gravatarurl",function(j,b){if(j==undefined){return}var a=getPropertyValue(j,"image");if(a){return a}var f=DEFAULT_GRAVATAR_url;var g='&d=404" ';var c="";try{c=text_gravatar_initials(j)}catch(h){console.log(h)}if(c.length==0){g="&d="+DEFAULT_GRAVATAR_url+'" '}var d="";d='onLoad="image_load(this)" onError="image_error(this)"_data-name="'+c;var i=getPropertyValue(j,"email");if(i){return new Handlebars.SafeString("https://secure.gravatar.com/avatar/"+Agile_MD5(i)+".jpg?s="+b+g+d)}return new Handlebars.SafeString("https://secure.gravatar.com/avatar/"+Agile_MD5("")+".jpg?s="+b+""+g+d)});Handlebars.registerHelper("uc_first",function(b,a){return ucfirst(b)});Handlebars.registerHelper("helpcenter_url",function(c){if(!App_Ticket_Module.sectionsCollection){return""}var e=App_Ticket_Module.sectionsCollection.collection;console.log(e);var b=e.url;var a=b.split("/");var d=a[a.length-1];return"/"+d});Handlebars.registerHelper("helpcenter_url_section",function(d){if(!App_Ticket_Module.articlesCollection){return""}var f=App_Ticket_Module.articlesCollection.collection;console.log(f);var c=f.url;var b=c.split("/");var e=b[b.length-1];var a=e.split("=");var g=a[a.length-1];return"/"+g});Handlebars.registerHelper("get_ticket_translated_text",function(c,b,a){return get_ticket_translated_text(c,b)});function get_ticket_translated_text(c,b){var a={priority:{LOW:"Low",MEDIUM:"Medium",HIGH:"High",},status:{OPEN:"Open",PENDING:"Pending",CLOSED:"Closed",},};if(a[c]&&a[c][b]){return a[c][b]}return b}Handlebars.registerHelper("epochToHumanDate",function(b,a){if(!b){b="mmm dd yyyy HH:MM:ss"}if(!a){return}if((a/100000000000)>1){return new Date(parseInt(a)).format(b,0)}return new Date(parseInt(a)*1000).format(b)});Handlebars.registerHelper("is_user_logged_in",function(a){if(IS_USER_LOGGED_IN){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("Commented_user",function(b,a){if(!b){return a.fn(this)}if(!USERINFO){return a.inverse(this)}if(b.id==USERINFO.userId){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("Admin_Commented_user",function(b,a){if(!b){return a.fn(this)}if(!USERINFO){return a.inverse(this)}if(b.id==USERINFO.userId||USERINFO.role=="ADMIN"){return a.fn(this)}return a.inverse(this)});Handlebars.registerHelper("replace_newline_with_br",function(b,a){if(!b){return""}b=b.trim();b=b.replace(/(?:\r\n|\r|\n)/g,"<br />");return b});var CONTENT_JSON={articles:{title:"You do not have any contacts currently.",description:"Contacts are your customers or prospects that you interact with using Agile.",button_text:"Add Contacts",route:"#",modal_id:"personModal",image:updateImageS3Path("/img/clipboard.png")}};var Helpcenter_Util={setBreadcrumbPath:function(b,a){if(!b){$("#breadcrumb").html("");return}$("#breadcrumb").html(getTemplate(b,a))},searchArticles:function(){if(!$("#hc_query").val()){return}App_Helpcenter.searchArticle($("#hc_query").val())}};function showTransitionBar(){if($(".butterbar").hasClass("hide")){$(".butterbar").removeClass("hide")}if(!$(".butterbar").hasClass("animation-active")){$(".butterbar").addClass("animation-active")}}function hideTransitionBar(){setTimeout(function(){if($(".butterbar").hasClass("animation-active")){$(".butterbar").removeClass("animation-active")}if(!$(".butterbar").hasClass("hide")){$(".butterbar").addClass("hide")}},10)}function trigger_tinymce_save(){return}function get_tags(){var a=[];return a}function get_notes(){var a=[];return a}function get_related_deals(){var a=[];return a}function track_with_save_success_model(){return}var LOADING_HTML='<img class="loading" style="padding-left:10px;padding-right:5px;opacity:0.5;" src= "'+updateImageS3Path("/flatfull/img/ajax-loader-cursor.gif")+'"></img>';LOADING_HTML_IMAGES=[LOADING_HTML];function getRandomLoadingImg(){var a=LOADING_HTML_IMAGES.length;return LOADING_HTML_IMAGES[Math.round(Math.random()*(LOADING_HTML_IMAGES.length-1))]}function updateImageS3Path(a){if(!a){a=""}try{if(a){a=a.replace("flatfull/","").replace(/\.{2}/g,"")}}catch(b){}if(!S3_STATIC_IMAGE_PATH){S3_STATIC_IMAGE_PATH="//doxhze3l6s7v9.cloudfront.net/beta/static/"}return(S3_STATIC_IMAGE_PATH+a)}function fill_slate(f,c,b){var e=b;if(!e){e=window.location.hash.split("#")[1]}if(CONTENT_JSON[e]){var d="",a={};if((e=="contacts")&&readCookie("company_filter")){d="empty-collection-model";a=CONTENT_JSON.companies}else{if((e=="filter_results")&&company_util.isCompany()){d="empty-collection-model";a=CONTENT_JSON.filter_results_companies}else{d="empty-collection-model";a=CONTENT_JSON[e]}}}}var App_Helpcenter;$(function(){App_Helpcenter=new HelpcenterRouter();Backbone.history.bind("all",currentRoute);Backbone.history.start()});var Current_Route;function currentRoute(a){console.timeEnd("startbackbone");Current_Route=window.location.hash.split("#")[1]};