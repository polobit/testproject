<script id="new-opportunity-header-template" type="text/html">
<div class="custom-animated custom-fadeInUp">
<div class="wrapper-md bg-light lter b-b" id="deals-milestone-view-heading">
<div class="row">
    <div class="col-md-12">
        
            <h3 class="pull-left font-thin h3">Deals <small>Opportunities</small>
			<div id="milestone-set-msg" class="alert alert-warning p-sm" role="alert" style="margin-left:100px;display:none;">
  				For better deal reports and sales forecasting, please set your 'Won' and 'Lost' milestones in the <a href="#milestones" style="font-style:italic;text-decoration: initial;color: #337ab7;">Deal settings</a> page.
			</div>
			</h3>
<div class="pull-right">
            <div class="btn-group inline-block m-l-xs" id="deals-tracks">
			</div>
			<div id="deal-list-filters" class="btn-group inline-block m-l-xs">
				 <img class="loading_img p-r-xs" height="32px" width="32px" src= "{{getS3ImagePath 'img/21-0-new.gif'}}"></img>
			</div>
			<div class="btn-group inline-block m-l-xs" id="deals-view">
					<div class="btn btn-sm btn-default"><i class="icon-list m-l-xs"></i></div>
					<a class="btn btn-sm btn-default  dropdown-toggle" data-toggle="dropdown" href="#">
						<span class="caret deals-view-caret"></span>
					</a>
					<ul class="dropdown-menu pull-right">
						<li><a href="#deal-rc-0" class="deals-list-view">List View</a></li>
						<li class="dropdown-submenu do-onclick-nothing"><a href="#deal-rc-1" data-toggle="dropdown" class="deals-pipelined-view">Milestone View</a>
							<ul class="dropdown-menu">
								<li><a href="#deal-rc-1" id="deal-milestone-regular">Relaxed</a></li>
								<li><a href="#deal-rc-2" id="deal-milestone-compact">Compact</a></li>
								<li><a href="#deal-rc-3" id="deal-milestone-fit">Fit</a></li>
							</ul>
						</li>
					</ul>
			</div>
			<div class="btn-group inline-block m-l-xs" id="deals-action">
					<a href="#deals-add" class="deals-add btn btn-sm  btn-default"><i class="icon-plus-sign" /> Add Deal
					</a>
					<a class="btn btn-sm btn-default dropdown-toggle" data-toggle="dropdown" href="#">
						<span class="caret"></span>
					</a>
					{{#hasScope "MANAGE_DEALS"}}
					<ul class="dropdown-menu pull-right">
						<li><a href="#import-deals" >Import from CSV</a></li>
						<li><a href="#" class="deals-export-csv">Export as CSV</a></li>
					</ul>
					{{/hasScope}}
					<!--
					{{#is_mobile}}

					{{else}}
					<div class="btn-group pull-left m-l-xs" style="padding-left:3px;">
						<button class="btn btn-default btn-sm m-l-sm fullscreenelement" style="height:30px;width:30px;" targetFullscreenElement="#content" >
							<i id="toggle-screen-icon" class="fa fa-expand" style="margin-right:3px"></i></button></div>

							{{/is_mobile}}
							-->
						
	  		
			</div>
			</div>
        <div class="clearfix"></div>
    </div>
</div>
</div>
<div class="wrapper-md">
<div class="row">
    <div class="col-md-12">
    	<span class="error-status text-danger"></span>
        <div id="new-opportunity-list-paging">
			 <img class="loading_img p-r-xs"  height="32px" width="32px" src= "{{getS3ImagePath 'img/21-0-new.gif'}}"></img>
			<div id="opportunities-by-milestones-model-list">
			</div>
        </div>
    </div>
</div>
</div>
<!-- Archive confirmation-->
<div id="deal_archive_confirm_modal" class="modal fade" aria-hidden="true">
	<div class="modal-dialog">
    <div class="modal-content">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3>Archive Deal</h3>
  </div>
  <div class="modal-body">
    <div id="deal-bulk-confirm">
		<input id="archived-deal-id" name="id" type="hidden" value="{{id}}" />
		<input id="archived-deal-milestone" name="milestone" type="hidden" value="{{milestone}}"/>
		Deals can be archived and will not be shown. You can view them later by selecting 'All' in the filter.  
		<br/> Are you sure to archive this deal?
	</div>
  </div>
  <div class="modal-footer">
  	<span class="error-status text-danger"></span>
	<button type="button" class="btn btn-sm btn-default" data-dismiss="modal" aria-hidden="true">No</button>
    <a href="#" id="deal-quick-archive" class="btn btn-sm btn-primary">Yes</a>
  </div>
 </div>
  </div>
</div>

<!-- Restore confirmation-->
<div id="deal_restore_confirm_modal" class="modal fade" aria-hidden="true">
	<div class="modal-dialog">
    <div class="modal-content">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3>Restore Deal</h3>
  </div>
  <div class="modal-body">
	<input id="restored-deal-id" name="id" type="hidden"/>
	<input id="restored-deal-milestone" name="milestone" type="hidden"/>
    <div id="deal-bulk-confirm">
		Restoring the Deal will make it active again. <br/> Restore this Deal?
	</div>
  </div>
  <div class="modal-footer">
  	<span class="error-status"></span>
	<button type="button" class="btn btn-sm btn-default" data-dismiss="modal" aria-hidden="true">No</button>
    <a href="#" id="deal-quick-restore" class="btn btn-sm btn-primary">Yes</a>
  </div>
	</div>
  </div>
</div>
</div>
</script>

<script id="opportunities-by-paging-collection-template" type="text/html">
<div id="opportunities-by-paging-model-list">
<div class="milestone-main"></div>
</div></script>

<script id="opportunities-by-paging-model-template" type="text/html">
	<div class='dealtitle-angular panel-heading'>
		<div class='milestone-heading text-left text-ellipsis'> <span class="miltstone-title text-base text-ellipsis inline-block v-bottom pull-left" style="width:calc(100% - 75px);">{{heading}}</span>
		    <div class="pull-right">
		    <div style="font-size:14px; float:left">
		       <input type="hidden" id="{{remove_spaces heading}}_totalvalue" name="0" />	  
			{{#if lost_milestone}}<i data-toogle="tooltip" title="" class="icon-dislike mark-lost" data-original-title="Deals with this milestone are considered as Lost." style="font-size: 14px;position: relative;top: 2px;"></i>{{/if}}
			{{#if won_milestone}}<i data-toogle="tooltip" title="" class="icon-like mark-won" data-original-title="Deals with this milestone are considered as Won." style="font-size: 14px;position: relative;top: 2px;"></i>{{/if}}

			<span id="{{remove_spaces heading}}_count" class="txt-mute badge m-t-xs"></span><span class="pull-right pos-abs pos-r-sm pos-t-xs"><img class="loading_img" src="{{getS3ImagePath '/img/ajax-loader-cursor.gif'}}" width="12px"></span> </div>
		</div></div>
		<span></span>
	</div>
	<div id="{{remove_spaces heading}}-list-container" class='milestones panel-body p-n' milestone='{{heading}}'>
		
	</div>
</script>

<script id="deals-by-paging-collection-template" type="text/html">
<ul id="deals-by-paging-model-list" class="milestones p-n">
</ul>
</script>


<script id="deals-by-paging-model-template" type="text/html">

<div id={{id}} data="{{milestone}}" class="data agile-overflow-ellipsis">
	<div>
		<span class="pull-left text-flow-ellipsis inline-block l-h-xs font-thin word-break" style="max-width: 70%;"><a href="#deal/{{id}}">{{name}}</a></span>
		
		<span class="pull-right  dealnotes-view">
			{{#if notes}}

             <span class="txt-small note-count" title="Notes" >{{notes.length}}</span><a title="Notes" data-toggle="tooltip" data-placement="top" data-trigger="hover" data-container="No Notes" class="deal-notes deal-edit c-p text-l-none"><i class="deal-action icon icon-comment-alt deal-notes" data="{{id}}"></i></a>
              
			{{/if}}
		</span>
		<div class="clearfix"></div>
	</div>
	<div class="agile-overflow-ellipsis" style="white-space:initial;">
{{#if expected_value}}
		<span>{{currencySymbol}}{{numberWithCommas expected_value}}</span>
{{/if}}
	</div>

	{{#if this.contacts}}
	<div class="agile-overflow-ellipsis" style="display:block;margin-top:0px;">
		{{#related_to_one contacts}}{{/related_to_one}}
	</div>
	{{/if}}{{#if_greater this.contacts.length "5"}}<span>,..</span>{{/if_greater}}
	<div class="pull-left">
		
        <small class="text-muted">
			{{#if close_date}}
            <i class="fa fa-clock-o m-r-xs"></i>
			{{/if}}
			<time class="deal-close-time" datetime="{{epochToHumanDate "" close_date}}" style="border-bottom:dotted 1px #999;">{{epochToHumanDate "ddd mmm dd yyyy HH:MM:ss" close_date}}</time>
		</small>
	</div>
<div class="pull-right">
<span class="right deal-options" style="visibility:hidden;">
			{{#if_equals archived false}}
			<a title="Archive" class="deal-archive" style="cursor:pointer;text-decoration:none;"> <i style="width: 0.9em!important;" class="icon-archive"></i> </a>
			{{/if_equals}}
			{{#if_equals archived true}}
			<a title="Restore" class="deal-restore" style="cursor:pointer;text-decoration:none;"> <i style="width: 0.9em!important;" class="icon-mail-reply"></i> </a>
			{{/if_equals}}
			{{#if_equals archived false}}
			<a title="Edit" class="deal-edit" style="cursor:pointer;text-decoration:none;"> <i style="width: 0.9em!important;" class="icon-pencil"></i> </a>
            {{/if_equals}}
			<a title="Delete" class="deal-delete" style="cursor:pointer;text-decoration:none;"><i style="width: 0.9em!important;" class="icon-trash"></i></a>
        </span>
</div>
<div class="clearfix"></div>
<input type="hidden" name="{{colorName}}" class="{{colorName}}"/>
</div>
</script>


<script id="deals-by-paging-relax-collection-template" type="text/html">
<ul id="deals-by-paging-relax-model-list" class="milestones p-n">
</ul>
</script>

<script id="deals-by-paging-relax-model-template" type="text/html">
<div id={{id}} data="{{milestone}}" class="data agile-overflow-ellipsis">
	<div>
		<div class="inline-block l-h-xs pull-left text-ellipsis word-break" style="max-width: 70%;"><a class="font-normal" href="#deal/{{id}}">{{name}}</a></div>
		
		<div class="pull-right dealnotes-view" style="margin-top:-3px;padding-right:1px;">
			{{#if notes}}
             <span class="txt-small note-count" title="Notes" >{{notes.length}}</span><a title="Notes" data-toggle="tooltip" data-placement="top" data-trigger="hover" data-container="No Notes" class="deal-notes deal-edit" style="cursor:pointer;text-decoration:none;"><i class="deal-action icon icon-comment-alt deal-notes" data="{{id}}"></i></a>
              
			{{/if}}
		</div>
		<div class="clearfix"></div>
	</div>
	<div class="agile-overflow-ellipsis" style="white-space:initial;">
{{#if expected_value}}
		<span>{{currencySymbol}}{{numberWithCommas expected_value}}</span>
{{/if}}

		{{#if this.contacts}}
			{{#if expected_value}}
				<span class="m-t-none m-b-none m-l-xs m-r-xs" style="border:1px solid #d5d5d5"></span>
			{{/if}}
			{{#related_to_one contacts}}{{/related_to_one}}
		{{/if}}{{#if_greater this.contacts.length "5"}}<span>,..</span>{{/if_greater}}
	</div>

	{{#if_equals pipeline.won_milestone milestone}}
		{{#if won_date}}
			<div style="cursor:default;" class="pull-left inline-block deal_won_date" id="deal_won_date_{{id}}" data-toggle="tooltip" title="Won date">
      			<small>{{epochToHumanDateInFormat won_date}}</small>
      		</div>
      		<div class="clearfix"></div>
      	{{else}}
      		{{#if milestone_changed_time}}
      			<div style="cursor:default;" class="pull-left inline-block deal_won_date" id="deal_won_date_{{id}}" data-toggle="tooltip" title="Won date">
      				<small>{{epochToHumanDateInFormat milestone_changed_time}}</small>
      			</div>
      			<div class="clearfix"></div>
      		{{else}}
      			<div style="cursor:default;" class="pull-left inline-block hide deal_won_date" id="deal_won_date_{{id}}" data-toggle="tooltip" title="Won date">
      				<small></small>
      			</div>
      			<div class="clearfix"></div>
      		{{/if}}
		{{/if}}
	{{else}}
		<div style="cursor:default;" class="pull-left inline-block hide deal_won_date" id="deal_won_date_{{id}}" data-toggle="tooltip" title="Won date">
      		<small></small>
      	</div>
      	<div class="clearfix"></div>
	{{/if_equals}}

	<div class="pull-left">
		<small class="text-muted">
			{{#if close_date}}
            <i class="fa fa-clock-o m-r-xs"></i>
			{{/if}}
			<time class="deal-close-time" datetime="{{epochToHumanDate "" close_date}}">{{epochToHumanDate "ddd mmm dd yyyy HH:MM:ss" close_date}}</time>
		</small>
	</div>
<div class="pull-right">
<span class="pull-right deal-options vis-hide">
			{{#if_equals archived false}}
			<a title="Archive" class="deal-archive c-p text-l-none" style="text-decoration:none;color:#727272;"> <i style="width: 0.9em!important;" class="icon-archive"></i> </a>
			{{/if_equals}}
			{{#if_equals archived true}}
			<a title="Restore" class="deal-restore c-p text-l-none" style="text-decoration:none;color:#727272;"> <i style="width: 0.9em!important;" class="icon-mail-reply"></i> </a>
			{{/if_equals}}
			{{#if_equals archived false}}
			<a title="Edit" class="deal-edit c-p text-l-none" style="text-decoration:none;color:#727272;"> <i style="width: 0.9em!important;" class="fa fa-pencil-square"></i> </a>
            {{/if_equals}}
			<a title="Delete" class="deal-delete c-p text-l-none" style="text-decoration:none;color:#727272;"><i style="width: 0.9em!important;" class="fa fa-trash"></i></a>
        </span>
</div>

 <div class="clearfix"></div>
 <input type="hidden" name="{{colorName}}" class="{{colorName}}"/>
</div>
</script>


<script id="related-to-contacts-template" type="text/html">
	{{#if_contact_type "PERSON"}}	
		<a class="text-info" href="#contact/{{id}}">{{getPropertyValue properties "first_name"}} {{getPropertyValue properties "last_name"}}</a>
    {{/if_contact_type}}
	{{#if_contact_type "COMPANY"}}
     	<a class="text-info" href="#company/{{id}}">{{getPropertyValue properties "name"}}</a>
    {{/if_contact_type}}
</script>
<script id="opportunity-track-list-collection-template" type="text/html">
<div class="btn-group"  id="pipeline-tour-step">
	<button class="btn btn-sm btn-default filter-dropdown "><i class="icon-road m-r-xs"/></button>
	<button class="btn btn-sm btn-default dropdown-toggle" data-toggle="dropdown">
    	<span class="caret"></span>
  	</button>
	<ul id = "opportunity-track-list-model-list" class="pull-right dropdown-menu">
	</ul>
</div>
</script>

<script id="opportunity-track-list-model-template" type="text/html">
{{#if name}}
<a id='{{id}}' class="pipeline c-p" data="{{name}}">{{name}}</a>
 {{else}}
<a id='{{id}}' class="pipeline c-p" data="Default">Default</a>
{{/if}}
</script>


<script id="deal-detail-dummy-popover-template" type="text/html">

<div id='deal_detail_popover-div' style="font-size:12px;">
    <div style="background-color:#edf1f2;font-weight:bold;max-width:100%;padding: 2px;">
    <p class="deal-popover-p" style="margin:2px;overflow:hidden !important;text-overflow: ellipsis;">
    	<span>{{heading}}</span></p>
    <p class="deal-popover-p pull-left" style="margin:2px;overflow:hidden !important;text-overflow:ellipsis;max-width:calc(100% - 35px);">
    	<span>{{heading}}</span ></p><span class="pull-right">{{dealNumber}}</span><div class="clearfix"></div>
     </div>
    <p class="deal-popover-p" style="margin:2px;margin-top:4px;"><span>Total Value:</span><span> {{symbol}}{{dealcount}}</span></p>
    <p class="deal-popover-p" style="margin:2px"><span>Avg. Value:</span><span> {{symbol}}{{avgDeal}}</span></p>
</div>
</script>

<!-- popover on deal milestone -->

<script id = "deal-detail-popover-template" type="text/html" > 
       <div class="data panel-default" style="min-width:200px;max-width:280px;">
	   
       	<div class="text-cap panel-heading text-ellipsis" style="padding:6px;"><div class="text-ellipsis inline-block" style="width:100%;" title="{{track}}"><strong>{{dealTrack}}</strong></div>
				 <div class="pull-left" style="max-width:60%;overflow:hidden !important;text-overflow: ellipsis;">{{heading}}</div>
        		<div>
	   	  <div class="unselectable m-t-n-xs" id="score" unselectable="on" onselectstart="return false">
							<div  class="text-lg score-view">
								<span class="pull-right" style="font-size:15px;">
									<span id="lead-score">{{dealNumber}}</span>
								
								</span>
							
							</div>
						</div>
						</div>
        		</div>
        		<div style="padding: 0px 5px;">
       		<div class="b-b b-light p-b-xs">
       			
       	<div class="contact-owner text-base" id="change-owner-element">
        	
		<p class="deal-popover-p" style="margin:2px;margin-top:4px;"><span>Total Value:</span><span> {{symbol}}{{dealcount}}</span></p>
       </div>
       </div>
       		<div class=" p-b-xs">
			<p class="deal-popover-p" style="margin:2px"><span>Avg. Value:</span><span> {{symbol}}{{avgDeal}}</span></p>
       		</div>
                   </div>
	   	          </div>	
</script>
<!--end popover on deal milestone-->
