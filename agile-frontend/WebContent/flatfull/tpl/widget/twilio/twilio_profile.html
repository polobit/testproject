<script id="twilio-profile-template" type="text/html">
{{#if_equals to.length "1"}}<div></div>
{{else}}
	<div class="wrapper-sm">
		<div class="row">
			{{#if_equals to.length "1"}}<div><!-- <input type="hidden" id="contact_number" value="{{to.0.value}}"/>Call {{getCurrentContactProperty "first_name"}} {{getCurrentContactProperty "last_name"}} on {{to.0.value}} --></div>
			{{else}}
			<div class="col-md-2 p-xs" valign="middle"><h4 class="h4 m-t-xs">To&nbsp;:</h4></div>
			<div class="col-md-10">
				<select name="number" id="contact_number" class="required form-control col-md-10 w-full">
					{{#each to}}
						<option value="{{value}}">{{value}} 
							{{#if subtype}}({{subtype}}){{/if}}
						</option>
					{{/each}}
				</select>
			</div>
			{{/if_equals}}
		</div>
		<div class="row-fluid">
			<a href="#call" class="btn btn-sm btn-default pull-right" id="twilio_call" style="display:none;"><i class="icon-phone"></i>{{agile_lng_translate 'admin-settings-tasks' 'call'}}</a>
			<a href="#hangup" class="btn btn-sm btn-danger pull-right" id="twilio_hangup" style="display:none;">{{agile_lng_translate 'widjets' 'hang-up'}}</a>
            <a href="#dialpad" class="btn btn-sm btn-default pull-right m-r-xs" id="twilio_dialpad" style="display:none;">{{agile_lng_translate 'other' 'dail-pad'}}</a>
			<a href="#note" class="right contact-add-note m-xs" id="twilio_note" style="display:none;">
			{{agile_lng_translate 'deal-view' 'add-note'}}</a>
		</div>


 	</div>
	<!-- <div class="sub_header">
		<h4>Call History</h4>
	</div> -->
{{/if_equals}}
	<ul id="twilio-logs-panel" class="sub_header_ul text-base">
		<li>
			<center><img id="logs_load" src="{{getS3ImagePath 'img/ajax-loader-cursor.gif'}}" class="m-t"></img></center>
		</li>
	</ul>
</script>

<script id="twilio-logs-template" type="text/html">
	{{#if this.length}}
		{{#each this}}          
			<li class="list-group-item r-none b-l-none b-r-none">
			{{#if recording.Recording}}
				{{#if_equals recording.Recording.Duration "0"}}
				<i class="icon pull-left icon-phone text-muted text-md m-r-xs m-t-xxs v-middle"></i>
				<div class="pull-left">{{#if_equals call.Status "no-answer"}}{{agile_lng_translate 'widgets' 'call-unanswered'}}{{else}}{{agile_lng_translate 'widgets' 'call-connected'}}{{/if_equals}}</div>
				<div class="pull-right">{{#is_string call.Duration}}{{toProperFormat call.Duration}}{{else}}0 s{{/is_string}}</div>
				<div class="clearfix"></div>
				<small class="text-muted"><i class="fa fa-clock-o m-r-xs pull-left m-t-xxs"></i><time class="time-ago pull-left" datetime="{{call.StartTime}}">{{toLocalTimezone call.StartTime}}</time></small>	
				{{else}}
					<div class="twilio-sound">
					<!-- <i class="icon pull-left icon-play m-r-xs m-t-xxs r" id="record_sound_play" sound_url="{{recording.Recording.Uri}}" style="color: white;background: rgba(130, 130, 130, 1);padding:1px;"></i> -->
					<div class = "text-inside-sound">
					<i class="icon pull-left icon-play m-r-xs m-t-xxs r" style="color: white;background: rgba(130, 130, 130, 1);padding:1px;"></i>
					<div class="pull-left">{{#if_equals call.Status "no-answer"}}{{agile_lng_translate 'widgets' 'call-unanswered'}}{{else}}{{agile_lng_translate 'widgets' 'call-connected'}}{{/if_equals}}</div>
					<div class="pull-right">{{#is_string call.Duration}}{{toProperFormat call.Duration}}{{else}}0 s{{/is_string}}</div>
					<div class="clearfix"></div>
					<small class="text-muted"><i class="fa fa-clock-o m-r-xs pull-left m-t-xs"></i><time class="time-ago pull-left" datetime="{{call.StartTime}}">{{toLocalTimezone call.StartTime}}</time></small>	
					
					<span class="actions text-sm options-record-twilio none" style="float: right;">
						<a title="Play" class="c-p play-twilio-record"> <i class="icon-play" style="font-size: 14px;color: green;"></i> </a>
						<a href="https://api.twilio.com{{recording.Recording.Uri}}" target="_blank" title="Download" class="c-p"> <i class="icon-download" style="font-size: 14px;color: gray;"></i> </a>
					</span>
					</div>

					<div class="none audio-inside-sound">
					<div class="pull-right close-twilio-record" style="cursor: pointer;height: 0px;position: relative;top: 5px;font-weight: bold">X</div>
					<audio id="myAudio_twilio" class = "twilio_audio" controls preload='meta' style="display: block;width: calc(94%);">
						<source src="https://api.twilio.com{{recording.Recording.Uri}}" type="audio/wav">  						
						<source src="https://api.twilio.com{{recording.Recording.Uri}}" type="audio/mpeg">
						<source src="https://api.twilio.com{{recording.Recording.Uri}}" type="audio/ogg">
  						
  						{{agile_lng_translate 'other' 'your-browser-doesnt-support-the-audio-element'}}
					</audio>
					</div>
					{{/if_equals}}			
				{{else}}
						<i class="icon pull-left icon-phone text-muted text-md m-r-xs m-t-xxs v-middle"></i>
						<div class="pull-left">{{#if_equals call.Status "no-answer"}}{{agile_lng_translate 'widgets' 'call-unanswered'}}{{else}}{{agile_lng_translate 'widgets' 'call-connected'}}{{/if_equals}}</div>
						<div class="pull-right">{{#is_string call.Duration}}{{toProperFormat call.Duration}}{{else}}0 s{{/is_string}}</div>
						<div class="clearfix"></div>
						<small class="text-muted"><i class="fa fa-clock-o m-r-xs pull-left m-t-xxs"></i><time class="time-ago pull-left" datetime="{{call.StartTime}}">{{toLocalTimezone call.StartTime}}</time></small>
				{{/if}}

				<div class="clearfix"></div>
					<div>
			</li>
		{{/each}}
	{{else}}
		<li class="p-sm r-none b-l-none b-r-none">
	    	No Calls
		</li>
	{{/if}}
</script>

 

<script id="twilio-initial-template" type="text/html" >
	<div class="widget_content b-b-none" style='line-height: 160%;' >
		<form class="b-b-none" id="twilio_call_form" name="twilio_call_form" method="post">
	    	<fieldset>
				
				<div class="control-group" ><div class="controls"><input type="text" placeholder="{{agile_lng_translate 'widjets' 'enter-number'}}" name="twilio_from" id="twilio_from" onkeydown="if (event.keyCode == 13) { event.preventDefault(); }" class="required form-control" style="width:90%" maxlength="15"/></div</div>	
				<p>
				{{agile_lng_translate 'other' 'you-will-receive-a-verification-call-asking-code'}}</p>
				<a href="#verify" id="twilio_verify" class="btn btn-sm btn-default text-l-none">
				{{agile_lng_translate 'landing-pages' 'verify'}}</a>	
			</fieldset>
	    </form>				
	</div>
</script>

<script id="twilio-verify-template" type="text/html" >
	<div class="widget_content b-b-none" style='line-height: 160%;' >
		
		<p>{{agile_lng_translate 'other' 'please-enter-this-code'}} <b>{{ValidationRequest.ValidationCode}}</b> to {{agile_lng_translate 'other' 'verify-your-number-after-you-receive-a-call-from-twilio'}}</p>
		{{#if settings}}
			<a href="#Twilio/twilio{{id}}" class="btn btn-sm btn-default text-sm" id="twilio_proceed_settings">{{agile_lng_translate 'other' 'proceed'}}</a>			
		{{else}}
			<a href="#proceed" class="btn btn-sm btn-default text-sm" id="twilio_proceed">{{agile_lng_translate 'other' 'proceed'}}</a>	
		{{/if}}	
	</div>
</script>

<script id="twilio-record-template" type="text/html">
<div id="twilio-record-modal" class="modal fade in" aria-hidden="false" style="display: block; padding-left: 17px;">
<div class="modal-backdrop fade" style="height: auto;"></div> 
 <div class="modal-dialog"> 
  <div class="modal-content"> 
	<div class="modal-header" >
    	<a href="#" data-dismiss="modal" class="close">&times;</a>
		<h3>{{agile_lng_translate 'campaigns' 'call'}} {{name}}?</h3></div>
    <div class="modal-body" >
		<p>{{agile_lng_translate 'widjets' 'make-a-call-to'}} {{to}}?</p>
        <p>
		<label class="i-checks i-checks-sm">
			<input type="checkbox" name="add-image" id="enable-record" checked="checked"/><i></i></label>
			{{agile_lng_translate 'widjets' 'record-the-call'}}
		</p>
	</div>
	<div class="modal-footer" >
		<a href="#" class="btn btn-sm btn-default close enable-call" make_call="no">{{agile_lng_translate 'portlets' 'no'}}</a>
		<a href="#" class="btn btn-sm btn-primary enable-call" make_call="yes">{{agile_lng_translate 'portlets' 'yes'}}</a>
	</div>
</div>
</div>
</div>
</script>


<script id="twilio-error-template" type="text/html">
<div class="wrapper-sm">
{{#check_length message "140"}}
	<div class="p-sm">
		<div class="ellipsis-multiline word-break text-base" title="{{message}}" style="height: 100px !important;-webkit-line-clamp: 5;line-height:160%;word-break: normal;">
			{{message}}
		</div>
	</div>
{{else}}
	<div class="word-break p-n text-base" style="line-height:160%;">
		{{{message}}}
	</div>
{{/check_length}}
</div>
</script>


<script id="twilio-login-template" type="text/html">
<div class="m-t">
	<p>{{agile_lng_translate 'twilio' 'call-your-contacts-directly-using-twilio-account'}}</p>
	<a id="twilio-connect-button" class="btn btn-sm btn-default m-b-sm m-t-sm" href="https://www.twilio.com/authorize/CNf63bca035414be121d517a116066a5f8?state={{url}}" >{{agile_lng_translate 'twilio' 'link-your-twilio'}}</a>
</div>
</script>




<script id="twilio-revoke-access-template" type="text/html">

<div class='widget_content b-b-none' style='line-height: 160%;' >
	{{#if_equals outgoing_numbers.length "0"}}
				<p>{{agile_lng_translate 'twilio' 'to-satrt-making-calls-you-need-to-verify-your-number'}}</p>
				<p class="m-t-sm m-r-none m-b-xs m-l-none">
					<a href="#" id="twilio_verify_settings">{{agile_lng_translate 'twilio' 'verify-an-outgoing-number'}}</a>
				</p>
	{{else}}
				{{#stringToJSON this "prefs"}}{{/stringToJSON}}
<form id="reportsForm">
<fieldset class="m-l-md">
		<div class="control-group m-l-n-md">
				<label class="control-label">{{agile_lng_translate 'widjets' 'current-out-going-number'}}</label>
				<div class="controls" id="contactTypeAhead">
			<select name="verified_number" id="twilio_from_number" class="required form-control col-md-12 w-full">
				{{#each outgoing_numbers}}
						{{#if_equals ../../prefs.verification_status "success"}}
								{{#if_equals PhoneNumber ../../prefs.verified_number}}
									<option selected="selected" value="{{PhoneNumber}}">{{PhoneNumber}}</option>
								{{else}}
									<option value="{{PhoneNumber}}">{{PhoneNumber}}</option>
								{{/if_equals}}
						{{else}}
							<option value="{{PhoneNumber}}">{{PhoneNumber}}</option>
						{{/if_equals}}
				{{/each}}
			</select>
			</div>
			</div>
<input value="success" name="verification_status" class="hidden"/> 
		</fieldset>
				<p class="m-t-sm m-r-none m-b-sm m-l-none">
					<a href="#" id="twilio_verify_settings">{{agile_lng_translate 'twilio' 'verify-an-outgoing-number'}}</a>
				</p>
	{{/if_equals}}
				<p class="m-t-sm m-r-none m-b-xs m-l-none text-center">
					<a class='btn btn-sm btn-primary p-xs' widget-name="Twilio" id="widget-prefs-save">
					{{agile_lng_translate 'modals' 'save'}}</a>
					<a class='btn btn-sm btn-danger revoke-widget ml_5' widget-name="Twilio">
					{{agile_lng_translate 'widgets' 'revoke-access'}}</a>
					<a href="#add-widget" class='btn btn-default btn-sm ml_5' widget-name="Twilio">
					{{agile_lng_translate 'other' 'cancel'}}</a>
				</p> 
	</div>
</form>
</div>

</script>


