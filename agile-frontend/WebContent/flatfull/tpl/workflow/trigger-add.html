<script id="trigger-add-template" type="text/html">
<div class="wrapper-md bg-light lter b-b">

  {{#if id}}
                       <h3 class="h3 font-thin">Edit Trigger</h3>
                    {{else}}
                        <h3 class="h3 font-thin"><i class="icon-plus-sign"></i> Add Trigger</h3>
                    {{/if}} 
</div>
<div class="wrapper-md">
<div class="row">
    
        <div class="col-md-9">
            <div class="panel wrapper">
                <form id="addTriggerForm" name="addTriggerForm" class="form-horizontal">
                    {{#if id}}
					   <input name="id" type="hidden" value="{{id}}" />
					{{/if}}
                    <fieldset>
                        <div class="control-group form-group">
                            <label class="control-label col-sm-4">Name 
								<span class="field_req">*</span>
							</label>
                            <div class="controls col-sm-8">
                                <input type="text" id="name" class="required form-control w-md" name="name" />
                            </div>
                        </div>
                        <div class="control-group form-group">
                            <label class="control-label col-sm-4">When this happens <span class="field_req">*</span></label>
                            <div id="LHS" name="LHS" class="col-sm-8">
                                  <div class="controls">
                                    <select id="trigger-type" name="type" class="required form-control w-md">		
 										<option></option>
                                        <optgroup label="Tag">
										<option value="TAG_IS_ADDED">Tag is added</option>
                                        <option value="TAG_IS_DELETED">Tag is deleted</option>
										<optgroup label="Contact">
                                        <option value="CONTACT_IS_ADDED">Contact is added</option>
                                        <option value="ADD_SCORE" id="add-score">Contact Score (>=)</option>
                                        <optgroup label="Deal">
                                        <option value="DEAL_IS_ADDED">Deal is added</option>
                                        <option value="DEAL_IS_DELETED">Deal is deleted</option>
                                        <option value="DEAL_MILESTONE_IS_CHANGED">Deal milestone is changed</option>
										<optgroup label="Timer">
										<option value="RUNS_DAILY">Daily</option>
                                        <option value="RUNS_WEEKLY">Weekly</option>
                                        <option value="RUNS_MONTHLY">Monthly</option>
										<optgroup label="Payments">
										<option value="STRIPE_CHARGE_EVENT" id="stripe-charge-event">Stripe Event</option>
										<optgroup label="Email Bounces">
										<option value="SOFT_BOUNCE">Soft Bounce</option>
										<option value="HARD_BOUNCE">Hard Bounce</option>
										<option value="SPAM">Spam</option>
										<optgroup label="Email Event">
										<option value="INBOUND_MAIL_EVENT" id="inbound-mail-event">New Email</option>
										<option value="EMAIL_OPENED">Email Opened</option>
										<option value="EMAIL_LINK_CLICKED">Email Link Clicked</option>
										<option value="UNSUBSCRIBED">Unsubscribed</option>
										<optgroup label="Calendar">
										<option value="EVENT_IS_ADDED">Event is added</option>
										<optgroup label="Call">
										<option value="INBOUND_CALL">Inbound Call</option>
										<option value="OUTBOUND_CALL">Outbound Call</option>
										<optgroup label="Ecommerce">
										<option value="SHOPIFY_EVENT" id="shopify-event">Shopify Event</option>
										<optgroup label="Form">
										<option value="FORM_SUBMIT" id="form-event">Form Submit</option>
									</select>
                                </div>
                            </div>
                        </div>
						
						<div class="control-group form-group" style="display:none;">
							<div class="controls col-sm-offset-4 col-sm-8">
                            <select id="contact-filter" name="contact_filter_id" class="required form-control w-md">
                                    <option value="">Select...</option>
                                </select>
							</div>
                        </div>
							
                        <div class="control-group form-group" style="display:none;">
                            <div id="RHS" name="RHS">
                                <label class="control-label TAG_IS_ADDED TAG_IS_DELETED ADD_SCORE EMAIL_OPENED col-sm-4"></label>
                                <div class="controls col-sm-8">
                                    <input type="text" value="{{custom_tags}}" id="trigger-custom-tags" name="custom_tags" class="required trigger-tags TAG_IS_ADDED TAG_IS_DELETED form-control m-b-n-xxs w-md" placeholder="Enter tag" style ="width:100%!imp" />
                                    <input type="text" placeholder="Enter Score" {{#if custom_score}} value="{{this.custom_score}}" {{/if}} id="trigger-custom-score" name="custom_score" class="ADD_SCORE required custom-value digits form-control w-md" />
                                </div>
                            </div>
                        </div>
						
						<!--Call Inbound and Outbound -->
						<div class="control-group form-group" style="display: none;">
							<div id="CALL">
								<label class="control-label INBOUND_CALL OUTBOUND_CALL"></label>
								<div class="controls col-sm-offset-4 col-sm-8">	
									<select name="call_disposition" class="required form-control w-md">
										<option value="" class="INBOUND_CALL OUTBOUND_CALL">Select call status</option>
										<option value="ALL" class="INBOUND_CALL OUTBOUND_CALL">All</option>			
										<option value="answered" class="INBOUND_CALL OUTBOUND_CALL">Answered</option>
										<!--<option value="no-answer" class="INBOUND_CALL OUTBOUND_CALL">No Answer</option>-->
										<option value="busy" class="INBOUND_CALL OUTBOUND_CALL">Busy</option>
										<option value="failed" class="OUTBOUND_CALL">Failed</option>
										<option value="voicemail" class="OUTBOUND_CALL">Voicemail</option>
									</select>
								</div>
							</div>
						</div>
                        
						<div class="control-group form-group" style="display:none;">
							<div class="controls col-sm-offset-4 col-sm-8">
                            <select id="trigger-deal-milestone" name="trigger_deal_milestone" class="required form-control w-md">
                                    <option value="">Select...</option>
                                </select>
							</div>
                        </div>
						<!-- Calendar Event -->
						 <div class="control-group form-group" style="display:none;">
							<div class="controls col-sm-offset-4 col-sm-8">
                            <select id="event-type" name="event_type" class="required form-control w-md">
									<option value="">Select Event Type</option>
                                    <option value="ANY">Any Event</option>
									<option value="WEB_APPOINTMENT">Online Appointment</option>
                                </select>
							</div>
                        </div>
						 <div class="control-group form-group" style="display:none;">
							<div class="controls col-sm-offset-4 col-sm-8">
                            <select id="event-owner-id" name="event_owner_id" class="required form-control w-md">
                                    <option value="">Select...</option>
                                </select>
							</div>
                        </div>
						<div class="control-group form-group" style="display:none;">
							<div class="controls col-sm-offset-4 col-sm-8">
							<select id="trigger-stripe-event" name="trigger_stripe_event" class="required form-control w-md">
									<option value="">Select Stripe Event</option>
									<option value="CHARGE_SUCCEEDED" id="charge-succeeded">Charge succeeded</option>
									<option value="CHARGE_FAILED" id="charge-failed">Charge failed</option>
									<option value="CHARGE_REFUNDED" id="charge-refunded">Charge refunded</option>
									<option value="CHARGE_CAPTURED" id="charge-captured">Charge captured</option>
									<option value="CHARGE_UPDATED" id="charge-updated">Charge updated</option>
									<option value="CUSTOMER_DELETED" id="customer-deleted">Customer deleted</option>
							</select>
							<div class="m-t-xs">
							<small>You need to <a href="https://stripe.com/docs/webhooks#configuring-your-webhook-settings" target="_blank" class="text-info">setup webhooks</a> in your stripe account for this</small>
							</div>
							</div>
						</div>
                        <!--Email Clicked and Opened-->
						<div class="control-group form-group" style="display:none;">
							<div class="controls col-sm-offset-4 col-sm-8">
									<select id="email-tracking-type" name="email_tracking_type" class="required form-control w-md">
										<option value="ANY">Personal or Campaign emails</option>
										<option value="PERSONAL">Personal emails only</option>
										<option value="CAMPAIGNS">Campaign emails only</option>
									</select>
							</div>
						</div>
						<div class="control-group form-group" style="display:none;">
                            <label class="control-label col-sm-4" ></label>
                            <div class="controls col-sm-8">
                                <select id="email-tracking-campaign-id" name="email_tracking_campaign_id" class="required form-control w-md">
                                    <option value="">Select...</option>
                                </select>
                            </div>
                        </div>
						 <div class="control-group form-group" style="display:none;">
                            <div>
                                <label class="control-label col-sm-4"></label>
                                <div class="controls col-sm-8">
                                    <input type="text" id="custom-link-clicked" value="{{custom_link_clicked}}" name="custom_link_clicked" class="required EMAIL_LINK_CLICKED form-control m-b-n-xxs w-md" placeholder="Link URL contains" />
                                </div>
                            </div>
                        </div>
						<div class="control-group form-group" style="display:none;">
							<div class="controls col-sm-offset-4 col-sm-8">
							<select id="trigger-shopify-event" name="trigger_shopify_event" class="required form-control w-md">
									<option value="">Select Shopify Event</option>
									<option value="CUSTOMERS_CREATE">Customer created</option>
									<option value="CUSTOMERS_UPDATE">Customer updated</option>
									<option value="ORDERS_CREATE">Order created</option>
									<option value="ORDERS_UPDATED">Order updated</option>
									<option value="ORDERS_PAID">Order payment</option>
									<option value="ORDERS_DELETE">Order deleted</option>
									<option value="ORDERS_FULFILLED">Order fulfilled</option>
									<option value="ORDERS_CANCELLED">Order cancelled</option>
									<option value="CHECKOUTS_CREATE">Checkout created</option>
									<option value="CHECKOUTS_UPDATE">Checkout updated</option>
									<option value="CHECKOUTS_DELETE">Checkout deleted</option>
							</select>
							<div class="m-t">
								<small><i class="icon-info-sign"></i> You need to setup Webhooks in your Shopify account for this. In your stores Admin panel, go to Settings, Notifications, Webhooks, and create a webhook for the desired event with the below URL. <br> <a class="inbound-help-text">{{shopifyWebhook}}</a></small>
							</div>
							</div>	
						</div>
						<div class="control-group form-group" style="display:none;">
							<div class="controls col-sm-offset-4 col-sm-8">
							<select id="trigger-form-event" name="trigger_form_event" class="required form-control w-md">
								<option value="">Select...</option>
							</select>
							</div>
						</div>
						<div id="trigger-inbound-mail-event" style="display:none;">
						<div class="control-group form-group">
							<div class="controls col-sm-offset-4 col-sm-8">
								<small><i class="icon-info-sign"></i> For Agile CRM to recognize your emails, please setup <a class="inbound-help-text">{{inboundMail}}</a> as forwarding email at your email server. When there is a new email to this address, the From address will be added to your Contacts and to the Campaign (in case it is a new Contact).</small>								
							</div>
                		</div>
						</div>
                       <div id="trigger-run-on-new-contacts" style="display:none;">
							<div class="control-group form-group">
								<div class="controls col-sm-offset-4 col-sm-8">
                                <div class="checkbox">
                              <label class="i-checks i-checks-sm">
                               <input type="checkbox"  name="trigger_run_on_new_contacts"><i></i>
	                            Run only on new Contacts</label>
                               </div>
								</div>
							</div>
						</div>
						<div id="new-mail-trigger-run-on-new-contacts" style="display:none;">
							<div class="control-group form-group">
								<div class="controls col-sm-offset-4 col-sm-8">
                                <div class="checkbox">
                                 <label class="i-checks i-checks-sm">
									<input type="checkbox"  name="new_email_trigger_run_on_new_contacts" checked="true"><i></i>
									Run only for new Contacts</label>
                                  </div>
								</div>
							</div>
						</div>
                        <div id="trigger-filter-condition" style="display:none;"></div>
                        <div class="control-group form-group">
                            <label class="control-label col-sm-4">Run this Campaign on the Contact <span class="field_req">*</span></label>
                            <div class="controls col-sm-8">
                                <select id="campaign-select" name="campaign_id" class="required form-control w-md">
                                    <option value="">Select...</option>
                                </select>
                            </div>
                        </div>
						<div class="line line-bg b-b"></div>
                        <div class="form-actions col-sm-offset-4 col-sm-8">          							
                            <a href="#triggers" id="trigger-save" class="save btn btn-sm btn-primary">Save</a>
							<a href="#" id="trigger-cancel" class="btn btn-default btn-sm">Cancel</a>
                        </div>
                    </fieldset>
                </form>
            </div>
        </div>
        <div class="col-md-3">
            <div class="wrapper">
                <h4 class="m-t-none font-thin">
                    Triggers
                </h4>
                
                <p> Give your trigger a name and choose a condition to be satisfied. Immediately link your trigger to the appropriate campaign, for an action to follow.</p>
            </div>
        </div>
    </div>
</div>
</script>