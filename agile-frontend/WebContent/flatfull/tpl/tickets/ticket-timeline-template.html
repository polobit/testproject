<script id="ticket-timeline-template" type="text/html">

<div class="ticket-timeline-container bg-light lter m-t-md m-b-md"> 
     
    <div class="m-b b-l m-l-md streamline">

    	{{#each this}} 

    		{{#get_template "ticket-model-timeline" this}}{{/get_template}}

    	{{/each}}

    </div>

</div>

</script>                    
<script id="ticket-model-timeline-template" type="text/html">

    		{{#is_ticket_reply_activity activity_type}}

    			<div class="comment">

			        <a class="pull-left thumb-small m-l-n">

			        	{{#if_equals activity_type 'TICKET_CREATED'}}

			        		<img src="{{get_contact_image 24}}" class="r-5x" alt="..." onerror="image_error(this);" _data-name="{{requester_name}}">
		
			        	{{/if_equals}}

			        	{{#if_equals activity_type 'TICKET_REQUESTER_REPLIED'}}
			        			<img src="{{get_contact_image 24}}" class="r-5x" alt="..." onerror="image_error(this);" _data-name="{{requester_name}}">
		
			        	{{/if_equals}}

			        	{{#if_equals activity_type 'TICKET_ASSIGNEE_REPLIED'}}
			        		<img class="r-5x" src="{{#if domainUser.pic}}{{domainUser.pic}}{{else}}flatfull/images/flatfull/user-default.jpg{{/if}}" data-toggle="tooltip" data-placement="top" data-original-title="{{domainUser.name}}"/>
			        	{{/if_equals}}

			        </a>  
			        <div class="m-l-lg panel b-a bg-f6f8f8">
			          <div class="panel-heading pos-rlt b-b b-light">
			            <span class="arrow left arrow-light arrow-light lter"></span>

			            <span class="text-muted m-l-sm pull-right">
			                <i class="fa fa-clock-o"></i>
			            	<time class="b-b-dotted" datetime="{{epochToHumanDate "" time}}">
			              		{{epochToHumanDate "ddd mmm dd yyyy HH:MM" time}}
			              	</time>
			            </span>

			            <a href="javascript:;">

			           	 {{#if_equals activity_type 'TICKET_ASSIGNEE_REPLIED'}}
				            <span class="inline-block">{{user_name}}</span> {{agile_lng_translate 'tickets' 'replied-to-ticket'}}
				         {{/if_equals}}

				         {{#if_equals activity_type 'TICKET_REQUESTER_REPLIED'}}
				            <span class="inline-block">
					            {{#if contact}}
					                {{getPropertyValue contact.properties "first_name"}} 
					                    {{getPropertyValue contact.properties "last_name"}}
					                 {{else}}
					                    {{agile_lng_translate 'tickets' 'requester'}}
					                {{/if}}
					        </span> {{agile_lng_translate 'tickets' 'replied-to-ticket'}}
				         {{/if_equals}}

				         {{#if_equals activity_type 'TICKET_CREATED'}}
				    		{{agile_lng_translate 'contact-details' 'ticket-created'}}
				    	 {{/if_equals}}
			            </a>
			          </div>
			          
			          <div class="panel-body">
			          	<div class="word-break-full word-break-all" style="word-break:break-word;">
			          		{{#if_equals activity_type 'TICKET_CREATED'}}
			          		
			          			{{#if custom2}}
					  				{{{replace_newline_with_ticket_br custom2}}}
								{{/if}}
			          		{{else}}
					    		{{#if custom1}}
				  					{{{replace_newline_with_ticket_br custom1}}}
					  			{{else}}
						  			<iframe id="ticket_comment_frame" width="100%" height="20px" scrolling="no" frameborder="0" style="border:none" src="about:blank" srcdoc="{{custom2}}" onload="Tickets.updateIframeHeight(this);">
									</iframe >
								{{/if}}
					    	{{/if_equals}}
			          	</div>
			          </div>
			          
			      </div>

	        </div>


	        {{else}}

	        	<div class="{{#if_equals activity_type 'TICKET_PRIVATE_NOTES_ADD'}}comment{{else}}activity{{/if_equals}} m-l-lg">

			        <a class="pull-left thumb-small m-l-n-md">

		        		<img class="r-5x" src="{{#if domainUser.pic}}{{domainUser.pic}}{{else}}flatfull/images/flatfull/user-default.jpg{{/if}}" data-toggle="tooltip" data-placement="top" data-original-title="{{domainUser.name}}"/>
			        	
			        </a>  
			        <div class="m-l-lg panel b-a {{#if_equals activity_type 'TICKET_PRIVATE_NOTES_ADD'}}bg-lightyellow{{/if_equals}} ">
			          <div class="panel-heading pos-rlt b-b b-light ">
			            <span class="arrow left {{#if_equals activity_type 'TICKET_PRIVATE_NOTES_ADD'}}arrow-lightyellow{{/if_equals}} "></span>

			            <span class="text-muted m-l-sm pull-right">
			                <i class="fa fa-clock-o"></i>
			            	<time class="b-b-dotted" datetime="{{epochToHumanDate "" time}}">
			              		{{epochToHumanDate "ddd mmm dd yyyy HH:MM" time}}
			              	</time>
			            </span>
			            <a href="javascript:;">

			               {{#if_equals activity_type 'TICKET_ASSIGNED'}}
						        {{agile_lng_translate 'tickets' 'ticket-assigned-to'}} <span>{{custom2}}</span>
						    {{/if_equals}}

						    {{#if_equals activity_type 'TICKET_ASSIGNEE_CHANGED'}}
				            	{{agile_lng_translate 'tickets' 'ticket-assignee-changed-to'}} 
				            	<span>{{custom2}}</span>
						    {{/if_equals}}

						    {{#if_equals activity_type 'TICKET_GROUP_CHANGED'}}
					                {{agile_lng_translate 'tickets' 'ticket-group-changed-to'}} 
					                <span>{{custom2}}</span>
						    {{/if_equals}}

						    {{#if_equals activity_type 'TICKET_STATUS_CHANGE'}}
			                    {{agile_lng_translate 'tickets' 'status-changed-from'}} {{uc_first custom1}} {{agile_lng_translate 'contacts-view' 'to'}} {{uc_first custom2}}
			                {{/if_equals}}

			                {{#if_equals activity_type 'TICKET_PRIORITY_CHANGE'}}
		                       {{agile_lng_translate 'tickets' 'priority-changed-from'}} <span class="first-letter-cap inline-block">{{custom1}}</span> {{agile_lng_translate 'contacts-view' 'to'}} <span class="first-letter-cap inline-block">{{custom2}}</span>
		                    {{/if_equals}}

						    {{#if_equals activity_type 'TICKET_TYPE_CHANGE'}}
		                        {{agile_lng_translate 'tickets' 'type-changed-from'}} <span class="first-letter-cap inline-block">{{custom1}}</span> {{agile_lng_translate 'contacts-view' 'to'}} <span class="first-letter-cap inline-block">{{custom2}}</span>
		                     {{/if_equals}}
						                        
		                    {{#if_equals activity_type 'TICKET_LABEL_ADD'}}
		                        {{agile_lng_translate 'campaigns' 'label-added'}} - <label class="label bg-success m-l-xs">{{custom2}}</label>
		                     {{/if_equals}}

		                    {{#if_equals activity_type 'TICKET_LABEL_REMOVE'}}
		                        {{agile_lng_translate 'tickets' 'label-removed'}} - <label class="label bg-info m-l-xs">{{custom2}}</label>
		                     {{/if_equals}}

		                     {{#if_equals activity_type 'TICKET_CC_EMAIL_ADD'}}
		                        {{agile_lng_translate 'tickets' 'cc-email-added'}} - <label class="label bg-success m-l-xs">{{custom2}}</label>
		                     {{/if_equals}}

		                    {{#if_equals activity_type 'TICKET_CC_EMAIL_REMOVE'}}
		                        {{agile_lng_translate 'tickets' 'cc-email-removed'}} - <label class="label bg-info m-l-xs">{{custom2}}</label>
		                     {{/if_equals}}


		                    {{#if_equals activity_type 'TICKET_PRIVATE_NOTES_ADD'}}
		                        <span>{{domainUser.name}}</span>  {{agile_lng_translate 'tickets' 'added-a-note'}}
		                    {{/if_equals}}

		                    {{#if_equals activity_type 'TICKET_MARKED_FAVORITE'}}
		                    	<!-- <span class="first-letter-cap inline-block">{{domainUser.name}}</span>--> 
		                        {{agile_lng_translate 'contacts-view' 'marked-as-favorite'}}
		                    {{/if_equals}}

		                    {{#if_equals activity_type 'TICKET_MARKED_UNFAVORITE'}}
		                        <!-- <span class="first-letter-cap inline-block">{{domainUser.name}}</span>-->
		                        {{agile_lng_translate 'contacts-view' 'marked-as-unfavorite'}}
		                    {{/if_equals}}

		                    {{#if_equals activity_type 'TICKET_MARKED_SPAM'}}
		                        <!--<span class="first-letter-cap inline-block">{{domainUser.name}}</span>-->
		                        {{agile_lng_translate 'contacts-view' 'marked-as-spam'}}
		                    {{/if_equals}}

		                    {{#if_equals activity_type 'TICKET_MARKED_UNSPAM'}}
		                        <!--<span class="first-letter-cap inline-block">{{domainUser.name}}</span>-->
		                        Marked as Unspam
		                    {{/if_equals}}
		                    {{#if_equals activity_type 'SET_DUE_DATE'}}
		                        <!--<span class="first-letter-cap inline-block">{{domainUser.name}}</span>-->
		                        {{agile_lng_translate 'tickets' 'due-date-set-to'}} {{epochToHumanDate "mmm dd, yyyy HH:MM" custom2}}
		                    {{/if_equals}}
		                    {{#if_equals activity_type 'DUE_DATE_CHANGED'}}
		                        <!--<span class="first-letter-cap inline-block">{{domainUser.name}}</span>-->
		                        {{agile_lng_translate 'tickets' 'changed-due-date-to'}} {{epochToHumanDate "mmm dd, yyyy HH:MM" custom2}}
		                    {{/if_equals}}
		                    {{#if_equals activity_type 'DUE_DATE_REMOVED'}}
		                        <!--<span class="first-letter-cap inline-block">{{domainUser.name}}</span>-->
		                        {{agile_lng_translate 'tickets' 'due-date-removed'}}
		                    {{/if_equals}}
		                    {{#if_equals activity_type 'TICKET_NOTES_FORWARD'}}
		                       {{agile_lng_translate 'tickets' 'ticket-has-been-forwarded-to'}} {{custom2}}
		                    {{/if_equals}}
				        </a>
			          </div>
			          
			          {{#if_equals activity_type 'TICKET_PRIVATE_NOTES_ADD'}}
			          <div class="panel-body">
			          	<div class="word-break-full word-break-all" style="word-break:break-word;">
			          		{{#if custom1}}
				  				{{{replace_newline_with_ticket_br custom1}}}
				  			{{else}}
				  			<iframe id="ticket_comment_frame" width="100%" height="20px" scrolling="no" frameborder="0" style="border:none" src="about:blank" srcdoc="{{custom2}}" onload="Tickets.updateIframeHeight(this);">
							</iframe >
							{{/if}}
						</div>
			          </div>
			          {{/if_equals}}
			      </div>
	        </div>

    		{{/is_ticket_reply_activity}}

</script>                    