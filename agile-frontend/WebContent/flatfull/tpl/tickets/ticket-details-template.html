<script id="ticket-details-template" type="text/html">
<div class="wrapper bg-light lter b-b">
    <a class="btn btn-sm btn-default w-xxs m-r-sm back-to-tickets" data-toggle="tooltip" data-placement="bottom" data-original-title="Back to Tickets" href="javascript:void(0);"><i class="fa fa-long-arrow-left"></i></a>

    <!-- Tickets navigation -->
    <div class="btn-group pull-right m-l-xs">
      {{#ticket_collection_exists}}
        <a href="{{#is_filtered_ticket}}
                    #tickets/filter/{{#get_ticket_filter_id}}{{/get_ticket_filter_id}}/ticket/{{#next_prev_ticket_exists 'previous'}}{{get_ticket_id 'previous'}}{{/next_prev_ticket_exists}}
                {{else}}
                  #tickets/group/{{groupID}}/{{toLowerCase status}}/{{#next_prev_ticket_exists 'previous'}}{{get_ticket_id 'previous'}}{{/next_prev_ticket_exists}}
                {{/is_filtered_ticket}}"
            class="btn btn-sm btn-bg btn-default 
            {{#next_prev_ticket_exists 'previous'}}{{else}}disabled{{/next_prev_ticket_exists}}" data-toggle="tooltip" data-placement="bottom" data-original-title="Previous"><i class="fa fa-chevron-left"></i>
        </a>
        <a href="{{#is_filtered_ticket}}
                    #tickets/filter/{{#get_ticket_filter_id}}{{/get_ticket_filter_id}}/ticket/{{#next_prev_ticket_exists 'next'}}{{get_ticket_id 'next'}}{{/next_prev_ticket_exists}}
                  {{else}}
                    #tickets/group/{{groupID}}/{{toLowerCase status}}/{{#next_prev_ticket_exists 'next'}}{{get_ticket_id 'next'}}{{/next_prev_ticket_exists}}
                  {{/is_filtered_ticket}}" 
            class="btn btn-sm btn-bg btn-default {{#next_prev_ticket_exists 'next'}}{{else}}disabled{{/next_prev_ticket_exists}}" data-toggle="tooltip" data-placement="bottom" data-original-title="Next"><i class="fa fa-chevron-right"></i>
        </a>
      {{/ticket_collection_exists}} 
    </div>

    <!-- Toolbar menu -->
    <div class="btn-group pos-stc">
      <button class="btn btn-sm btn-default w-xxs w-auto-xs delete-ticket" data-toggle="tooltip" data-placement="bottom" data-original-title="Delete Ticket"><i class="fa fa-trash-o"></i></button>
      <div class="btn-group dropdown">
        <button class="btn btn-sm btn-default w-xxs w-auto-xs dropdown-toggle" data-toggle="tooltip" data-placement="bottom" data-original-title="Macros"><i class="fa fa-sitemap"></i></button>
      </div>
    </div>

</div>
<div class="row">
  <div class="col-md-8 p-r-none b-r">
    <div class="wrapper">
      <h2 class="font-thin m-n ng-binding">{{subject}}</h2>
    </div>
    <div id="notes-collection-container">
      Loading...
    </div>
    <div class="wrapper">
        <div class="panel b-a">
          <div id="send-reply-container" class="panel-heading" aria-hidden="false">
            <div class="m-b-lg">
              Click here to 
              <a href="javascript:void(0);" class="text-u-l reply-btn" tabindex="0">Reply</a> or 
              <a href="javascript:void(0);" class="text-u-l" tabindex="0">Forward</a>
            </div>
          </div>
          <div id="reply-editor">
              
          </div>
        </div>  
    </div>
  </div>
  <div class="col-md-4 p-l-none bg-white b-b" style="min-height: calc(100vh - 110px);">
    <div class="nav-tabs-alt">
      <ul class="nav nav-tabs" role="tablist">
        <li class="active">
          <a data-target="#tab-1" role="tab" data-toggle="tab" aria-expanded="true">
            Details
          </a>
        </li>
        <li>
          <a data-target="#tab-2" role="tab" data-toggle="tab" aria-expanded="false">
            Timeline
          </a>
        </li>
        <li>
          <a data-target="#tab-3" role="tab" data-toggle="tab" aria-expanded="false">
            Widgets
          </a>
        </li>
      </ul>
    </div>
    <div class="tab-content">
      <div role="tabpanel" class="tab-pane active" id="tab-1">
        <div class="wrapper-md p-b-none">
          <table style="width: 100%;">
              <tr>
                  <td class="p-t-xs p-b-xs">Ticket #</td>
                  <td class="p-t-xs p-b-xs">{{short_id}}</td>
              </tr>
              <tr>
                  <td class="p-t-xs p-b-xs">Status</td>
                  <td class="p-t-xs p-b-xs first-letter-cap">{{status}}</td>
              </tr>
              <tr>
                  <td class="p-t-xs p-b-xs">Group</td>
                  <td id="group-id" class="p-t-xs p-b-xs" data-id="{{groupID}}">
                    <div class="group_name ticket_group_name ticket-details-value first-letter-cap">{{group.group_name}}</div>
                    <div class="dropdown ticket-details-dropdown" id="change-ticket-group-ul" style="display: none;">
                      <div class="btn-group">
                        <div class="btn btn-default btn-xs custom_view first-letter-cap">Change Group</div>
                        <a class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" aria-expanded="false"> 
                          <span class="caret"></span>
                        </a>
                        <ul id="ticket-groups-list" class="dropdown-menu pull-right">
                        </ul>
                      </div>
                    </div>
                  </td>
              </tr>
              <tr>
                  <td class="p-t-xs p-b-xs">Assignee</td>
                  <td id="assignee-id" class="p-t-xs p-b-xs" data-id="{{#if assigneeID}}{{assigneeID}}{{/if}}">
                    <div class="assignee_name ticket_assignee_name ticket-details-value first-letter-cap">
                      {{#if assigneeID}}{{assignee.name}}{{else}}-{{/if}}
                    </div>
                    <div class="dropdown ticket-details-dropdown" id="change-ticket-assignee-ul" style="display: none;">
                      <div class="btn-group">
                        <div class="btn btn-default btn-xs custom_view first-letter-cap">
                          Change Assignee
                        </div>
                        <a class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" aria-expanded="false"> 
                          <span class="caret"></span>
                        </a>
                        <ul id="ticket-assignee-list" class="dropdown-menu pull-right">
                        </ul>
                      </div>
                    </div>
                  </td>
              </tr>
              <tr>
                  <td class="p-t-xs p-b-xs">Type</td>
                  <td class="p-t-xs p-b-xs">
                    <div class="ticket_type ticket-details-value first-letter-cap">{{type}}</div>
                    <div class="dropdown ticket-details-dropdown" id="change-ticket-type-ul" style="display: none;">
                      <div class="btn-group">
                        <div class="btn btn-default btn-xs custom_view first-letter-cap">Change Type</div>
                        <a class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" aria-expanded="false"> 
                          <span class="caret"></span>
                        </a>
                        <ul id="ticket-type-list" class="dropdown-menu pull-right">
                            <li><a class="change-ticket-type-li" data-value="PROBLEM">Problem</a></li>
                            <li><a class="change-ticket-type-li" data-value="QUESTION">Question</a></li>
                            <li><a class="change-ticket-type-li" data-value="INCIDENT">Incident</a></li>
                            <li><a class="change-ticket-type-li" data-value="TASK">Task</a></li>
                        </ul>
                      </div>
                    </div>
                  </td>  
              </tr>
              <tr>
                  <td class="p-t-xs p-b-xs">Priority</td>
                  <td class="p-t-xs p-b-xs">
                    <div class="ticket_priority ticket-details-value first-letter-cap">{{priority}}</div>
                    <div class="dropdown ticket-details-dropdown" id="change-ticket-priority-ul" style="display: none;">
                      <div class="btn-group">
                        <div class="btn btn-default btn-xs custom_view first-letter-cap">Change Priority</div>
                        <a class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" aria-expanded="false"> 
                          <span class="caret"></span>
                        </a>
                        <ul id="ticket-priority-list" class="dropdown-menu pull-right">
                            <li><a class="change-ticket-priority-li" data-value="LOW">Low</a></li>
                            <li><a class="change-ticket-priority-li" data-value="MEDIUM">Medium</a></li>
                            <li><a class="change-ticket-priority-li" data-value="HIGH">High</a></li>
                        </ul>
                      </div>
                    </div>
                  </td>
              </tr>
              <tr>
                  <td class="p-t-xs p-b-xs">Created</td>
                  <td class="p-t-xs p-b-xs">{{epochToHumanDate "dd mmm yyyy HH:MM" created_time}}</td>
              </tr>
              <tr>
                  <td class="p-t-xs p-b-xs">Last Updated</td>
                  <td class="p-t-xs p-b-xs">{{epochToHumanDate "dd mmm yyyy HH:MM" last_updated_time}}</td>
              </tr>
              <tr>
                  <td class="p-t-xs p-b-xs">Last Updated By</td>
                  <td class="p-t-xs p-b-xs first-letter-cap">{{last_updated_by}}</td>
              </tr>
              <tr>
                  <td class="p-t-xs p-b-xs">Contact URL</td>
                  <td class="p-t-xs p-b-xs">
                    <a href="https://{{get_current_domain}}.agilecrm.com/#contact/{{contactID}}">Click Here</a>
                  </td>
              </tr>
          </table>
        </div><hr class="m-l m-r m-t-sm m-b-sm"/>
        <div class="wrapper-md p-t-none">
          <ul id="ticket-tags-ul" name="tags" class="inline v-top m-b-sm p-n tags">
              {{#each tags}}
                <li class="tag btn btn-xs btn-default m-r-xs m-b-xs inline-block" data="{{this.tag}}">
                  <span>
                    <a class="anchor m-r-xs" href="javascript:void(0);">{{this.tag}}</a>
                    <a class="close remove-ticket-tags text-lg" tag="{{this.tag}}">&times</a>
                  </span>
                </li>
              {{/each}}  
          </ul>
          <div class="inline-block m-t-xs">
            <div class="add-tags-form" class="m-b-none" style="display: none;">
              <div class="control-group m-b-none">
                <input type="text" class="input-sm ticket-tags-typeahead ignore-comma-keydown form-control inline-block" style="width: 60%" placeholder="Enter tag">
                <span>
              </div>
            </div>
            <a href="javascript:void(0);" id="show-tags-field" rel="tooltip" data-original-title="addtag" 
              data-placement="top" class="p-t-sm p-b-sm text-xs text-muted show-tags-field">
              <i class="icon-plus"></i>
              <span>Add Tag</span>
            </a>
          </div>
        </div>
      </div>
      <div role="tabpanel" class="tab-pane" id="tab-2">
        <div class="wrapper-md">
            <div class="streamline b-l m-b">
              <div class="sl-item">
                <div class="m-l">
                  <div class="text-muted">5 minutes ago</div>
                  <p><a href="" class="text-info">Jessi</a> commented your post.</p>
                </div>
              </div>
              <div class="sl-item">
                <div class="m-l">
                  <div class="text-muted">11:30</div>
                  <p>Join comference</p>
                </div>
              </div>
              <div class="sl-item b-success b-l">
                <div class="m-l">
                  <div class="text-muted">10:30</div>
                  <p>Call to customer <a href="" class="text-info">Jacob</a> and discuss the detail.</p>
                </div>
              </div>
              <div class="bg-info wrapper-sm m-l-n m-r-n m-b r r-2x">
                Create tasks for the team
              </div>
              <div class="sl-item b-primary b-l">
                <div class="m-l">
                  <div class="text-muted">Wed, 25 Mar</div>
                  <p>Finished task <a href="" class="text-info">Testing</a>.</p>
                </div>
              </div>
              <div class="sl-item b-warning b-l">
                <div class="m-l">
                  <div class="text-muted">Thu, 10 Mar</div>
                  <p>Trip to the moon</p>
                </div>
              </div>
              <div class="sl-item b-info b-l">
                <div class="m-l">
                  <div class="text-muted">Sat, 5 Mar</div>
                  <p>Prepare for presentation</p>
                </div>
              </div>
              <div class="sl-item b-l">
                <div class="m-l">
                  <div class="text-muted">Sun, 11 Feb</div>
                  <p><a href="" class="text-info">Jessi</a> assign you a task <a href="" class="text-info">Mockup Design</a>.</p>
                </div>
              </div>
              <div class="sl-item b-l">
                <div class="m-l">
                  <div class="text-muted">Thu, 17 Jan</div>
                  <p>Follow up to close deal</p>
                </div>
              </div>
            </div>
        </div>
      </div>
      <div role="tabpanel" class="tab-pane" id="tab-3">
        <div class="wrapper-md">
          <div class="text-base text-center p-t-sm">
              Try some widgets
            </div>
            <div class="wrapper-sm text-xs text-center p-t-xs">     
              <p>Engage more with your contacts by adding widgets like ClickDesk, Zendesk, FreshBooks, and many more...</p>
              <div class="clearfix"></div>    
              <div align="center">  
              <a class="btn btn-sm btn-success m-t-none " href="#add-widget">Add Widgets</a>
              </div>
              <div class="clearfix"></div>
            </div>
        </div>
      </div>
    </div>
  </div>
</div> 
</script>
<script  id="create-ticket-notes-template" type="text/html">
  <form name="send-reply" id="send-reply" onsubmit="return false;">
    <input type="hidden" name="ticket_id" value="{{id}}">
    <input type="hidden" name="attachment_urls" value=",">

    <div class="panel-heading b-b b-light to-emails">
      {{requester_email}}{{#if cc_emails}},{{cc_emails}}{{/if}}
    </div>
    <div class="panel-heading ticket-email p-b-none" style="display: none;">
      <span class="text-muted">To</span>&nbsp;&nbsp; {{requester_email}}
    </div>
    <div class="panel-heading ticket-email b-b b-light p-t-xs p-b-xs" style="display: none;">
      <div class="text-muted inline-block v-top">Cc</div>&nbsp;&nbsp;
      <div class="inline-block v-top" style="width: 95%;">
        <ul name="cc_emails" class="m-n p-n">
            {{#each cc_emails}}
              <li class="tag btn btn-xs btn-default m-r-xs m-b-xs inline-block" data="{{this}}">
                <span>
                  <a class="m-r-xs" href="javascript:void(0);" >{{this}}</a>
                  <a class="close remove-ticket-tags text-lg">&times</a>
                </span>
              </li>
            {{/each}}
            <li class="tag m-r-xs m-b-xs inline-block">
              <input type="text" placeholder="Cc Emails" id="cc_email_field" style="border: none; width: 9em !important;">
            </li>
        </ul>
      </div>  
    </div>
    <div class="wrapper" contenteditable="true" data-name="html_text" style="min-height:130px">
    </div>
    <div class="panel-footer bg-light lt">
      <a href="javascript:void(0);" class="btn btn-link pull-right discard-reply">
        <i  data-toggle="tooltip" data-placement="top" data-original-title="Discard" class="fa fa-trash-o"></i>
      </a>
      <a href="javascript:void(0);" class="btn btn-info btn-sm send-reply" data-loading-text='Send Reply'>Send Reply</a>
      <a href="javascript:void(0);" class="btn btn-primary btn-sm m-l-xs send-reply private" data-loading-text='Add Note'>Add Note</a>
      <a href="javascript:void(0);" class="btn btn-default btn-sm m-l-xs">
        <i class="fa fa-paperclip" data-toggle="tooltip" data-placement="top" data-original-title="Attachments"></i>
      </a>
      <a href="javascript:void(0);" class="btn btn-default btn-sm m-l-xs">
        <i  data-toggle="tooltip" data-placement="top" data-original-title="Canned Responses" class="fa fa-reorder"></i>
      </a>
    </div>
  </form>
</script>