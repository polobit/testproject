<script id="ticket-details-container-template" type="text/html">

</script>
<script id="ticket-details-template" type="text/html">
<div id="contact-dtl" class="app-content-full  h-full dock-view-fixing">
  <div class="hbox hbox-auto-xs hbox-auto-sm bg-light">
    <!-- first column in details view -->
    <div class="col bg-light lter b-r" style="width:299px;">
      <div class="vbox">
        <div class="row-row">

          <div class="wrapper p-t-sm" style="width:299px;">

            <div class="panel panel-default m-t-sm">
              <div class="panel-body">
                <a class="anchor back-to-tickets" href="javascript:void(0);">Tickets</a> / 
                <span>Tickets #{{id}}</span>
              </div>
            </div>

                <div class="panel panel-default ">
              <div class="panel-body">

                  <a class="pull-left thumb-sm avatar">
                    <img src="{{gravatarurl contact.properties 24}}" class="img-circle" alt="User Image">
                  </a>

                  <div class="m-l-xxl bg-white">

                      <div>
                        <span class="first-letter-cap inline-block">
                          <i class="fa fa-user fa-fw text-muted"></i> {{getPropertyValue contact.properties "first_name"}}
                          {{getPropertyValue contact.properties "last_name"}} 
                        </span>
                      </div>

                      <div>
                        <span class="first-letter-cap inline-block">
                          {{getPropertyValue contact.properties "company"}}
                        </span>
                      </div>

                      <div>
                       <i class="fa fa-envelope fa-fw text-muted"></i>
                          {{getPropertyValue contact.properties "email"}}
                      </div>

                       <div>
                         <i class="fa fa-phone fa-fw text-muted"></i>
                            <a href="tel:{{getPropertyValue contact.properties "phone"}}" class="contact-make-call contact-call-button" phone="{{getPropertyValue contact.properties "phone"}}">
                              {{getPropertyValue contact.properties "phone"}}
                            </a>
                        </div>  

                        <div class="col-md-12 p-n m-t-xs">
                          <a target="_blank" data-toggle="tooltip" data-placement="bottom" data-original-title="Website" href="/{{getPropertyValueBytype contact.properties 'website' '' 'URL'}}" 
                            class="text-l-none tooltip_info">
                            <i class="{{get_social_icon URL}} text-base text-muted tooltip_info"></i>
                          </a>
                          <a target="_blank" data-toggle="tooltip" data-placement="bottom" 
                            data-original-title="Twitter" href="https://twitter.com/{{getPropertyValueBytype contact.properties 'website' '' 'TWITTER'}}" class="m-l-xs">
                              <i class="{{get_social_icon "TWITTER"}} text-base text-muted tooltip_info"></i>
                          </a>
                          <a target="_blank" class="text-l-none tooltip_info m-l-xs" data-toggle="tooltip" data-placement="bottom" data-original-title="Facebook" href="https://www.facebook.com/{{getPropertyValueBytype contact.properties 'website' '' 'FACEBOOK'}}">
                            <i class="{{get_social_icon "FACEBOOK"}} text-base text-muted tooltip_info"></i>
                          </a>
                          <a class="text-l-none tooltip_info m-l-xs" target="_blank" data-toggle="tooltip" data-placement="bottom" data-original-title="Skype" href="skype:{{getPropertyValueBytype contact.properties 'website' '' 'SKYPE'}}"> 
                            <i class="{{get_social_icon "SKYPE"}}   text-base text-muted tooltip_info"></i>
                          </a>
                        </div>

                  </div>

            </div>
       </div>

            <div class="panel panel-default m-t-md">
              <div class="panel-body sla-due-date">
                <span class="text-md first-letter-cap inline-block">{{status}}</span>
                <div class="m-t-xs txt-small"><i class="fa fa-clock-o"></i> 
                  <span class="sla-text">Due in next 5 days &nbsp;</span>
                  <a id="change-sla" href="javascript:void(0);" class="link-color">Change</a>
                  <div class="m-t-sm">
                    <input type="text" class="form-control display-none" id="datetimepicker" placeholder="Select date" value="{{#if due_time}}{{epochToHumanDate "mmm dd yyyy HH:MM" due_time}}{{/if}}"/>
                  </div>  
                </div>
              </div>
            </div>

            <div class="panel panel-default m-t-md">
              <div class="panel-body">
                <div class="row m-n">
                  <div class="col-md-12 p-n">Assignee</div>
                  <div class="col-md-12 assignee_name ticket_assignee_name ticket-details-value hover-edit text-xs m-t-xs p-xs b-a" style="border-radius: 2px;">
                    <i class="fa fa-user"></i>&nbsp;
                    {{#if assigneeID}}
                      <span id="group_name" class="first-letter-cap inline-block">{{group.group_name}}</span>/
                      <span id="assignee_name" class="first-letter-cap inline-block">{{assignee.name}}</span>
                      <i class="icon-edit m-t-xs m-l-xs hide"></i>
                    {{else}}
                      <span id="group_name" class="first-letter-cap inline-block">-</span>
                      <span id="assignee_name" class="first-letter-cap inline-block"></span>
                      <i class="icon-edit m-t-xs m-l-xs hide"></i>
                    {{/if}}
                  </div>
                  <div class="col-md-12 select-assignee display-none p-n">
                      <select id="ticket-assignee-list" class="w-full">
                        
                      </select>
                  </div>
                </div>
                <div class="row m-l-n m-r-n m-t-sm text-sm">
                  <div class="col-md-6 p-l-n">
                    Type<br>
                    <select id="type" name="type" class="form-control text-xs ticket_type" style="height: 28px;padding: 3px 6px;">
                      <option value="QUESTION" {{#if_equals type "QUESTION"}}selected{{/if_equals}}>
                        Question
                      </option>
                      <option value="TASK" {{#if_equals type "TASK"}}selected{{/if_equals}}>Task</option>
                      <option value="INCIDENT" {{#if_equals type "INCIDENT"}}selected{{/if_equals}}>
                        Incident
                      </option>
                      <option value="PROBLEM" {{#if_equals type "PROBLEM"}}selected{{/if_equals}}>Problem</option>
                    </select>
                  </div>
                  <div class="col-md-6 p-r-n">
                    Priority<br>
                    <select name="priority" class="form-control text-xs ticket_priority" style="height: 28px;padding: 3px 6px;">
                      <option value="LOW" {{#if_equals priority "LOW"}}selected{{/if_equals}}>Low</option>
                      <option value="MEDIUM" {{#if_equals priority "MEDIUM"}}selected{{/if_equals}}>Medium</option>
                      <option value="HIGH" {{#if_equals priority "HIGH"}}selected{{/if_equals}}>High</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="panel panel-default m-t-md">
              <div class="panel-body">
                <div class="row m-n">
                  <div class="col-md-12 p-n">Labels<hr class="m-t-xs m-b-xs"></div>
                  <div class="col-md-12 p-n m-t-xs">
                    <select data-placeholder="Labels" class="chosen-select form-control" multiple class="w-md">
                    </select>
                  </div>
                </div>
              </div>
            </div>

            {{#get_allowed_canned_responses_array labels this}}{{/get_allowed_canned_responses_array}}
            {{#if allowed_canned_responses}}
            <div class="panel panel-default m-t-md">
              <div class="panel-body">
                <div class="row m-n">
                <div class="col-md-12 p-n">Matched Canned Responses<hr class="m-t-xs m-b-xs"></div>
                {{#each allowed_canned_responses}}
                  <div id="ticket_canned_response" class="col-md-12 p-n cursor-pointer ticket-canned-response">
                    <div class="edit-hover div-max-width">{{title}}</div>
                    <div id="message" class="edit-hover text-muted div-max-width" title="{{compile_template message ../this}}">{{compile_template message ../this}}</div>

                    {{#unless @last}} <div class="m-t-xs m-b-xs border-highlight text-muted"></div>{{/unless}}
                    
                  </div>

                {{/each}}
                 
                </div>
              </div>
            </div>
            {{/if}}

            <div class="m-t-sm">
              
            </div>
            <div class="m-b-xs m-t-xs">
             
            </div>
            <!--<hr class="m-t-sm m-b-sm">
            <div class="m-t-sm">
              <small class="text-muted text-sm">Tags</small>
            </div>
            <div class="contact-tags m-b-xs m-t-xs">
              <ul id="ticket-tags-ul" name="tags" class="inline v-top m-b-sm p-n tags">
                  {{#each tags}}
                    <li class="tag btn btn-xs btn-default m-r-xs m-b-xs inline-block" data="{{this.tag}}">
                      <span>
                        <a class="anchor m-r-xs" href="javascript:void(0);">{{this.tag}}</a>
                        <a class="close remove-ticket-tags text-lg" tag="{{this.tag}}">&times</a>
                      </span>
                    </li>
                  {{/each}}  
              </ul>
              <div class="inline-block m-t-xs">
                <div class="add-tags-form" class="m-b-none display-none">
                  <div class="control-group m-b-none">
                    <input type="text" class="input-sm ticket-tags-typeahead ignore-comma-keydown form-control inline-block" style="width: 60%" placeholder="Enter tag">
                    <span>
                  </div>
                </div>
                <a href="javascript:void(0);" id="show-tags-field" rel="tooltip" data-original-title="addtag" 
                  data-placement="top" class="p-t-sm p-b-sm text-xs text-muted show-tags-field">
                  <i class="fa fa-plus-square"></i>
                  <span>Add Tag</span>
                </a>
              </div>
            </div>-->
          </div>  
        </div><!-- End of row-row-->
      </div><!-- End of vbox-->
    </div>

    <!-- second column in details view -->
    <div class="col bg-white">
      <div class="vbox">
        <div class="row-row">

          <!-- Start of ticket notes -->
          <div class="wrapper bg-light p-t-sm p-b-sm pos-rlt b-b">
            <h3 class="font-thin m-t-none m-b-none inline-block" style="width: 88%;">
              {{subject}} 
              <div class="inline-block m-l-sm text-sm">
                <span class="label bg-light dk text-tiny first-letter-cap inline-block">
                  {{status}}
                </span>&nbsp;
                <span class="label {{toLowerCase priority}}-priority-bg text-tiny first-letter-cap inline-block">
                  {{priority}}
                </span>
              </div>
            </h3>
             
            <div class="pos-abs" style="right: 15px; top: 10px;">

            <div class="btn-group dropdown m-l-xs">
              <button class="btn btn-sm w-xxs btn-default show-workflows" data-toggle="dropdown" data-toggle="tooltip" data-placement="bottom" data-original-title="Workflows"><i class="fa fa-sitemap"></i></button>
              <ul id="workflows_list" class="dropdown-menu">
                <li><a href="javascript:void(0);">Loading...</a></li>
              </ul>
            </div>

            <div class="btn-group m-l-xs">
              <button class="btn btn-sm btn-default w-xxs w-auto-xs dropdown-toggle toggle-timeline" data-toggle="tooltip" data-placement="bottom" data-original-title="Timeline"><i class="fa fa-th-large"></i></button>
              <button class="btn btn-sm btn-default w-xxs w-auto-xs delete-ticket" data-toggle="tooltip" data-placement="bottom" data-original-title="Delete Ticket"><i class="fa fa-trash-o"></i></button>

              <button class="btn btn-sm btn-default w-xxs w-auto-xs close-ticket" data-toggle="tooltip" data-placement="bottom" data-original-title="Close Ticket"><i class="fa fa-folder"></i></button>
            </div> 

              <div class="btn-group">

                {{#next_prev_ticket_exists 'previous'}}
                <a onclick="clearContactWidetQueues({{contactID}})" href="{{#is_filtered_ticket}}
                  #tickets/filter/{{#get_ticket_filter_id}}{{/get_ticket_filter_id}}/ticket/{{#next_prev_ticket_exists 'previous'}}{{get_ticket_id 'previous'}}{{/next_prev_ticket_exists}}
                  {{/is_filtered_ticket}}" class="btn btn-default btn-sm" data-toggle="tooltip" data-placement="top" data-original-title="Previous">
                  <i class="icon icon-chevron-left"></i>
                </a>
                {{/next_prev_ticket_exists}}

                {{#next_prev_ticket_exists 'next'}}
                <a onclick="clearContactWidetQueues({{contactID}})" href="{{#is_filtered_ticket}}
                  #tickets/filter/{{#get_ticket_filter_id}}{{/get_ticket_filter_id}}/ticket/{{#next_prev_ticket_exists 'next'}}{{get_ticket_id 'next'}}{{/next_prev_ticket_exists}}
                  {{/is_filtered_ticket}}" class="btn btn-default btn-sm" data-toggle="tooltip" data-placement="top" data-original-title="Next">
                  <i class="icon icon-chevron-right"></i>
                </a>
                {{/next_prev_ticket_exists}}

              </div>


            </div>
          </div>
          
        <div class="clearfix m-b-lg m-md">
            <a class="pull-left thumb-sm avatar"><img src="{{assignee.ownerPic}}" class="img-circle" alt="User Image"></a>
            <div class="m-l-xxl bg-white">
               <div id="send-reply-container">
               </div>
            </div>

            <div class="b-b b-light m-b-sm m-t-md"></div>

          <!-- End of ticket notes -->
          <div id="notes-collection-container">
              
          </div>
          <!-- End of notes -->

    </div>
    
        </div><!-- End of row-row-->
      </div><!-- End of vbox-->
    
    </div>
    <!-- End of second column in details view -->

    <!-- third column in details view -->
    <div class="contact-right-widgetsview box-border b-l col w-lg bg-light lter b-l bg-auto">
      <div class="vbox block">
        <div class="row-row" style="display: block !important;">
          <div class="wrapper">
            <div id="widgets" class="contact_{{contactID}}">
            </div>  
          </div>  
        </div><!-- End of row-row-->
      </div><!-- End of vbox-->
    </div>
  </div>  
</div>
</div>
</script>
<script  id="create-ticket-notes-template" type="text/html">
<form name="send-reply" id="send-reply" onsubmit="return false;">
    <input type="hidden" name="ticket_id" value="{{id}}">
    <input type="hidden" name="attachment_urls" value=",">
    
      <div>
      
        {{#if_equals reply_type "reply"}}
          <button class="btn btn-dark reply-btn btn-sm" rel="reply" style="position: relative;">Reply
                      <i class="fa fa-caret-down text-dark" style="position: absolute;top: 80%;left: 44%;font-size: 18px;"></i>
                    </button>
        {{else}}
          <button class="btn btn-default reply-btn btn-sm" rel="reply" style="position: relative;">Reply
                    </button>
        {{/if_equals}}
        
        {{#if_equals reply_type "comment"}}
          <button class="btn btn-primary reply-btn btn-sm" rel="comment" style="position: relative;">Comment
            <i class="fa fa-caret-down text-primary" style="position: absolute;top: 80%;left: 44%;font-size: 18px;"></i>
          </button>
        {{else}}
          <button class="btn btn-default reply-btn btn-sm" rel="comment">Comment</button>
        {{/if_equals}}
        
        {{#if_equals reply_type "forward"}}
          <button class="btn btn-info reply-btn btn-sm" rel="forward" style="position: relative;">Forward
            <i class="fa fa-caret-down text-info" style="position: absolute;top: 80%;left: 44%;font-size: 18px;"></i>
          </button>
        {{else}}
          <button class="btn btn-default reply-btn btn-sm" rel="forward">Forward</button>
        {{/if_equals}}
        
        
        {{#if_equals reply_type "reply"}}
          <div class="btn-group dropdown pull-right p-none m-l-xs">
              <button class="btn btn-dark btn-sm send-reply">Send Reply</button>
              <button class="btn btn-dark btn-sm" data-toggle="dropdown" aria-expanded="false"><span class="caret"></span></button>
              <ul class="dropdown-menu">
                <li><a href="javascript:void(0);" class="send-reply close-ticket">Send Reply &amp; Close Ticket</a></li>
              </ul>
            </div>
            {{/if_equals}}
            
            {{#if_equals reply_type "comment"}} 

            <div class="btn-group dropdown p-none pull-right m-l-xs">
              <button class="btn btn-primary btn-sm send-reply private">Add Comment</button>
              <button class="btn btn-primary btn-sm" data-toggle="dropdown" aria-expanded="false"><span class="caret"></span></button>
              <ul class="dropdown-menu">
                <li><a href="javascript:void(0);" class="send-reply private close-ticket">Add Comment & Close Ticket</a></li>
              </ul>
            </div> 
            {{/if_equals}} 


            {{#if_equals reply_type "forward"}} 
              <button class="btn btn-sm btn-info pull-right m-l-xs send-reply forward">Forward</button>
            {{/if_equals}}

                      <a href="javascript:void(0);" class="btn btn-default btn-sm m-l-xs pull-right">
                      <i class="fa fa-paperclip" data-toggle="tooltip" data-placement="top" data-original-title="Attachments"></i>
                    </a>
                    <a href="javascript:void(0);" class="btn btn-default btn-sm m-l-xs canned-messages pull-right">
                      <i data-toggle="tooltip" data-placement="top" data-original-title="Canned Responses" class="fa fa-reorder"></i>
                    </a>
                   
                      
                  </div>

                  <div id="reply-editor" class="m-t-sm b-a">

                    {{#if_equals reply_type "forward"}} 
                      <div class="panel-heading ticket-email b-b b-light" contenteditable="true" data-name="html_text">
                        <span class="text-muted">To: </span>
                      </div>
                     {{/if_equals}}

                     <div id="reply_textarea" class="wrapper" contenteditable="true" data-name="html_text" style="min-height:130px">
                        <br/><br/>{{#if_equals reply_type "forward"}} {{{notes}}} {{/if_equals}}{{#getCurrentUserPrefs}}{{{signature}}}{{/getCurrentUserPrefs}}
                    </div>
            
                  </div>
                  
                  <div class="error-msg" style="color:#B94A48; font-size:14px"></div>

              </div>
              
      </form>        
</script>
<script  id="ticket-status-template" type="text/html">
  {{#if_equals status 'OPEN'}}
    <li>
      <a class="change-ticket-status-li" data-value="CLOSED">Close</a>
    </li>
  {{/if_equals}}
  {{#if_equals status 'CLOSED'}}
    <li>
      <a class="change-ticket-status-li" data-value="OPEN">Open</a>
    </li>
  {{/if_equals}}
</script>
<script  id="ticket-notes-loader-template" type="text/html">
<div class="b-b b-t p-md">
  <img class="loading" src="/flatfull/img/ajax-loader-cursor.gif">
</div>
</script>
<script  id="ticket-change-assignee-template" type="text/html">
  {{#each this}}
    <optgroup label="{{group_name}}">
      {{#group_users}}
        <option data-group-name="{{../group_name}}" data-group-id="{{../id}}" value="{{id}}">{{name}}</option>
      {{/group_users}}
    </optgroup>
  {{/each}}  
</script>
<script  id="ticket-deals-list-template" type="text/html">
  {{#unless this.length}}
    No Deals
  {{/unless}}  
  {{#each this}}
    <div class="col-md-12 p-n m-t-xs">
      <div>
        {{name}}
      </div>
      <div>
        $ {{expected_value}} <span class="text-muted">{{milestone}}({{probability}}%)</span>
      </div>
      <div class="text-ellipsis">
        {{description}}
      </div>
    </div>
  {{/each}}
</script>