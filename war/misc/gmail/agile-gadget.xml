<?xml version="1.0" encoding="UTF-8"?>
<Module>
	<ModulePrefs title="AgileCRM" description="Sell &amp; Market like Fortune 500"
		height="100" author="" author_email="" author_location="">

		<!-- Declare feature dependencies. -->

		<!-- This one is not specific to Gmail contextual gadgets. -->
		<Require feature="dynamic-height" />

		<!-- The next feature, google.contentmatch, is required for all Gmail contextual 
			gadgets. <Param> - specify one or more comma-separated extractor IDs in a 
			param named "extractors". This line is overridden by the extractor ID in 
			the manifest, but is still expected to be present. -->
		<Require feature="google.contentmatch">
			<Param name="extractors">
				555292128199:Agile,google.com:EmailAddressExtractor
			</Param>
		</Require>

		<!-- Single Sign on -->
		<Require feature="opensocial-0.9" /> 
		<Require feature="osapi" />
		<Require feature="setprefs" />

	</ModulePrefs>
	
	<UserPref name="agile_user_key" default_value="" datatype="hidden"/>
	<UserPref name="agile_user_domain" default_value="" datatype="hidden"/>
	<UserPref name="agile_user_exists" default_value="" datatype="hidden"/>
	<UserPref name="agile_user_popup" default_value="" datatype="hidden"/>
	<UserPref name="agile_user_email" default_value="" datatype="hidden"/>
	<UserPref name="agile_user_expire_at" default_value="0" datatype="hidden"/>
	
	<!-- Define the content type and display location. The settings "html" and 
		"card" are required for all Gmail contextual gadgets. -->
	<Content type="html" view="card">
    <![CDATA[
      
    <link media="screen" rel="stylesheet" type="text/css" href="https://googleapps.agilecrm.com/css/bootstrap-red.min.css" />
    <link rel="stylesheet" type="text/css" href="https://googleapps.agilecrm.com/css/lib/datepicker-min.css" />
    <style>
		.error{color:red;}
		.field_req {color: red;}
		legend {font-size: 16px; margin-bottom: 10px; line-height: 20px;}
		fieldset {margin-top:10px;}
		input {height:22px !important; padding: 0px 4px !important;}
		select {height:22px; padding:0px;}
		li.active a {background-color: #f2f2f2 !important;}
		.activity-text-block {
			margin-top: 5px;
			padding: 8px;
			padding-left: 30px;
			background: #fff;
			border: solid 1px #ddd;
			box-shadow: 0 1px 2px rgba(0,0,0,0.05);
		}
		
    </style>
    
	<div class="container-fluid" style="padding:0px;">
		<div class="row-fluid">
				<div class="span12" style="margin:0px;">
	<!-- Search Email Panel -->
					<div id="search_mail_div">
						<img id="loading" style="padding-right:5px" src="https://googleapps.agilecrm.com/img/21-0.gif"></img>
					</div>
					
	<!-- Email list -->
					<div id="agile_content" >
						
					</div>
    			</div>
    	</div>
    </div>
   	
	<script src='https://googleapps.agilecrm.com/lib/headjs-min.js'></script>
	<script src='https://googleapps.agilecrm.com/lib/jquery.min.js'></script>
	<script src='https://googleapps.agilecrm.com/misc/gmail/gadget-js-all/min/agile-gadget-main.min.js'></script>
   	
	<script id="gadget-template" type="text/html">
	{{#check_json_length this "1"}}
		<div class="well well-small gadget-contact-details-tab" style='margin:0px; border-radius:0px; background-color:#f2f2f2; box-shadow:none; border-bottom:0px; border-left:0px; border-right:0px;'>
			<div class="show-form" data-content="{{value.email}}">
<!--email list -->
				<div class="contact-list">
					<div class="agile-no-contact row-fluid">
						<div class="contact-list-width" style="max-width:95%; display:inline-block; vertical-align:middle;">
							<div style="text-overflow: ellipsis; white-space: nowrap; overflow: hidden;">
								{{#if value.fname}}
									<a class="gadget-search-contact" style="cursor:pointer; margin:0px 10px 0px 0px; text-decoration:underline; font-weight:bold;"><i class="icon-search" style="text-decoration:none; margin-right:5px;"></i><span>Search</span></a><span title="{{value.fname}} {{value.lname}} ({{value.email}})" style="cursor:default;"> {{value.fname}} {{value.lname}} ({{value.email}}) <span style="margin-left:10px;">in Agile Contacts</span></span>
								{{else}}
									<a class="gadget-search-contact" style="cursor:pointer; margin:0px 8px 0px 5px; text-decoration:underline; font-weight:bold;"><i class="icon-search" style="text-decoration:none; margin-right:5px;"></i><span>Search</span></a><span title="{{value.email}}" style="cursor:default;"> {{value.email}} <span style="margin-left:10px;">in Agile Contacts</span></span>
								{{/if}}
							</div>
						</div>
						<img class="contact-search-waiting" style="margin-left:20px; visibility:hidden; width:13px; vertical-align:middle;" src="https://googleapps.agilecrm.com/img/ajax-loader-cursor.gif"></img>
					</div>
			    </div>
			</div>
		</div>
	{{else}}
<!--Search email panel -->			
			<div class="well well-small gadget-contact-details-tab" style="margin:0px 0px -1px 0px; box-shadow:none; border-radius:0px; background-color:#f2f2f2;">
				<div class="show-form">
					<div>
						<div class="row-fluid">
							
	<!-- Search mail UI area start-->
							<div style="line-height:22px;">
								<div class="search-pannel-inner">
									
									<div style="display: inline-block;vertical-align: middle;">
										<a class="gadget-search-contact search-mail-button" style="cursor:pointer; margin:0px 10px 0px 0px; text-decoration:underline; font-weight:bold;"><i class="icon-search" style="text-decoration:none; margin-right:5px;"></i><span>Search</span></a>
									</div>
									<div class="btn-group" style="display: inline-block;vertical-align: middle;margin: 0 10px 0 0;">
										<select id="search_drop_down" class="agile-mail-dropdown" style="width:auto; margin:0px;">
											<!-- dropdown menu links -->
											{{#iterate_json this}}											
												{{#if value.fname}}
													<option class="mail-list" data-content="{{value.email}}" >{{value.fname}} {{value.lname}} ({{value.email}})</option>
												{{else}}
													<option class="mail-list" data-content="{{value.email}}" >{{value.email}}</option>
												{{/if}}
											{{/iterate_json}}	
										</select>
									</div>
									<div style="display: inline-block;vertical-align: middle;">
										<span style="display:inline-block;">in Agile Contacts</span>
										<img class="contact-search-waiting" style="margin-left:20px; display:none; width:13px;" src="https://googleapps.agilecrm.com/img/ajax-loader-cursor.gif"></img>
										<i class="contact-search-status" style="display:none; color:indianred; margin-left:20px;">Contact not found</i>
									</div>
								</div>
							</div>
	<!-- Search mail UI area end-->						
						</div>
					</div>
				</div>
			</div>
	{{/check_json_length}}
	</script>
]]>
</Content>
</Module>