<?xml version="1.0" encoding="UTF-8" ?>
<ApplicationManifest xmlns="http://schemas.google.com/ApplicationManifest/2009">

  <!-- Support info to show in the marketplace & control panel -->
  <Support>
  
    <!-- URL for application configuration, accessed from the app settings
     page in the control panel -->
    <Link rel="manage" href="http://${DOMAIN_NAME}.agilecrm.com" />

    <!-- URL explaining how customers get support. -->
    <Link rel="support" href="http://support.agilecrm.com" />

    <!-- URL that is displayed to admins during the deletion process,
     to specify policies such as data retention, how to claim accounts, etc. -->
    <Link rel="deletion-policy" href="http://qmacro-contextual.appspot.com/twitter-user-info/deletion-policy" />
  </Support>

  <!-- Name and description pulled from message bundles -->
  <Name>Agile CRM Contextual Gadget</Name>
  <Description>AgileCRM Rocks and why you should keep it.</Description>

  <!-- Show this link in Google's universal navigation for all users -->
  <Extension id="navLink" type="link">
    <Name>Agile Test 9</Name>
    <Url>https://googleapps.agilecrm.com/login?hd=${DOMAIN_NAME}</Url>
  </Extension>

  <!-- Declare our OpenID realm so our app is white listed -->
  <Extension id="realm" type="openIdRealm">
    <Url>https://googleapps.agilecrm.com</Url>
  </Extension>

<!-- Custom EXTRACTOR -->


<Extension id="FromEmailAddressExtractor" type="contextExtractor">
  <Name>Email ids in From</Name>
  <Url>623403448797:Agile</Url>
  <Triggers ref="AgileCRMGadget"/>
  <Scope ref="emailFrom"/>
   <Scope ref="emailName"/>
   <Scope ref="emailBody"/>
   <Scope ref="emailSubject"/>
   <Container name="mail"/>
</Extension>


 <Extension id="SubjectBodyEmailAddressExtractor" type="contextExtractor">
  <Name>Email ids in Subject or body</Name>
  <Url>google.com:EmailAddressExtractor</Url>
  <Param name="email" value=".*"/>
  <Triggers ref="AgileCRMGadget"/>
  <Scope ref="emailBody"/>
  <Scope ref="emailSubject"/>
  <Container name="mail"/>
</Extension>

<!-- GADGET -->
<Extension id="AgileCRMGadget" type="gadget">
  <Name>AgileCRM - Built with Love for Small Businesses - contextual gadget</Name>
  <Url>https://googleapps.agilecrm.com/misc/gmail/2/gadget.xml</Url>
  <Container name="mail"/>
</Extension>

<!-- SCOPE -->
<Scope id="emailFrom">
  <Url>tag:google.com,2010:auth/contextual/extractor/FROM_ADDRESS</Url>
  <Reason>AgileCRM looks at from address to determine if there is a match in CRM.</Reason>
</Scope>

<!-- SCOPE -->
<Scope id="emailName">
  <Url>tag:google.com,2010:auth/contextual/extractor/FROM_PERSONAL</Url>
  <Reason>AgileCRM looks at sender's name to prefill the new-contact information</Reason>
</Scope>

<Scope id="emailSubject">
  <Url>tag:google.com,2010:auth/contextual/extractor/SUBJECT</Url>
  <Reason>AgileCRM looks for any email in subject looking for matches in AgileCRM</Reason>
</Scope>

<Scope id="emailBody">
  <Url>tag:google.com,2010:auth/contextual/extractor/BODY</Url>
  <Reason>AgileCRM looks for any email in body looking for matches in AgileCRM</Reason>
</Scope>


</ApplicationManifest>