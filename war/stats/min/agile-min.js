<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
function agile_setAccount(b,a){agile_id.set(b,a);agile_setEmailFromUrl()}function agile_setEmailFromUrl(){if(window.location.href.search("fwd=cd")!==-1){try{var a=decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI("data").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));if(a){agile_guid.set_email(JSON.parse(a).email)}}catch(b){console.log(b.message)}}}function agile_allowedDomains(b){var a=agile_id.getURL()+"/allowed-domains?callback=?&id="+agile_id.get();agile_json(a,b)}var _agile={set_account:function(b,a){agile_setAccount(b,a)},set_email:function(a){agile_setEmail(a)},track_page_view:function(a){agile_trackPageview(a)},create_contact:function(a,b){agile_createContact(a,b)},get_contact:function(a,b){agile_getContact(a,b)},delete_contact:function(a,b){agile_deleteContact(a,b)},add_tag:function(b,c,a){agile_addTag(b,c,a)},remove_tag:function(b,c,a){agile_removeTag(b,c,a)},add_score:function(b,c,a){agile_addScore(b,c,a)},subtract_score:function(b,c,a){agile_subtractScore(b,c,a)},add_note:function(b,c,a){agile_addNote(b,c,a)},set_property:function(b,c,a){agile_setProperty(b,c,a)},add_task:function(b,c,a){agile_addTask(b,c,a)},add_deal:function(b,c,a){agile_addDeal(b,c,a)},get_score:function(b,a){agile_getScore(b,a)},get_tags:function(b,a){agile_getTags(b,a)},get_notes:function(b,a){agile_getNotes(b,a)},get_tasks:function(b,a){agile_getTasks(b,a)},get_deals:function(b,a){agile_getDeals(b,a)},add_campaign:function(b,c,a){agile_addCampaign(b,c,a)},get_campaigns:function(b,a){agile_getCampaigns(b,a)},get_campaign_logs:function(b,a){agile_getCampaignlogs(b,a)},get_workflows:function(a){agile_getWorkflows(a)},get_pipelines:function(a){agile_getPipelines(a)},get_milestones:function(a){agile_getMilestones(a)},get_milestones_by_pipeline:function(a,b){agile_getMilestones_by_pipeline(a,b)},update_contact:function(b,c,a){agile_updateContact(b,c,a)},get_email:function(a){agile_getEmail(a)},create_company:function(a,b){agile_createCompany(a,b)},get_property:function(b,c,a){agile_getProperty(b,c,a)},remove_property:function(b,c,a){agile_removeProperty(b,c,a)},add_property:function(b,c,a){agile_setProperty(b,c,a)},web_rules:function(a){agile_webRules(a)},unsubscribe_campaign:function(b,c,a){agile_unsubscribeCampaign(b,c,a)},allowed_domains:function(a){agile_allowedDomains(a)}};function agile_addCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getCampaigns(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaigns?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getCampaignlogs(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaign-logs?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getWorkflows(b){var a=agile_id.getURL()+"/contacts/get-workflows?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_unsubscribeCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/unsubscribe-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createContact(d,k){var h=[];for(var j in d){if(d.hasOwnProperty(j)&&j!="tags"){h.push(agile_propertyJSON(j,d[j]))}}var g=agile_read_cookie(agile_guid.cookie_original_ref);if(g){h.push(agile_propertyJSON("original_ref",g))}var a=agile_read_cookie("agile-tags");var f={};f.properties=h;if(d.tags){var m=d.tags;var e=m.trim().replace("/ /g"," ");e=e.replace("/, /g",",");f.tags=e.split(",");for(var c=0;c<f.tags.length;c++){f.tags[c]=f.tags[c].trim()}}if(a){agile_delete_cookie("agile-tags");var e=a.trim().replace("/ /g"," ");e=e.replace("/, /g",",");var b=e.split(",");if(f.tags){for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}else{f.tags=[];for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}}var l=agile_id.getURL()+"/contacts?callback=?&id="+agile_id.get()+"&contact="+encodeURIComponent(JSON.stringify(f));agile_json(l,k)}function agile_deleteContact(b,c){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contact/delete?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}function agile_getContact(b,d){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var c="email={0}".format(encodeURIComponent(b));var a=agile_id.getURL()+"/contact/email?callback=?&id="+agile_id.get()+"&"+c;agile_json(a,d)}function agile_updateContact(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contact/update?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createCompany(e,f){var d=[];for(var c in e){if(e.hasOwnProperty(c)){d.push(agile_propertyJSON(c,e[c]))}}var b={};b.properties=d;var a=agile_id.getURL()+"/company?callback=?&id="+agile_id.get()+"&data="+encodeURIComponent(JSON.stringify(b));agile_json(a,f)}function agile_propertyJSON(a,d,c){var b={};if(c==undefined){switch(a){case"first_name":case"last_name":case"email":case"company":case"title":case"name":case"url":case"website":case"address":case"phone":case"original_ref":b.type="SYSTEM";break;default:b.type="CUSTOM";break}}else{b.type=c}b.name=a;b.value=d;return b}var agile_json_timer;function agile_json(a,c){if(!document.body){clearInterval(agile_json_timer);agile_json_timer=setInterval(function(){agile_json(a,c)},100);return}clearInterval(agile_json_timer);var b="json"+(Math.random()*100).toString().replace(/\./g,"");window[b]=function(d){if(d.error){if(c&&typeof(c.error)=="function"){c.error(d)}return}if(c&&typeof(c.success)=="function"){c.success(d)}if(c&&typeof(c)=="function"){c(d)}};document.getElementsByTagName("body")[0].appendChild((function(){var d=document.createElement("script");d.type="application/javascript";d.src=a.replace("callback=?","callback="+b);return d})())}String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})};function agile_addDeal(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="opportunity={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/opportunity?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getDeals(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-deals?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setEmail(a){agile_guid.set_email(a)}function agile_getEmail(c){var b=agile_guid.get_email();var a=agile_id.getURL()+"/email?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}var _agile_synch_form_v2=function(){var f=document.getElementsByClassName("agile-button")[0];f.setAttribute("disabled","disabled");var p=document.getElementById("agile-error-msg");var k=document.getElementById("agile-form");var r=document.getElementById("agile-form-data").getAttribute("name").split(" ");var h={};var g=r[2];var c=r[1];var e=r[0];var q=e+" "+c+" "+g+" ";var l=document.getElementById("agile-form-data").getAttribute("name").replace(q,"");var b={};var d;var o=[];for(var m=0;m<k.length;m++){var s=k[m].getAttribute("name");var j=k[m].value;if(s&&j){if("address, city, state, country, zip".indexOf(s)!=-1){b[s]=j}else{if(s=="tags"){if(d){d=d+","+j}else{d=j}}else{if(s=="note"){var n={};n.subject=k[m].parentNode.parentNode.getElementsByTagName("label")[0].innerHTML;n.description=j;o.push(n)}else{h[s]=j}}}}}b=JSON.stringify(b);if(b.length>2){h.address=b}if(d){if(l){h.tags=d+","+l}else{h.tags=d}}else{if(l){h.tags=l}}var a=h.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,e);_agile.track_page_view()}if(a){_agile.set_email(a)}_agile.create_contact(h,{success:function(t){var u=0;if(o.length>0){for(var i=0;i<o.length;i++){_agile.add_note(o[i],{success:function(v){u++;if(u==o.length){agile_formCallback(["",p],f,g)}},error:function(v){agile_formCallback(["There was an error in sending data",p],f,g,v)}})}}else{agile_formCallback(["",p],f,g)}},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(h,{success:function(u){var v=0;if(o.length>0){for(var t=0;t<o.length;t++){_agile.add_note(o[t],{success:function(w){v++;if(v==o.length){agile_formCallback(["",p],f,g)}},error:function(w){agile_formCallback(["There was an error in sending data",p],f,g,w)}})}}else{agile_formCallback(["",p],f,g)}},error:function(t){agile_formCallback(["There was an error in sending data",p],f,g,t)}})}else{agile_formCallback(["There was an error in sending data",p],f,g,i)}}})};var _agile_synch_form=function(){var k=document.getElementsByClassName("agile-button")[0];k.setAttribute("disabled","disabled");var b=document.getElementById("agile-error-msg");var o=document.getElementById("agile-form");var d=document.getElementById("agile-form-data");var c={};var l=d.getAttribute("agile-redirect-url");var h=d.getAttribute("agile-api");var j=d.getAttribute("agile-domain");var e={};var n;for(var f=0;f<o.length;f++){var a=o[f].getAttribute("agile-field");var m=o[f].value;if(a&&m){if("address, city, state, country, zip".indexOf(a)!=-1){e[a]=m}else{if(a=="tags"){if(n){n=n+","+m}else{n=m}}else{c[a]=m}}}}e=JSON.stringify(e);if(e.length>2){c.address=e}if(n){c.tags=n}var g=c.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(h,j);_agile.track_page_view()}if(g){_agile.set_email(g)}_agile.create_contact(c,{success:function(i){agile_formCallback(["",b],k,l)},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(c,{success:function(p){agile_formCallback(["",b],k,l)},error:function(p){agile_formCallback(["There was an error in sending data",b],k,l,p)}})}else{agile_formCallback(["There was an error in sending data",b],k,l,i)}}})};var agile_guid={init:function(){this.cookie_name="agile-crm-guid";this.cookie_email="agile-email";this.cookie_original_ref="agile-original-referrer";this.new_guid=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var a=agile_read_cookie(this.cookie_name);if(!a){a=this.generate()}return a},generate:function(){guid=this.random();agile_create_cookie(this.cookie_name,guid,365*5);this.set_original_referrer();this.new_guid=true;return guid},reset:function(){agile_create_cookie(this.cookie_name,"",-1)},set_email:function(a){var b=agile_read_cookie(this.cookie_email);if(!b||(b!=a)){this.email=a;if(b){this.reset();agile_session.reset()}agile_create_cookie(this.cookie_email,this.email,365*5)}},get_email:function(){if(this.email){return this.email}var a=agile_read_cookie(this.cookie_email);return a},set_original_referrer:function(){var a=document.referrer;if(a){agile_create_cookie(this.cookie_original_ref,a,365*5)}}};agile_guid.init();var agile_id={set:function(b,a){this.id=b;this.namespace=a},get:function(){return this.id},getURL:function(){if(!this.namespace||this.namespace=="localhost"){return"http://localhost:8888/core/js/api"}else{return"https://"+this.namespace+"-dot-sandbox-dot-agilecrmbeta.appspot.com/core/js/api"}},getNamespace:function(){return this.namespace}};function agile_getPipelines(b){var a=agile_id.getURL()+"/milestone/get-pipelines?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones(b){var a=agile_id.getURL()+"/contact/get-milestones?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones_by_pipeline(b,c){var a=agile_id.getURL()+"/milestone/get-milestones?callback=?&id="+agile_id.get()+"&pipeline_id="+b;agile_json(a,c)}function agile_addNote(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-note?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getNotes(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-notes?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setProperty(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-property?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/get-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_removeProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/remove-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_addScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/add-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_subtractScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/subtract-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_getScore(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-score?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}var agile_session={init:function(){this.cookie_name="agile-crm-session_id";this.cookie_start_time="agile-crm-session_start_time";this.cookie_duration_secs=60*1000;this.new_session=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var b=agile_read_cookie(this.cookie_name);if(!b){return this.generate()}var a=agile_read_cookie(this.cookie_start_time);var c=new Date().getUTCSeconds();if((c<a)||(c>(a+this.cookie_duration_secs))){return this.generate()}return b},generate:function(){var a=this.random();agile_create_cookie(this.cookie_name,a,0);agile_create_cookie(this.cookie_start_time,new Date().getUTCSeconds(),0);this.new_session=true;return a},reset:function(){agile_create_cookie(this.cookie_name,"",-1);agile_create_cookie(this.cookie_start_time,"",-1)}};agile_session.init();function agile_addTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"add");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/add-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_removeTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"delete");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/remove-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTags(e,c){if(!c){if(!agile_guid.get_email()){return}else{c=agile_guid.get_email()}}var b=agile_read_cookie("agile-tags");var d="email={0}&tags={1}".format(encodeURIComponent(c),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/get-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_addTask(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="task={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/task?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTasks(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-tasks?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_trackPageview(h){var d=agile_guid.get();var e=agile_session.get();var c=document.location.href;if(c!==undefined&&c!=null){c=encodeURIComponent(c)}else{c=""}var a=agile_id.get();var g="";if(agile_session.new_session){var f=document.referrer;if(f!==undefined&&f!=null&&f!="null"){f=encodeURIComponent(f)}else{f=""}g="guid={0}&sid={1}&url={2}&agile={3}&new=1&ref={4}".format(d,e,c,a,f)}else{g="guid={0}&sid={1}&url={2}&agile={3}".format(d,e,c,a)}if(agile_guid.get_email()){g+="&email="+encodeURIComponent(agile_guid.get_email())}var b="https://"+agile_id.getNamespace()+".agilecrm.com/stats?callback=?&"+g;agile_json(b,h)}function agile_removeCommonTags(d,c){var f=d.length;while(--f>=0){var e=c.length;while(--e>=0){if(d[f]&&d[f].trim()==c[e].trim()){d.splice(f,1);f=d.length}}}return d}function agile_cookieTags(b,g){var h=agile_read_cookie("agile-tags");if(!h){if(g=="add"){agile_create_cookie("agile-tags",b,5*365)}return}var e=h.split(",");var a=b.split(",");agile_delete_cookie("agile-tags");if(g=="delete"){var f=agile_removeCommonTags(e,a);if(f.length>0){agile_create_cookie("agile-tags",f.toString(),5*365)}}if(g=="add"){var d=agile_removeCommonTags(a,e);var c=d.length;while(--c>=0){e.push(d[c])}agile_create_cookie("agile-tags",e.toString(),5*365)}return}function agile_formCallback(b,c,a,d){if(d){console.log("AgileCRM form error "+d.error)}b[1].innerHTML=b[0];c.removeAttribute("disabled");setTimeout(function(){b[1].innerHTML="";window.location.replace(a)},1500)}function _agile_load_form_fields(){var a=agile_read_cookie("agile-email");if(!a){return}_agile.get_contact(a,{success:function(f){if(f){var b={};var g=f.properties;for(var e=0;e<g.length;e++){b[g[e].name]=g[e].value}var d=document.getElementById("agile-form");for(var c=0;c<d.length;c++){if(b[d[c].name]){d[c].value=b[d[c].name]}}}},error:function(b){return}})}function agile_webRules(b){var a=agile_id.getURL()+"/web-rules?callback=?&id="+agile_id.get();agile_json(a,b)}function _agile_execute_web_rules(){_agile_require_js("https://agilegrabbers.appspot.com/demo/agile-webrules-min.js",function(){_agile_webrules()})}function _agile_require_js(d,c){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=d;if((navigator.appVersion).indexOf("MSIE")>0){a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}else{a.onload=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}var b=document.getElementsByTagName("head")[0];b.appendChild(a)}function agile_read_cookie(b){b=agile_id.get()+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function agile_create_cookie(c,e,g){c=agile_id.get()+"-"+c;if(g){var b=new Date();b.setTime(b.getTime()+(g*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}var d="";var f=window.location.hostname.replace(/([a-zA-Z0-9]+.)/,"");if(f.length>5){d=";document=."+f}document.cookie=c+"="+escape(e)+a+"; path=/"+d}function agile_createCookieInAllAgileSubdomains(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/; domain=agilecrm.com"}function agile_delete_cookie(a){agile_create_cookie(a,"",-1)}function agile_enable_console_logging(){var a=false;if(typeof console==="undefined"||!a){console={log:function(){},error:function(){}}}if(typeof(console.log)==="undefined"||!a){console.log=function(){return 0}}if(typeof(console.error)==="undefined"||!a){console.error=function(){return 0}}};
=======
function agile_setAccount(b,a){agile_id.set(b,a);agile_setEmailFromUrl()}function agile_setEmailFromUrl(){if(window.location.href.search("fwd=cd")!==-1){try{var a=decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI("data").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));if(a){agile_guid.set_email(JSON.parse(a).email)}}catch(b){console.log(b.message)}}}function agile_allowedDomains(b){var a=agile_id.getURL()+"/allowed-domains?callback=?&id="+agile_id.get();agile_json(a,b)}var _agile={set_account:function(b,a){agile_setAccount(b,a)},set_email:function(a){agile_setEmail(a)},track_page_view:function(a){agile_trackPageview(a)},create_contact:function(a,b){agile_createContact(a,b)},get_contact:function(a,b){agile_getContact(a,b)},delete_contact:function(a,b){agile_deleteContact(a,b)},add_tag:function(b,c,a){agile_addTag(b,c,a)},remove_tag:function(b,c,a){agile_removeTag(b,c,a)},add_score:function(b,c,a){agile_addScore(b,c,a)},subtract_score:function(b,c,a){agile_subtractScore(b,c,a)},add_note:function(b,c,a){agile_addNote(b,c,a)},set_property:function(b,c,a){agile_setProperty(b,c,a)},add_task:function(b,c,a){agile_addTask(b,c,a)},add_deal:function(b,c,a){agile_addDeal(b,c,a)},get_score:function(b,a){agile_getScore(b,a)},get_tags:function(b,a){agile_getTags(b,a)},get_notes:function(b,a){agile_getNotes(b,a)},get_tasks:function(b,a){agile_getTasks(b,a)},get_deals:function(b,a){agile_getDeals(b,a)},add_campaign:function(b,c,a){agile_addCampaign(b,c,a)},get_campaigns:function(b,a){agile_getCampaigns(b,a)},get_campaign_logs:function(b,a){agile_getCampaignlogs(b,a)},get_workflows:function(a){agile_getWorkflows(a)},get_pipelines:function(a){agile_getPipelines(a)},get_milestones:function(a){agile_getMilestones(a)},get_milestones_by_pipeline:function(a,b){agile_getMilestones_by_pipeline(a,b)},update_contact:function(b,c,a){agile_updateContact(b,c,a)},get_email:function(a){agile_getEmail(a)},create_company:function(a,b){agile_createCompany(a,b)},get_property:function(b,c,a){agile_getProperty(b,c,a)},remove_property:function(b,c,a){agile_removeProperty(b,c,a)},add_property:function(b,c,a){agile_setProperty(b,c,a)},web_rules:function(a){agile_webRules(a)},unsubscribe_campaign:function(b,c,a){agile_unsubscribeCampaign(b,c,a)},allowed_domains:function(a){agile_allowedDomains(a)}};function agile_addCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getCampaigns(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaigns?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getCampaignlogs(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaign-logs?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getWorkflows(b){var a=agile_id.getURL()+"/contacts/get-workflows?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_unsubscribeCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/unsubscribe-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createContact(d,k){var h=[];for(var j in d){if(d.hasOwnProperty(j)&&j!="tags"){h.push(agile_propertyJSON(j,d[j]))}}var g=agile_read_cookie(agile_guid.cookie_original_ref);if(g){h.push(agile_propertyJSON("original_ref",g))}var a=agile_read_cookie("agile-tags");var f={};f.properties=h;if(d.tags){var m=d.tags;var e=m.trim().replace("/ /g"," ");e=e.replace("/, /g",",");f.tags=e.split(",");for(var c=0;c<f.tags.length;c++){f.tags[c]=f.tags[c].trim()}}if(a){agile_delete_cookie("agile-tags");var e=a.trim().replace("/ /g"," ");e=e.replace("/, /g",",");var b=e.split(",");if(f.tags){for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}else{f.tags=[];for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}}var l=agile_id.getURL()+"/contacts?callback=?&id="+agile_id.get()+"&contact="+encodeURIComponent(JSON.stringify(f));agile_json(l,k)}function agile_deleteContact(b,c){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contact/delete?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}function agile_getContact(b,d){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var c="email={0}".format(encodeURIComponent(b));var a=agile_id.getURL()+"/contact/email?callback=?&id="+agile_id.get()+"&"+c;agile_json(a,d)}function agile_updateContact(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contact/update?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createCompany(e,f){var d=[];for(var c in e){if(e.hasOwnProperty(c)){d.push(agile_propertyJSON(c,e[c]))}}var b={};b.properties=d;var a=agile_id.getURL()+"/company?callback=?&id="+agile_id.get()+"&data="+encodeURIComponent(JSON.stringify(b));agile_json(a,f)}function agile_propertyJSON(a,d,c){var b={};if(c==undefined){switch(a){case"first_name":case"last_name":case"email":case"company":case"title":case"name":case"url":case"website":case"address":case"phone":case"original_ref":b.type="SYSTEM";break;default:b.type="CUSTOM";break}}else{b.type=c}b.name=a;b.value=d;return b}var agile_json_timer;function agile_json(a,c){if(!document.body){clearInterval(agile_json_timer);agile_json_timer=setInterval(function(){agile_json(a,c)},100);return}clearInterval(agile_json_timer);var b="json"+(Math.random()*100).toString().replace(/\./g,"");window[b]=function(d){if(d.error){if(c&&typeof(c.error)=="function"){c.error(d)}return}if(c&&typeof(c.success)=="function"){c.success(d)}if(c&&typeof(c)=="function"){c(d)}};document.getElementsByTagName("body")[0].appendChild((function(){var d=document.createElement("script");d.type="application/javascript";d.src=a.replace("callback=?","callback="+b);return d})())}String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})};function agile_addDeal(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="opportunity={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/opportunity?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getDeals(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-deals?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setEmail(a){agile_guid.set_email(a)}function agile_getEmail(c){var b=agile_guid.get_email();var a=agile_id.getURL()+"/email?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}var _agile_synch_form_v2=function(){var m=document.getElementsByClassName("agile-button")[0];m.setAttribute("disabled","disabled");var b=document.getElementById("agile-error-msg");var q=document.getElementById("agile-form");var e=document.getElementById("agile-form-data").getAttribute("name").split(" ");var c={};var n=e[2];var k=e[0]+" "+e[1]+" "+n+" ";var d=document.getElementById("agile-form-data").getAttribute("name").replace(k,"");var g={};var p;var f=[];for(var h=0;h<q.length;h++){var a=q[h].getAttribute("name");var o=q[h].value;if(a&&o){if("address, city, state, country, zip".indexOf(a)!=-1){g[a]=o}else{if(a=="tags"){if(p){p=p+","+o}else{p=o}}else{if(a=="note"){var l={};l.subject=q[h].parentNode.parentNode.getElementsByTagName("label")[0].innerHTML;l.description=o;f.push(l)}else{c[a]=o}}}}}g=JSON.stringify(g);if(g.length>2){c.address=g}if(p){if(d){c.tags=p+","+d}else{c.tags=p}}else{if(d){c.tags=d}}var j=c.email;if(j){_agile.set_email(j)}_agile.create_contact(c,{success:function(r){var s=0;if(f.length>0){for(var i=0;i<f.length;i++){_agile.add_note(f[i],{success:function(t){s++;if(s==f.length){agile_formCallback(["",b],m,n)}},error:function(t){agile_formCallback(["There was an error in sending data",b],m,n,t)}})}}else{agile_formCallback(["",b],m,n)}},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(c,{success:function(s){var t=0;if(f.length>0){for(var r=0;r<f.length;r++){_agile.add_note(f[r],{success:function(u){t++;if(t==f.length){agile_formCallback(["",b],m,n)}},error:function(u){agile_formCallback(["There was an error in sending data",b],m,n,u)}})}}else{agile_formCallback(["",b],m,n)}},error:function(r){agile_formCallback(["There was an error in sending data",b],m,n,r)}})}else{agile_formCallback(["There was an error in sending data",b],m,n,i)}}})};var _agile_synch_form=function(){var k=document.getElementsByClassName("agile-button")[0];k.setAttribute("disabled","disabled");var b=document.getElementById("agile-error-msg");var o=document.getElementById("agile-form");var d=document.getElementById("agile-form-data");var c={};var l=d.getAttribute("agile-redirect-url");var h=d.getAttribute("agile-api");var j=d.getAttribute("agile-domain");var e={};var n;for(var f=0;f<o.length;f++){var a=o[f].getAttribute("agile-field");var m=o[f].value;if(a&&m){if("address, city, state, country, zip".indexOf(a)!=-1){e[a]=m}else{if(a=="tags"){if(n){n=n+","+m}else{n=m}}else{c[a]=m}}}}e=JSON.stringify(e);if(e.length>2){c.address=e}if(n){c.tags=n}var g=c.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(h,j);_agile.track_page_view()}if(g){_agile.set_email(g)}_agile.create_contact(c,{success:function(i){agile_formCallback(["",b],k,l)},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(c,{success:function(p){agile_formCallback(["",b],k,l)},error:function(p){agile_formCallback(["There was an error in sending data",b],k,l,p)}})}else{agile_formCallback(["There was an error in sending data",b],k,l,i)}}})};var agile_guid={init:function(){this.cookie_name="agile-crm-guid";this.cookie_email="agile-email";this.cookie_original_ref="agile-original-referrer";this.new_guid=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var a=agile_read_cookie(this.cookie_name);if(!a){a=this.generate()}return a},generate:function(){guid=this.random();agile_create_cookie(this.cookie_name,guid,365*5);this.set_original_referrer();this.new_guid=true;return guid},reset:function(){agile_create_cookie(this.cookie_name,"",-1)},set_email:function(a){var b=agile_read_cookie(this.cookie_email);if(!b||(b!=a)){this.email=a;if(b){this.reset();agile_session.reset()}agile_create_cookie(this.cookie_email,this.email,365*5)}},get_email:function(){if(this.email){return this.email}var a=agile_read_cookie(this.cookie_email);return a},set_original_referrer:function(){var a=document.referrer;if(a){agile_create_cookie(this.cookie_original_ref,a,365*5)}}};agile_guid.init();var agile_id={set:function(b,a){this.id=b;this.namespace=a},get:function(){return this.id},getURL:function(){if(!this.namespace||this.namespace=="localhost"){return"http://localhost:8888/core/js/api"}else{return"https://"+this.namespace+"-dot-sandbox-dot-agilecrmbeta.appspot.com/core/js/api"}},getNamespace:function(){return this.namespace}};function agile_getPipelines(b){var a=agile_id.getURL()+"/milestone/get-pipelines?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones(b){var a=agile_id.getURL()+"/contact/get-milestones?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones_by_pipeline(b,c){var a=agile_id.getURL()+"/milestone/get-milestones?callback=?&id="+agile_id.get()+"&pipeline_id="+b;agile_json(a,c)}function agile_addNote(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-note?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getNotes(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-notes?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setProperty(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-property?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/get-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_removeProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/remove-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_addScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/add-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_subtractScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/subtract-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_getScore(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-score?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}var agile_session={init:function(){this.cookie_name="agile-crm-session_id";this.cookie_start_time="agile-crm-session_start_time";this.cookie_duration_secs=60*1000;this.new_session=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var b=agile_read_cookie(this.cookie_name);if(!b){return this.generate()}var a=agile_read_cookie(this.cookie_start_time);var c=new Date().getUTCSeconds();if((c<a)||(c>(a+this.cookie_duration_secs))){return this.generate()}return b},generate:function(){var a=this.random();agile_create_cookie(this.cookie_name,a,0);agile_create_cookie(this.cookie_start_time,new Date().getUTCSeconds(),0);this.new_session=true;return a},reset:function(){agile_create_cookie(this.cookie_name,"",-1);agile_create_cookie(this.cookie_start_time,"",-1)}};agile_session.init();function agile_addTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"add");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/add-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_removeTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"delete");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/remove-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTags(e,c){if(!c){if(!agile_guid.get_email()){return}else{c=agile_guid.get_email()}}var b=agile_read_cookie("agile-tags");var d="email={0}&tags={1}".format(encodeURIComponent(c),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/get-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_addTask(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="task={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/task?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTasks(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-tasks?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_trackPageview(h){var d=agile_guid.get();var e=agile_session.get();var c=document.location.href;if(c!==undefined&&c!=null){c=encodeURIComponent(c)}else{c=""}var a=agile_id.get();var g="";if(agile_session.new_session){var f=document.referrer;if(f!==undefined&&f!=null&&f!="null"){f=encodeURIComponent(f)}else{f=""}g="guid={0}&sid={1}&url={2}&agile={3}&new=1&ref={4}".format(d,e,c,a,f)}else{g="guid={0}&sid={1}&url={2}&agile={3}".format(d,e,c,a)}if(agile_guid.get_email()){g+="&email="+encodeURIComponent(agile_guid.get_email())}var b="https://"+agile_id.getNamespace()+".agilecrm.com/stats?callback=?&"+g;agile_json(b,h)}function agile_removeCommonTags(d,c){var f=d.length;while(--f>=0){var e=c.length;while(--e>=0){if(d[f]&&d[f].trim()==c[e].trim()){d.splice(f,1);f=d.length}}}return d}function agile_cookieTags(b,g){var h=agile_read_cookie("agile-tags");if(!h){if(g=="add"){agile_create_cookie("agile-tags",b,5*365)}return}var e=h.split(",");var a=b.split(",");agile_delete_cookie("agile-tags");if(g=="delete"){var f=agile_removeCommonTags(e,a);if(f.length>0){agile_create_cookie("agile-tags",f.toString(),5*365)}}if(g=="add"){var d=agile_removeCommonTags(a,e);var c=d.length;while(--c>=0){e.push(d[c])}agile_create_cookie("agile-tags",e.toString(),5*365)}return}function agile_formCallback(b,c,a,d){if(d){console.log("AgileCRM form error "+d.error)}b[1].innerHTML=b[0];c.removeAttribute("disabled");setTimeout(function(){b[1].innerHTML="";window.location.replace(a)},1500)}function _agile_load_form_fields(){var a=agile_read_cookie("agile-email");if(!a){return}_agile.get_contact(a,{success:function(f){if(f){var b={};var g=f.properties;for(var e=0;e<g.length;e++){b[g[e].name]=g[e].value}var d=document.getElementById("agile-form");for(var c=0;c<d.length;c++){if(b[d[c].name]){d[c].value=b[d[c].name]}}}},error:function(b){return}})}function _agile_form_tracking(){var a=document.getElementById("agile-form-data").getAttribute("name").split(" ");var b=a[0];var c=a[1];if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,b);_agile.track_page_view()}}function agile_webRules(b){var a=agile_id.getURL()+"/web-rules?callback=?&id="+agile_id.get();agile_json(a,b)}function _agile_execute_web_rules(){_agile_require_js("https://agilegrabbers.appspot.com/demo/agile-webrules-min.js",function(){_agile_webrules()})}function _agile_require_js(d,c){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=d;if((navigator.appVersion).indexOf("MSIE")>0){a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}else{a.onload=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}var b=document.getElementsByTagName("head")[0];b.appendChild(a)}function agile_read_cookie(b){b=agile_id.get()+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function agile_create_cookie(c,e,g){c=agile_id.get()+"-"+c;if(g){var b=new Date();b.setTime(b.getTime()+(g*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}var d="";var f=window.location.hostname.replace(/([a-zA-Z0-9]+.)/,"");if(f.length>5){d=";document=."+f}document.cookie=c+"="+escape(e)+a+"; path=/"+d}function agile_createCookieInAllAgileSubdomains(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/; domain=agilecrm.com"}function agile_delete_cookie(a){agile_create_cookie(a,"",-1)}function agile_enable_console_logging(){var a=false;if(typeof console==="undefined"||!a){console={log:function(){},error:function(){}}}if(typeof(console.log)==="undefined"||!a){console.log=function(){return 0}}if(typeof(console.error)==="undefined"||!a){console.error=function(){return 0}}};
>>>>>>> 8cebfa2... changes forms help text, script
=======
function agile_setAccount(b,a){agile_id.set(b,a);agile_setEmailFromUrl()}function agile_setEmailFromUrl(){if(window.location.href.search("fwd=cd")!==-1){try{var a=decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI("data").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));if(a){agile_guid.set_email(JSON.parse(a).email)}}catch(b){console.log(b.message)}}}function agile_allowedDomains(b){var a=agile_id.getURL()+"/allowed-domains?callback=?&id="+agile_id.get();agile_json(a,b)}var _agile={set_account:function(b,a){agile_setAccount(b,a)},set_email:function(a){agile_setEmail(a)},track_page_view:function(a){agile_trackPageview(a)},create_contact:function(a,b){agile_createContact(a,b)},get_contact:function(a,b){agile_getContact(a,b)},delete_contact:function(a,b){agile_deleteContact(a,b)},add_tag:function(b,c,a){agile_addTag(b,c,a)},remove_tag:function(b,c,a){agile_removeTag(b,c,a)},add_score:function(b,c,a){agile_addScore(b,c,a)},subtract_score:function(b,c,a){agile_subtractScore(b,c,a)},add_note:function(b,c,a){agile_addNote(b,c,a)},set_property:function(b,c,a){agile_setProperty(b,c,a)},add_task:function(b,c,a){agile_addTask(b,c,a)},add_deal:function(b,c,a){agile_addDeal(b,c,a)},get_score:function(b,a){agile_getScore(b,a)},get_tags:function(b,a){agile_getTags(b,a)},get_notes:function(b,a){agile_getNotes(b,a)},get_tasks:function(b,a){agile_getTasks(b,a)},get_deals:function(b,a){agile_getDeals(b,a)},add_campaign:function(b,c,a){agile_addCampaign(b,c,a)},get_campaigns:function(b,a){agile_getCampaigns(b,a)},get_campaign_logs:function(b,a){agile_getCampaignlogs(b,a)},get_workflows:function(a){agile_getWorkflows(a)},get_pipelines:function(a){agile_getPipelines(a)},get_milestones:function(a){agile_getMilestones(a)},get_milestones_by_pipeline:function(a,b){agile_getMilestones_by_pipeline(a,b)},update_contact:function(b,c,a){agile_updateContact(b,c,a)},get_email:function(a){agile_getEmail(a)},create_company:function(a,b){agile_createCompany(a,b)},get_property:function(b,c,a){agile_getProperty(b,c,a)},remove_property:function(b,c,a){agile_removeProperty(b,c,a)},add_property:function(b,c,a){agile_setProperty(b,c,a)},web_rules:function(a){agile_webRules(a)},unsubscribe_campaign:function(b,c,a){agile_unsubscribeCampaign(b,c,a)},allowed_domains:function(a){agile_allowedDomains(a)}};function agile_addCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getCampaigns(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaigns?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getCampaignlogs(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaign-logs?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getWorkflows(b){var a=agile_id.getURL()+"/contacts/get-workflows?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_unsubscribeCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/unsubscribe-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createContact(d,k){var h=[];for(var j in d){if(d.hasOwnProperty(j)&&j!="tags"){h.push(agile_propertyJSON(j,d[j]))}}var g=agile_read_cookie(agile_guid.cookie_original_ref);if(g){h.push(agile_propertyJSON("original_ref",g))}var a=agile_read_cookie("agile-tags");var f={};f.properties=h;if(d.tags){var m=d.tags;var e=m.trim().replace("/ /g"," ");e=e.replace("/, /g",",");f.tags=e.split(",");for(var c=0;c<f.tags.length;c++){f.tags[c]=f.tags[c].trim()}}if(a){agile_delete_cookie("agile-tags");var e=a.trim().replace("/ /g"," ");e=e.replace("/, /g",",");var b=e.split(",");if(f.tags){for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}else{f.tags=[];for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}}var l=agile_id.getURL()+"/contacts?callback=?&id="+agile_id.get()+"&contact="+encodeURIComponent(JSON.stringify(f));agile_json(l,k)}function agile_deleteContact(b,c){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contact/delete?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}function agile_getContact(b,d){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var c="email={0}".format(encodeURIComponent(b));var a=agile_id.getURL()+"/contact/email?callback=?&id="+agile_id.get()+"&"+c;agile_json(a,d)}function agile_updateContact(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contact/update?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createCompany(e,f){var d=[];for(var c in e){if(e.hasOwnProperty(c)){d.push(agile_propertyJSON(c,e[c]))}}var b={};b.properties=d;var a=agile_id.getURL()+"/company?callback=?&id="+agile_id.get()+"&data="+encodeURIComponent(JSON.stringify(b));agile_json(a,f)}function agile_propertyJSON(a,d,c){var b={};if(c==undefined){switch(a){case"first_name":case"last_name":case"email":case"company":case"title":case"name":case"url":case"website":case"address":case"phone":case"original_ref":b.type="SYSTEM";break;default:b.type="CUSTOM";break}}else{b.type=c}b.name=a;b.value=d;return b}var agile_json_timer;function agile_json(a,c){if(!document.body){clearInterval(agile_json_timer);agile_json_timer=setInterval(function(){agile_json(a,c)},100);return}clearInterval(agile_json_timer);var b="json"+(Math.random()*100).toString().replace(/\./g,"");window[b]=function(d){if(d.error){if(c&&typeof(c.error)=="function"){c.error(d)}return}if(c&&typeof(c.success)=="function"){c.success(d)}if(c&&typeof(c)=="function"){c(d)}};document.getElementsByTagName("body")[0].appendChild((function(){var d=document.createElement("script");d.type="application/javascript";d.src=a.replace("callback=?","callback="+b);return d})())}String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})};function agile_addDeal(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="opportunity={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/opportunity?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getDeals(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-deals?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setEmail(a){agile_guid.set_email(a)}function agile_getEmail(c){var b=agile_guid.get_email();var a=agile_id.getURL()+"/email?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}var _agile_synch_form_v2=function(){var f=document.getElementsByClassName("agile-button")[0];f.setAttribute("disabled","disabled");var p=document.getElementById("agile-error-msg");var k=document.getElementById("agile-form");var r=document.getElementById("agile-form-data").getAttribute("name").split(" ");var h={};var g=r[2];var c=r[1];var e=r[0];var q=e+" "+c+" "+g+" ";var l=document.getElementById("agile-form-data").getAttribute("name").replace(q,"");var b={};var d;var o=[];for(var m=0;m<k.length;m++){var s=k[m].getAttribute("name");var j=k[m].value;if(s&&j){if("address, city, state, country, zip".indexOf(s)!=-1){b[s]=j}else{if(s=="tags"){if(d){d=d+","+j}else{d=j}}else{if(s=="note"){var n={};n.subject=k[m].parentNode.parentNode.getElementsByTagName("label")[0].innerHTML;n.description=j;o.push(n)}else{h[s]=j}}}}}b=JSON.stringify(b);if(b.length>2){h.address=b}if(d){if(l){h.tags=d+","+l}else{h.tags=d}}else{if(l){h.tags=l}}var a=h.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,e);_agile.track_page_view()}if(a){_agile.set_email(a)}_agile.create_contact(h,{success:function(t){var u=0;if(o.length>0){for(var i=0;i<o.length;i++){_agile.add_note(o[i],{success:function(v){u++;if(u==o.length){agile_formCallback(["",p],f,g)}},error:function(v){agile_formCallback(["There was an error in sending data",p],f,g,v)}})}}else{agile_formCallback(["",p],f,g)}},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(h,{success:function(u){var v=0;if(o.length>0){for(var t=0;t<o.length;t++){_agile.add_note(o[t],{success:function(w){v++;if(v==o.length){agile_formCallback(["",p],f,g)}},error:function(w){agile_formCallback(["There was an error in sending data",p],f,g,w)}})}}else{agile_formCallback(["",p],f,g)}},error:function(t){agile_formCallback(["There was an error in sending data",p],f,g,t)}})}else{agile_formCallback(["There was an error in sending data",p],f,g,i)}}})};var _agile_synch_form=function(){var k=document.getElementsByClassName("agile-button")[0];k.setAttribute("disabled","disabled");var b=document.getElementById("agile-error-msg");var o=document.getElementById("agile-form");var d=document.getElementById("agile-form-data");var c={};var l=d.getAttribute("agile-redirect-url");var h=d.getAttribute("agile-api");var j=d.getAttribute("agile-domain");var e={};var n;for(var f=0;f<o.length;f++){var a=o[f].getAttribute("agile-field");var m=o[f].value;if(a&&m){if("address, city, state, country, zip".indexOf(a)!=-1){e[a]=m}else{if(a=="tags"){if(n){n=n+","+m}else{n=m}}else{c[a]=m}}}}e=JSON.stringify(e);if(e.length>2){c.address=e}if(n){c.tags=n}var g=c.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(h,j);_agile.track_page_view()}if(g){_agile.set_email(g)}_agile.create_contact(c,{success:function(i){agile_formCallback(["",b],k,l)},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(c,{success:function(p){agile_formCallback(["",b],k,l)},error:function(p){agile_formCallback(["There was an error in sending data",b],k,l,p)}})}else{agile_formCallback(["There was an error in sending data",b],k,l,i)}}})};var agile_guid={init:function(){this.cookie_name="agile-crm-guid";this.cookie_email="agile-email";this.cookie_original_ref="agile-original-referrer";this.new_guid=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var a=agile_read_cookie(this.cookie_name);if(!a){a=this.generate()}return a},generate:function(){guid=this.random();agile_create_cookie(this.cookie_name,guid,365*5);this.set_original_referrer();this.new_guid=true;return guid},reset:function(){agile_create_cookie(this.cookie_name,"",-1)},set_email:function(a){var b=agile_read_cookie(this.cookie_email);if(!b||(b!=a)){this.email=a;if(b){this.reset();agile_session.reset()}agile_create_cookie(this.cookie_email,this.email,365*5)}},get_email:function(){if(this.email){return this.email}var a=agile_read_cookie(this.cookie_email);return a},set_original_referrer:function(){var a=document.referrer;if(a){agile_create_cookie(this.cookie_original_ref,a,365*5)}}};agile_guid.init();var agile_id={set:function(b,a){this.id=b;this.namespace=a},get:function(){return this.id},getURL:function(){if(!this.namespace||this.namespace=="localhost"){return"http://localhost:8888/core/js/api"}else{return"https://"+this.namespace+"-dot-sandbox-dot-agilecrmbeta.appspot.com/core/js/api"}},getNamespace:function(){return this.namespace}};function agile_getPipelines(b){var a=agile_id.getURL()+"/milestone/get-pipelines?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones(b){var a=agile_id.getURL()+"/contact/get-milestones?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones_by_pipeline(b,c){var a=agile_id.getURL()+"/milestone/get-milestones?callback=?&id="+agile_id.get()+"&pipeline_id="+b;agile_json(a,c)}function agile_addNote(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-note?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getNotes(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-notes?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setProperty(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-property?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/get-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_removeProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/remove-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_addScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/add-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_subtractScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/subtract-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_getScore(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-score?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}var agile_session={init:function(){this.cookie_name="agile-crm-session_id";this.cookie_start_time="agile-crm-session_start_time";this.cookie_duration_secs=60*1000;this.new_session=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var b=agile_read_cookie(this.cookie_name);if(!b){return this.generate()}var a=agile_read_cookie(this.cookie_start_time);var c=new Date().getUTCSeconds();if((c<a)||(c>(a+this.cookie_duration_secs))){return this.generate()}return b},generate:function(){var a=this.random();agile_create_cookie(this.cookie_name,a,0);agile_create_cookie(this.cookie_start_time,new Date().getUTCSeconds(),0);this.new_session=true;return a},reset:function(){agile_create_cookie(this.cookie_name,"",-1);agile_create_cookie(this.cookie_start_time,"",-1)}};agile_session.init();function agile_addTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"add");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/add-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_removeTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"delete");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/remove-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTags(e,c){if(!c){if(!agile_guid.get_email()){return}else{c=agile_guid.get_email()}}var b=agile_read_cookie("agile-tags");var d="email={0}&tags={1}".format(encodeURIComponent(c),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/get-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_addTask(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="task={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/task?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTasks(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-tasks?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_trackPageview(h){var d=agile_guid.get();var e=agile_session.get();var c=document.location.href;if(c!==undefined&&c!=null){c=encodeURIComponent(c)}else{c=""}var a=agile_id.get();var g="";if(agile_session.new_session){var f=document.referrer;if(f!==undefined&&f!=null&&f!="null"){f=encodeURIComponent(f)}else{f=""}g="guid={0}&sid={1}&url={2}&agile={3}&new=1&ref={4}".format(d,e,c,a,f)}else{g="guid={0}&sid={1}&url={2}&agile={3}".format(d,e,c,a)}if(agile_guid.get_email()){g+="&email="+encodeURIComponent(agile_guid.get_email())}var b="https://"+agile_id.getNamespace()+".agilecrm.com/stats?callback=?&"+g;agile_json(b,h)}function agile_removeCommonTags(d,c){var f=d.length;while(--f>=0){var e=c.length;while(--e>=0){if(d[f]&&d[f].trim()==c[e].trim()){d.splice(f,1);f=d.length}}}return d}function agile_cookieTags(b,g){var h=agile_read_cookie("agile-tags");if(!h){if(g=="add"){agile_create_cookie("agile-tags",b,5*365)}return}var e=h.split(",");var a=b.split(",");agile_delete_cookie("agile-tags");if(g=="delete"){var f=agile_removeCommonTags(e,a);if(f.length>0){agile_create_cookie("agile-tags",f.toString(),5*365)}}if(g=="add"){var d=agile_removeCommonTags(a,e);var c=d.length;while(--c>=0){e.push(d[c])}agile_create_cookie("agile-tags",e.toString(),5*365)}return}function agile_formCallback(b,c,a,d){if(d){console.log("AgileCRM form error "+d.error)}b[1].innerHTML=b[0];c.removeAttribute("disabled");setTimeout(function(){b[1].innerHTML="";window.location.replace(a)},1500)}function _agile_load_form_fields(){var a=agile_read_cookie("agile-email");if(!a){return}_agile.get_contact(a,{success:function(f){if(f){var b={};var g=f.properties;for(var e=0;e<g.length;e++){b[g[e].name]=g[e].value}var d=document.getElementById("agile-form");for(var c=0;c<d.length;c++){if(b[d[c].name]){d[c].value=b[d[c].name]}}}},error:function(b){return}})}function _agile_form_tracking(){var a=document.getElementById("agile-form-data").getAttribute("name").split(" ");var b=a[0];var c=a[1];if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,b);_agile.track_page_view()}}function agile_webRules(b){var a=agile_id.getURL()+"/web-rules?callback=?&id="+agile_id.get();agile_json(a,b)}function _agile_execute_web_rules(){_agile_require_js("https://agilegrabbers.appspot.com/demo/agile-webrules-min.js",function(){_agile_webrules()})}function _agile_require_js(d,c){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=d;if((navigator.appVersion).indexOf("MSIE")>0){a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}else{a.onload=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}var b=document.getElementsByTagName("head")[0];b.appendChild(a)}function agile_read_cookie(b){b=agile_id.get()+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function agile_create_cookie(c,e,g){c=agile_id.get()+"-"+c;if(g){var b=new Date();b.setTime(b.getTime()+(g*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}var d="";var f=window.location.hostname.replace(/([a-zA-Z0-9]+.)/,"");if(f.length>5){d=";document=."+f}document.cookie=c+"="+escape(e)+a+"; path=/"+d}function agile_createCookieInAllAgileSubdomains(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/; domain=agilecrm.com"}function agile_delete_cookie(a){agile_create_cookie(a,"",-1)}function agile_enable_console_logging(){var a=false;if(typeof console==="undefined"||!a){console={log:function(){},error:function(){}}}if(typeof(console.log)==="undefined"||!a){console.log=function(){return 0}}if(typeof(console.error)==="undefined"||!a){console.error=function(){return 0}}};
>>>>>>> 5b4296f... revert for old forms
=======
function agile_setAccount(b,a){agile_id.set(b,a);agile_setEmailFromUrl()}function agile_setEmailFromUrl(){if(window.location.href.search("fwd=cd")!==-1){try{var a=decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI("data").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));if(a){agile_guid.set_email(JSON.parse(a).email)}}catch(b){console.log(b.message)}}}function agile_allowedDomains(b){var a=agile_id.getURL()+"/allowed-domains?callback=?&id="+agile_id.get();agile_json(a,b)}var _agile={set_account:function(b,a){agile_setAccount(b,a)},set_email:function(a){agile_setEmail(a)},track_page_view:function(a){agile_trackPageview(a)},create_contact:function(a,b){agile_createContact(a,b)},get_contact:function(a,b){agile_getContact(a,b)},delete_contact:function(a,b){agile_deleteContact(a,b)},add_tag:function(b,c,a){agile_addTag(b,c,a)},remove_tag:function(b,c,a){agile_removeTag(b,c,a)},add_score:function(b,c,a){agile_addScore(b,c,a)},subtract_score:function(b,c,a){agile_subtractScore(b,c,a)},add_note:function(b,c,a){agile_addNote(b,c,a)},set_property:function(b,c,a){agile_setProperty(b,c,a)},add_task:function(b,c,a){agile_addTask(b,c,a)},add_deal:function(b,c,a){agile_addDeal(b,c,a)},get_score:function(b,a){agile_getScore(b,a)},get_tags:function(b,a){agile_getTags(b,a)},get_notes:function(b,a){agile_getNotes(b,a)},get_tasks:function(b,a){agile_getTasks(b,a)},get_deals:function(b,a){agile_getDeals(b,a)},add_campaign:function(b,c,a){agile_addCampaign(b,c,a)},get_campaigns:function(b,a){agile_getCampaigns(b,a)},get_campaign_logs:function(b,a){agile_getCampaignlogs(b,a)},get_workflows:function(a){agile_getWorkflows(a)},get_pipelines:function(a){agile_getPipelines(a)},get_milestones:function(a){agile_getMilestones(a)},get_milestones_by_pipeline:function(a,b){agile_getMilestones_by_pipeline(a,b)},update_contact:function(b,c,a){agile_updateContact(b,c,a)},get_email:function(a){agile_getEmail(a)},create_company:function(a,b){agile_createCompany(a,b)},get_property:function(b,c,a){agile_getProperty(b,c,a)},remove_property:function(b,c,a){agile_removeProperty(b,c,a)},add_property:function(b,c,a){agile_setProperty(b,c,a)},web_rules:function(a){agile_webRules(a)},unsubscribe_campaign:function(b,c,a){agile_unsubscribeCampaign(b,c,a)},allowed_domains:function(a){agile_allowedDomains(a)}};function agile_addCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getCampaigns(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaigns?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getCampaignlogs(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaign-logs?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getWorkflows(b){var a=agile_id.getURL()+"/contacts/get-workflows?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_unsubscribeCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/unsubscribe-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createContact(d,k){var h=[];for(var j in d){if(d.hasOwnProperty(j)&&j!="tags"){h.push(agile_propertyJSON(j,d[j]))}}var g=agile_read_cookie(agile_guid.cookie_original_ref);if(g){h.push(agile_propertyJSON("original_ref",g))}var a=agile_read_cookie("agile-tags");var f={};f.properties=h;if(d.tags){var m=d.tags;var e=m.trim().replace("/ /g"," ");e=e.replace("/, /g",",");f.tags=e.split(",");for(var c=0;c<f.tags.length;c++){f.tags[c]=f.tags[c].trim()}}if(a){agile_delete_cookie("agile-tags");var e=a.trim().replace("/ /g"," ");e=e.replace("/, /g",",");var b=e.split(",");if(f.tags){for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}else{f.tags=[];for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}}var l=agile_id.getURL()+"/contacts?callback=?&id="+agile_id.get()+"&contact="+encodeURIComponent(JSON.stringify(f));agile_json(l,k)}function agile_deleteContact(b,c){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contact/delete?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}function agile_getContact(b,d){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var c="email={0}".format(encodeURIComponent(b));var a=agile_id.getURL()+"/contact/email?callback=?&id="+agile_id.get()+"&"+c;agile_json(a,d)}function agile_updateContact(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contact/update?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createCompany(e,f){var d=[];for(var c in e){if(e.hasOwnProperty(c)){d.push(agile_propertyJSON(c,e[c]))}}var b={};b.properties=d;var a=agile_id.getURL()+"/company?callback=?&id="+agile_id.get()+"&data="+encodeURIComponent(JSON.stringify(b));agile_json(a,f)}function agile_propertyJSON(a,d,c){var b={};if(c==undefined){switch(a){case"first_name":case"last_name":case"email":case"company":case"title":case"name":case"url":case"website":case"address":case"phone":case"original_ref":b.type="SYSTEM";break;default:b.type="CUSTOM";break}}else{b.type=c}b.name=a;b.value=d;return b}var agile_json_timer;function agile_json(a,c){if(!document.body){clearInterval(agile_json_timer);agile_json_timer=setInterval(function(){agile_json(a,c)},100);return}clearInterval(agile_json_timer);var b="json"+(Math.random()*100).toString().replace(/\./g,"");window[b]=function(d){if(d.error){if(c&&typeof(c.error)=="function"){c.error(d)}return}if(c&&typeof(c.success)=="function"){c.success(d)}if(c&&typeof(c)=="function"){c(d)}};document.getElementsByTagName("body")[0].appendChild((function(){var d=document.createElement("script");d.type="application/javascript";d.src=a.replace("callback=?","callback="+b);return d})())}String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})};function agile_addDeal(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="opportunity={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/opportunity?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getDeals(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-deals?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setEmail(a){agile_guid.set_email(a)}function agile_getEmail(c){var b=agile_guid.get_email();var a=agile_id.getURL()+"/email?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}var _agile_synch_form_v2=function(){var f=document.getElementsByClassName("agile-button")[0];f.setAttribute("disabled","disabled");var p=document.getElementById("agile-error-msg");var k=document.getElementById("agile-form");var r=document.getElementById("agile-form-data").getAttribute("name").split(" ");var h={};var g=r[2];var c=r[1];var e=r[0];var q=e+" "+c+" "+g+" ";var l=document.getElementById("agile-form-data").getAttribute("name").replace(q,"");var b={};var d;var o=[];for(var m=0;m<k.length;m++){var s=k[m].getAttribute("name");var j=k[m].value;if(s&&j){if("address, city, state, country, zip".indexOf(s)!=-1){b[s]=j}else{if(s=="tags"){if(d){d=d+","+j}else{d=j}}else{if(s=="note"){var n={};n.subject=k[m].parentNode.parentNode.getElementsByTagName("label")[0].innerHTML;n.description=j;o.push(n)}else{h[s]=j}}}}}b=JSON.stringify(b);if(b.length>2){h.address=b}if(d){if(l){h.tags=d+","+l}else{h.tags=d}}else{if(l){h.tags=l}}var a=h.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,e);_agile.track_page_view()}if(a){_agile.set_email(a)}_agile.create_contact(h,{success:function(u){var t=u.id;var v=0;if(o.length>0){for(var i=0;i<o.length;i++){_agile.add_note(o[i],{success:function(w){v++;if(v==o.length){agile_formCallback(["",p],f,g,"",t)}},error:function(w){agile_formCallback(["There was an error in sending data",p],f,g,w)}})}}else{agile_formCallback(["",p],f,g,"",t)}},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(h,{success:function(v){var u=v.id;var w=0;if(o.length>0){for(var t=0;t<o.length;t++){_agile.add_note(o[t],{success:function(x){w++;if(w==o.length){agile_formCallback(["",p],f,g,"",u)}},error:function(x){agile_formCallback(["There was an error in sending data",p],f,g,x)}})}}else{agile_formCallback(["",p],f,g,"",u)}},error:function(t){agile_formCallback(["There was an error in sending data",p],f,g,t)}})}else{agile_formCallback(["There was an error in sending data",p],f,g,i)}}})};var _agile_synch_form=function(){var k=document.getElementsByClassName("agile-button")[0];k.setAttribute("disabled","disabled");var b=document.getElementById("agile-error-msg");var o=document.getElementById("agile-form");var d=document.getElementById("agile-form-data");var c={};var l=d.getAttribute("agile-redirect-url");var h=d.getAttribute("agile-api");var j=d.getAttribute("agile-domain");var e={};var n;for(var f=0;f<o.length;f++){var a=o[f].getAttribute("agile-field");var m=o[f].value;if(a&&m){if("address, city, state, country, zip".indexOf(a)!=-1){e[a]=m}else{if(a=="tags"){if(n){n=n+","+m}else{n=m}}else{c[a]=m}}}}e=JSON.stringify(e);if(e.length>2){c.address=e}if(n){c.tags=n}var g=c.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(h,j);_agile.track_page_view()}if(g){_agile.set_email(g)}_agile.create_contact(c,{success:function(i){agile_formCallback(["",b],k,l)},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(c,{success:function(p){agile_formCallback(["",b],k,l)},error:function(p){agile_formCallback(["There was an error in sending data",b],k,l,p)}})}else{agile_formCallback(["There was an error in sending data",b],k,l,i)}}})};var agile_guid={init:function(){this.cookie_name="agile-crm-guid";this.cookie_email="agile-email";this.cookie_original_ref="agile-original-referrer";this.new_guid=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var a=agile_read_cookie(this.cookie_name);if(!a){a=this.generate()}return a},generate:function(){guid=this.random();agile_create_cookie(this.cookie_name,guid,365*5);this.set_original_referrer();this.new_guid=true;return guid},reset:function(){agile_create_cookie(this.cookie_name,"",-1)},set_email:function(a){var b=agile_read_cookie(this.cookie_email);if(!b||(b!=a)){this.email=a;if(b){this.reset();agile_session.reset()}agile_create_cookie(this.cookie_email,this.email,365*5)}},get_email:function(){if(this.email){return this.email}var a=agile_read_cookie(this.cookie_email);return a},set_original_referrer:function(){var a=document.referrer;if(a){agile_create_cookie(this.cookie_original_ref,a,365*5)}}};agile_guid.init();var agile_id={set:function(b,a){this.id=b;this.namespace=a},get:function(){return this.id},getURL:function(){if(!this.namespace||this.namespace=="localhost"){return"http://localhost:8888/core/js/api"}else{return"https://"+this.namespace+"-dot-sandbox-dot-agilecrmbeta.appspot.com/core/js/api"}},getNamespace:function(){return this.namespace}};function agile_getPipelines(b){var a=agile_id.getURL()+"/milestone/get-pipelines?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones(b){var a=agile_id.getURL()+"/contact/get-milestones?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones_by_pipeline(b,c){var a=agile_id.getURL()+"/milestone/get-milestones?callback=?&id="+agile_id.get()+"&pipeline_id="+b;agile_json(a,c)}function agile_addNote(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-note?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getNotes(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-notes?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setProperty(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-property?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/get-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_removeProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/remove-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_addScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/add-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_subtractScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/subtract-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_getScore(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-score?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}var agile_session={init:function(){this.cookie_name="agile-crm-session_id";this.cookie_start_time="agile-crm-session_start_time";this.cookie_duration_secs=60*1000;this.new_session=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var b=agile_read_cookie(this.cookie_name);if(!b){return this.generate()}var a=agile_read_cookie(this.cookie_start_time);var c=new Date().getUTCSeconds();if((c<a)||(c>(a+this.cookie_duration_secs))){return this.generate()}return b},generate:function(){var a=this.random();agile_create_cookie(this.cookie_name,a,0);agile_create_cookie(this.cookie_start_time,new Date().getUTCSeconds(),0);this.new_session=true;return a},reset:function(){agile_create_cookie(this.cookie_name,"",-1);agile_create_cookie(this.cookie_start_time,"",-1)}};agile_session.init();function agile_addTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"add");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/add-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_removeTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"delete");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/remove-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTags(e,c){if(!c){if(!agile_guid.get_email()){return}else{c=agile_guid.get_email()}}var b=agile_read_cookie("agile-tags");var d="email={0}&tags={1}".format(encodeURIComponent(c),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/get-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_addTask(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="task={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/task?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTasks(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-tasks?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_trackPageview(h){var d=agile_guid.get();var e=agile_session.get();var c=document.location.href;if(c!==undefined&&c!=null){c=encodeURIComponent(c)}else{c=""}var a=agile_id.get();var g="";if(agile_session.new_session){var f=document.referrer;if(f!==undefined&&f!=null&&f!="null"){f=encodeURIComponent(f)}else{f=""}g="guid={0}&sid={1}&url={2}&agile={3}&new=1&ref={4}".format(d,e,c,a,f)}else{g="guid={0}&sid={1}&url={2}&agile={3}".format(d,e,c,a)}if(agile_guid.get_email()){g+="&email="+encodeURIComponent(agile_guid.get_email())}var b="https://"+agile_id.getNamespace()+".agilecrm.com/stats?callback=?&"+g;agile_json(b,h)}function agile_removeCommonTags(d,c){var f=d.length;while(--f>=0){var e=c.length;while(--e>=0){if(d[f]&&d[f].trim()==c[e].trim()){d.splice(f,1);f=d.length}}}return d}function agile_cookieTags(b,g){var h=agile_read_cookie("agile-tags");if(!h){if(g=="add"){agile_create_cookie("agile-tags",b,5*365)}return}var e=h.split(",");var a=b.split(",");agile_delete_cookie("agile-tags");if(g=="delete"){var f=agile_removeCommonTags(e,a);if(f.length>0){agile_create_cookie("agile-tags",f.toString(),5*365)}}if(g=="add"){var d=agile_removeCommonTags(a,e);var c=d.length;while(--c>=0){e.push(d[c])}agile_create_cookie("agile-tags",e.toString(),5*365)}return}function agile_formCallback(b,c,a,g,f){if(g){console.log("AgileCRM form error "+g.error)}if(!b[0]){if(f){var e=document.getElementById("agile-form-data").innerHTML;var d=agile_id.getURL()+"/formsubmit?id="+agile_id.get()+"&contactid="+encodeURIComponent(f)+"&formname="+encodeURIComponent(e);agile_json(d)}}b[1].innerHTML=b[0];c.removeAttribute("disabled");setTimeout(function(){b[1].innerHTML="";window.location.replace(a)},1500)}function _agile_load_form_fields(){var a=agile_read_cookie("agile-email");if(!a){return}_agile.get_contact(a,{success:function(f){if(f){var b={};var g=f.properties;for(var e=0;e<g.length;e++){b[g[e].name]=g[e].value}var d=document.getElementById("agile-form");for(var c=0;c<d.length;c++){if(b[d[c].name]){d[c].value=b[d[c].name]}}}},error:function(b){return}})}function _agile_form_tracking(){var a=document.getElementById("agile-form-data").getAttribute("name").split(" ");var b=a[0];var c=a[1];if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,b);_agile.track_page_view()}}function agile_webRules(b){var a=agile_id.getURL()+"/web-rules?callback=?&id="+agile_id.get();agile_json(a,b)}function _agile_execute_web_rules(){_agile_require_js("https://agilegrabbers.appspot.com/demo/agile-webrules-min.js",function(){_agile_webrules()})}function _agile_require_js(d,c){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=d;if((navigator.appVersion).indexOf("MSIE")>0){a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}else{a.onload=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}var b=document.getElementsByTagName("head")[0];b.appendChild(a)}function agile_read_cookie(b){b=agile_id.get()+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function agile_create_cookie(c,e,g){c=agile_id.get()+"-"+c;if(g){var b=new Date();b.setTime(b.getTime()+(g*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}var d="";var f=window.location.hostname.replace(/([a-zA-Z0-9]+.)/,"");if(f.length>5){d=";document=."+f}document.cookie=c+"="+escape(e)+a+"; path=/"+d}function agile_createCookieInAllAgileSubdomains(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/; domain=agilecrm.com"}function agile_delete_cookie(a){agile_create_cookie(a,"",-1)}function agile_enable_console_logging(){var a=false;if(typeof console==="undefined"||!a){console={log:function(){},error:function(){}}}if(typeof(console.log)==="undefined"||!a){console.log=function(){return 0}}if(typeof(console.error)==="undefined"||!a){console.error=function(){return 0}}};
>>>>>>> ff8d491... form trigger
=======
function agile_setAccount(b,a){agile_id.set(b,a);agile_setEmailFromUrl()}function agile_setEmailFromUrl(){if(window.location.href.search("fwd=cd")!==-1){try{var a=decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI("data").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));if(a){agile_guid.set_email(JSON.parse(a).email)}}catch(b){console.log(b.message)}}}function agile_allowedDomains(b){var a=agile_id.getURL()+"/allowed-domains?callback=?&id="+agile_id.get();agile_json(a,b)}var _agile={set_account:function(b,a){agile_setAccount(b,a)},set_email:function(a){agile_setEmail(a)},track_page_view:function(a){agile_trackPageview(a)},create_contact:function(a,b){agile_createContact(a,b)},get_contact:function(a,b){agile_getContact(a,b)},delete_contact:function(a,b){agile_deleteContact(a,b)},add_tag:function(b,c,a){agile_addTag(b,c,a)},remove_tag:function(b,c,a){agile_removeTag(b,c,a)},add_score:function(b,c,a){agile_addScore(b,c,a)},subtract_score:function(b,c,a){agile_subtractScore(b,c,a)},add_note:function(b,c,a){agile_addNote(b,c,a)},set_property:function(b,c,a){agile_setProperty(b,c,a)},add_task:function(b,c,a){agile_addTask(b,c,a)},add_deal:function(b,c,a){agile_addDeal(b,c,a)},get_score:function(b,a){agile_getScore(b,a)},get_tags:function(b,a){agile_getTags(b,a)},get_notes:function(b,a){agile_getNotes(b,a)},get_tasks:function(b,a){agile_getTasks(b,a)},get_deals:function(b,a){agile_getDeals(b,a)},add_campaign:function(b,c,a){agile_addCampaign(b,c,a)},get_campaigns:function(b,a){agile_getCampaigns(b,a)},get_campaign_logs:function(b,a){agile_getCampaignlogs(b,a)},get_workflows:function(a){agile_getWorkflows(a)},get_pipelines:function(a){agile_getPipelines(a)},get_milestones:function(a){agile_getMilestones(a)},get_milestones_by_pipeline:function(a,b){agile_getMilestones_by_pipeline(a,b)},update_contact:function(b,c,a){agile_updateContact(b,c,a)},get_email:function(a){agile_getEmail(a)},create_company:function(a,b){agile_createCompany(a,b)},get_property:function(b,c,a){agile_getProperty(b,c,a)},remove_property:function(b,c,a){agile_removeProperty(b,c,a)},add_property:function(b,c,a){agile_setProperty(b,c,a)},web_rules:function(a){agile_webRules(a)},unsubscribe_campaign:function(b,c,a){agile_unsubscribeCampaign(b,c,a)},allowed_domains:function(a){agile_allowedDomains(a)}};function agile_addCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getCampaigns(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaigns?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getCampaignlogs(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaign-logs?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getWorkflows(b){var a=agile_id.getURL()+"/contacts/get-workflows?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_unsubscribeCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/unsubscribe-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createContact(d,k){var h=[];for(var j in d){if(d.hasOwnProperty(j)&&j!="tags"){h.push(agile_propertyJSON(j,d[j]))}}var g=agile_read_cookie(agile_guid.cookie_original_ref);if(g){h.push(agile_propertyJSON("original_ref",g))}var a=agile_read_cookie("agile-tags");var f={};f.properties=h;if(d.tags){var m=d.tags;var e=m.trim().replace("/ /g"," ");e=e.replace("/, /g",",");f.tags=e.split(",");for(var c=0;c<f.tags.length;c++){f.tags[c]=f.tags[c].trim()}}if(a){agile_delete_cookie("agile-tags");var e=a.trim().replace("/ /g"," ");e=e.replace("/, /g",",");var b=e.split(",");if(f.tags){for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}else{f.tags=[];for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}}var l=agile_id.getURL()+"/contacts?callback=?&id="+agile_id.get()+"&contact="+encodeURIComponent(JSON.stringify(f));agile_json(l,k)}function agile_deleteContact(b,c){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contact/delete?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}function agile_getContact(b,d){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var c="email={0}".format(encodeURIComponent(b));var a=agile_id.getURL()+"/contact/email?callback=?&id="+agile_id.get()+"&"+c;agile_json(a,d)}function agile_updateContact(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contact/update?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createCompany(e,f){var d=[];for(var c in e){if(e.hasOwnProperty(c)){d.push(agile_propertyJSON(c,e[c]))}}var b={};b.properties=d;var a=agile_id.getURL()+"/company?callback=?&id="+agile_id.get()+"&data="+encodeURIComponent(JSON.stringify(b));agile_json(a,f)}function agile_propertyJSON(a,d,c){var b={};if(c==undefined){switch(a){case"first_name":case"last_name":case"email":case"company":case"title":case"name":case"url":case"website":case"address":case"phone":case"original_ref":b.type="SYSTEM";break;default:b.type="CUSTOM";break}}else{b.type=c}b.name=a;b.value=d;return b}var agile_json_timer;function agile_json(a,c){if(!document.body){clearInterval(agile_json_timer);agile_json_timer=setInterval(function(){agile_json(a,c)},100);return}clearInterval(agile_json_timer);var b="json"+(Math.random()*100).toString().replace(/\./g,"");window[b]=function(d){if(d.error){if(c&&typeof(c.error)=="function"){c.error(d)}return}if(c&&typeof(c.success)=="function"){c.success(d)}if(c&&typeof(c)=="function"){c(d)}};document.getElementsByTagName("body")[0].appendChild((function(){var d=document.createElement("script");d.type="application/javascript";d.src=a.replace("callback=?","callback="+b);return d})())}String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})};function agile_addDeal(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="opportunity={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/opportunity?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getDeals(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-deals?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setEmail(a){agile_guid.set_email(a)}function agile_getEmail(c){var b=agile_guid.get_email();var a=agile_id.getURL()+"/email?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}var _agile_synch_form_v2=function(){var f=document.getElementsByClassName("agile-button")[0];f.setAttribute("disabled","disabled");var p=document.getElementById("agile-error-msg");var k=document.getElementById("agile-form");var r=document.getElementById("agile-form-data").getAttribute("name").split(" ");var h={};var g=r[2];var c=r[1];var e=r[0];var q=e+" "+c+" "+g+" ";var l=document.getElementById("agile-form-data").getAttribute("name").replace(q,"");var b={};var d;var o=[];for(var m=0;m<k.length;m++){var s=k[m].getAttribute("name");var j=k[m].value;if(s&&j){if("address, city, state, country, zip".indexOf(s)!=-1){b[s]=j}else{if(s=="tags"){if(d){d=d+","+j}else{d=j}}else{if(s=="note"){var n={};n.subject=k[m].parentNode.parentNode.getElementsByTagName("label")[0].innerHTML;n.description=j;o.push(n)}else{h[s]=j}}}}}b=JSON.stringify(b);if(b.length>2){h.address=b}if(d){if(l){h.tags=d+","+l}else{h.tags=d}}else{if(l){h.tags=l}}var a=h.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,e);_agile.track_page_view()}if(a){_agile.set_email(a)}_agile.create_contact(h,{success:function(u){var t=u.id;var v=0;if(o.length>0){for(var i=0;i<o.length;i++){_agile.add_note(o[i],{success:function(w){v++;if(v==o.length){agile_formCallback(["",p],f,g,t)}},error:function(w){agile_formCallback(["There was an error in sending data",p],f,g)}})}}else{agile_formCallback(["",p],f,g,t)}},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(h,{success:function(v){var u=v.id;var w=0;if(o.length>0){for(var t=0;t<o.length;t++){_agile.add_note(o[t],{success:function(x){w++;if(w==o.length){agile_formCallback(["",p],f,g,u)}},error:function(x){agile_formCallback(["There was an error in sending data",p],f,g)}})}}else{agile_formCallback(["",p],f,g,u)}},error:function(t){agile_formCallback(["There was an error in sending data",p],f,g)}})}else{agile_formCallback(["There was an error in sending data",p],f,g)}}})};var _agile_synch_form=function(){var k=document.getElementsByClassName("agile-button")[0];k.setAttribute("disabled","disabled");var b=document.getElementById("agile-error-msg");var o=document.getElementById("agile-form");var d=document.getElementById("agile-form-data");var c={};var l=d.getAttribute("agile-redirect-url");var h=d.getAttribute("agile-api");var j=d.getAttribute("agile-domain");var e={};var n;for(var f=0;f<o.length;f++){var a=o[f].getAttribute("agile-field");var m=o[f].value;if(a&&m){if("address, city, state, country, zip".indexOf(a)!=-1){e[a]=m}else{if(a=="tags"){if(n){n=n+","+m}else{n=m}}else{c[a]=m}}}}e=JSON.stringify(e);if(e.length>2){c.address=e}if(n){c.tags=n}var g=c.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(h,j);_agile.track_page_view()}if(g){_agile.set_email(g)}_agile.create_contact(c,{success:function(i){agile_formCallback(["",b],k,l)},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(c,{success:function(p){agile_formCallback(["",b],k,l)},error:function(p){agile_formCallback(["There was an error in sending data",b],k,l)}})}else{agile_formCallback(["There was an error in sending data",b],k,l)}}})};var agile_guid={init:function(){this.cookie_name="agile-crm-guid";this.cookie_email="agile-email";this.cookie_original_ref="agile-original-referrer";this.new_guid=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var a=agile_read_cookie(this.cookie_name);if(!a){a=this.generate()}return a},generate:function(){guid=this.random();agile_create_cookie(this.cookie_name,guid,365*5);this.set_original_referrer();this.new_guid=true;return guid},reset:function(){agile_create_cookie(this.cookie_name,"",-1)},set_email:function(a){var b=agile_read_cookie(this.cookie_email);if(!b||(b!=a)){this.email=a;if(b){this.reset();agile_session.reset()}agile_create_cookie(this.cookie_email,this.email,365*5)}},get_email:function(){if(this.email){return this.email}var a=agile_read_cookie(this.cookie_email);return a},set_original_referrer:function(){var a=document.referrer;if(a){agile_create_cookie(this.cookie_original_ref,a,365*5)}}};agile_guid.init();var agile_id={set:function(b,a){this.id=b;this.namespace=a},get:function(){return this.id},getURL:function(){if(!this.namespace||this.namespace=="localhost"){return"http://localhost:8888/core/js/api"}else{return"https://"+this.namespace+"-dot-sandbox-dot-agilecrmbeta.appspot.com/core/js/api"}},getNamespace:function(){return this.namespace}};function agile_getPipelines(b){var a=agile_id.getURL()+"/milestone/get-pipelines?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones(b){var a=agile_id.getURL()+"/contact/get-milestones?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones_by_pipeline(b,c){var a=agile_id.getURL()+"/milestone/get-milestones?callback=?&id="+agile_id.get()+"&pipeline_id="+b;agile_json(a,c)}function agile_addNote(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-note?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getNotes(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-notes?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setProperty(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-property?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/get-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_removeProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/remove-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_addScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/add-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_subtractScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/subtract-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_getScore(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-score?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}var agile_session={init:function(){this.cookie_name="agile-crm-session_id";this.cookie_start_time="agile-crm-session_start_time";this.cookie_duration_secs=60*1000;this.new_session=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var b=agile_read_cookie(this.cookie_name);if(!b){return this.generate()}var a=agile_read_cookie(this.cookie_start_time);var c=new Date().getUTCSeconds();if((c<a)||(c>(a+this.cookie_duration_secs))){return this.generate()}return b},generate:function(){var a=this.random();agile_create_cookie(this.cookie_name,a,0);agile_create_cookie(this.cookie_start_time,new Date().getUTCSeconds(),0);this.new_session=true;return a},reset:function(){agile_create_cookie(this.cookie_name,"",-1);agile_create_cookie(this.cookie_start_time,"",-1)}};agile_session.init();function agile_addTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"add");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/add-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_removeTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"delete");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/remove-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTags(e,c){if(!c){if(!agile_guid.get_email()){return}else{c=agile_guid.get_email()}}var b=agile_read_cookie("agile-tags");var d="email={0}&tags={1}".format(encodeURIComponent(c),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/get-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_addTask(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="task={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/task?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTasks(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-tasks?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_trackPageview(h){var d=agile_guid.get();var e=agile_session.get();var c=document.location.href;if(c!==undefined&&c!=null){c=encodeURIComponent(c)}else{c=""}var a=agile_id.get();var g="";if(agile_session.new_session){var f=document.referrer;if(f!==undefined&&f!=null&&f!="null"){f=encodeURIComponent(f)}else{f=""}g="guid={0}&sid={1}&url={2}&agile={3}&new=1&ref={4}".format(d,e,c,a,f)}else{g="guid={0}&sid={1}&url={2}&agile={3}".format(d,e,c,a)}if(agile_guid.get_email()){g+="&email="+encodeURIComponent(agile_guid.get_email())}var b="https://"+agile_id.getNamespace()+".agilecrm.com/stats?callback=?&"+g;agile_json(b,h)}function agile_removeCommonTags(d,c){var f=d.length;while(--f>=0){var e=c.length;while(--e>=0){if(d[f]&&d[f].trim()==c[e].trim()){d.splice(f,1);f=d.length}}}return d}function agile_cookieTags(b,g){var h=agile_read_cookie("agile-tags");if(!h){if(g=="add"){agile_create_cookie("agile-tags",b,5*365)}return}var e=h.split(",");var a=b.split(",");agile_delete_cookie("agile-tags");if(g=="delete"){var f=agile_removeCommonTags(e,a);if(f.length>0){agile_create_cookie("agile-tags",f.toString(),5*365)}}if(g=="add"){var d=agile_removeCommonTags(a,e);var c=d.length;while(--c>=0){e.push(d[c])}agile_create_cookie("agile-tags",e.toString(),5*365)}return}function agile_formCallback(b,c,a,f){if(!b[0]){if(f){var e=document.getElementById("agile-form-data").innerHTML;var d=agile_id.getURL()+"/formsubmit?id="+agile_id.get()+"&contactid="+encodeURIComponent(f)+"&formname="+encodeURIComponent(e);agile_json(d)}}b[1].innerHTML=b[0];c.removeAttribute("disabled");setTimeout(function(){b[1].innerHTML="";window.location.replace(a)},1500)}function _agile_load_form_fields(){var a=agile_read_cookie("agile-email");if(!a){return}_agile.get_contact(a,{success:function(f){if(f){var b={};var g=f.properties;for(var e=0;e<g.length;e++){b[g[e].name]=g[e].value}var d=document.getElementById("agile-form");for(var c=0;c<d.length;c++){if(b[d[c].name]){d[c].value=b[d[c].name]}}}},error:function(b){return}})}function _agile_form_tracking(){var a=document.getElementById("agile-form-data").getAttribute("name").split(" ");var b=a[0];var c=a[1];if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,b);_agile.track_page_view()}}function agile_webRules(b){var a=agile_id.getURL()+"/web-rules?callback=?&id="+agile_id.get();agile_json(a,b)}function _agile_execute_web_rules(){_agile_require_js("https://agilegrabbers.appspot.com/demo/agile-webrules-min.js",function(){_agile_webrules()})}function _agile_require_js(d,c){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=d;if((navigator.appVersion).indexOf("MSIE")>0){a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}else{a.onload=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}var b=document.getElementsByTagName("head")[0];b.appendChild(a)}function agile_read_cookie(b){b=agile_id.get()+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function agile_create_cookie(c,e,g){c=agile_id.get()+"-"+c;if(g){var b=new Date();b.setTime(b.getTime()+(g*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}var d="";var f=window.location.hostname.replace(/([a-zA-Z0-9]+.)/,"");if(f.length>5){d=";document=."+f}document.cookie=c+"="+escape(e)+a+"; path=/"+d}function agile_createCookieInAllAgileSubdomains(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/; domain=agilecrm.com"}function agile_delete_cookie(a){agile_create_cookie(a,"",-1)}function agile_enable_console_logging(){var a=false;if(typeof console==="undefined"||!a){console={log:function(){},error:function(){}}}if(typeof(console.log)==="undefined"||!a){console.log=function(){return 0}}if(typeof(console.error)==="undefined"||!a){console.error=function(){return 0}}};
>>>>>>> 106f31a... remove console log for error, unused param
=======
function agile_setAccount(b,a){agile_id.set(b,a);agile_setEmailFromUrl()}function agile_setEmailFromUrl(){if(window.location.href.search("fwd=cd")!==-1){try{var a=decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI("data").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));if(a){agile_guid.set_email(JSON.parse(a).email)}}catch(b){console.log(b.message)}}}function agile_allowedDomains(b){var a=agile_id.getURL()+"/allowed-domains?callback=?&id="+agile_id.get();agile_json(a,b)}var _agile={set_account:function(b,a){agile_setAccount(b,a)},set_email:function(a){agile_setEmail(a)},track_page_view:function(a){agile_trackPageview(a)},create_contact:function(a,b){agile_createContact(a,b)},get_contact:function(a,b){agile_getContact(a,b)},delete_contact:function(a,b){agile_deleteContact(a,b)},add_tag:function(b,c,a){agile_addTag(b,c,a)},remove_tag:function(b,c,a){agile_removeTag(b,c,a)},add_score:function(b,c,a){agile_addScore(b,c,a)},subtract_score:function(b,c,a){agile_subtractScore(b,c,a)},add_note:function(b,c,a){agile_addNote(b,c,a)},set_property:function(b,c,a){agile_setProperty(b,c,a)},add_task:function(b,c,a){agile_addTask(b,c,a)},add_deal:function(b,c,a){agile_addDeal(b,c,a)},get_score:function(b,a){agile_getScore(b,a)},get_tags:function(b,a){agile_getTags(b,a)},get_notes:function(b,a){agile_getNotes(b,a)},get_tasks:function(b,a){agile_getTasks(b,a)},get_deals:function(b,a){agile_getDeals(b,a)},add_campaign:function(b,c,a){agile_addCampaign(b,c,a)},get_campaigns:function(b,a){agile_getCampaigns(b,a)},get_campaign_logs:function(b,a){agile_getCampaignlogs(b,a)},get_workflows:function(a){agile_getWorkflows(a)},get_pipelines:function(a){agile_getPipelines(a)},get_milestones:function(a){agile_getMilestones(a)},get_milestones_by_pipeline:function(a,b){agile_getMilestones_by_pipeline(a,b)},update_contact:function(b,c,a){agile_updateContact(b,c,a)},get_email:function(a){agile_getEmail(a)},create_company:function(a,b){agile_createCompany(a,b)},get_property:function(b,c,a){agile_getProperty(b,c,a)},remove_property:function(b,c,a){agile_removeProperty(b,c,a)},add_property:function(b,c,a){agile_setProperty(b,c,a)},web_rules:function(a){agile_webRules(a)},unsubscribe_campaign:function(b,c,a){agile_unsubscribeCampaign(b,c,a)},allowed_domains:function(a){agile_allowedDomains(a)}};function agile_addCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getCampaigns(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaigns?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getCampaignlogs(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaign-logs?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getWorkflows(b){var a=agile_id.getURL()+"/contacts/get-workflows?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_unsubscribeCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/unsubscribe-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createContact(d,k){var h=[];for(var j in d){if(d.hasOwnProperty(j)&&j!="tags"){h.push(agile_propertyJSON(j,d[j]))}}var g=agile_read_cookie(agile_guid.cookie_original_ref);if(g){h.push(agile_propertyJSON("original_ref",g))}var a=agile_read_cookie("agile-tags");var f={};f.properties=h;if(d.tags){var m=d.tags;var e=m.trim().replace("/ /g"," ");e=e.replace("/, /g",",");f.tags=e.split(",");for(var c=0;c<f.tags.length;c++){f.tags[c]=f.tags[c].trim()}}if(a){agile_delete_cookie("agile-tags");var e=a.trim().replace("/ /g"," ");e=e.replace("/, /g",",");var b=e.split(",");if(f.tags){for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}else{f.tags=[];for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}}var l=agile_id.getURL()+"/contacts?callback=?&id="+agile_id.get()+"&contact="+encodeURIComponent(JSON.stringify(f));agile_json(l,k)}function agile_deleteContact(b,c){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contact/delete?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}function agile_getContact(b,d){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var c="email={0}".format(encodeURIComponent(b));var a=agile_id.getURL()+"/contact/email?callback=?&id="+agile_id.get()+"&"+c;agile_json(a,d)}function agile_updateContact(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contact/update?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createCompany(e,f){var d=[];for(var c in e){if(e.hasOwnProperty(c)){d.push(agile_propertyJSON(c,e[c]))}}var b={};b.properties=d;var a=agile_id.getURL()+"/company?callback=?&id="+agile_id.get()+"&data="+encodeURIComponent(JSON.stringify(b));agile_json(a,f)}function agile_propertyJSON(a,d,c){var b={};if(c==undefined){switch(a){case"first_name":case"last_name":case"email":case"company":case"title":case"name":case"url":case"website":case"address":case"phone":case"original_ref":b.type="SYSTEM";break;default:b.type="CUSTOM";break}}else{b.type=c}b.name=a;b.value=d;return b}var agile_json_timer;function agile_json(a,c){if(!document.body){clearInterval(agile_json_timer);agile_json_timer=setInterval(function(){agile_json(a,c)},100);return}clearInterval(agile_json_timer);var b="json"+(Math.random()*100).toString().replace(/\./g,"");window[b]=function(d){if(d.error){if(c&&typeof(c.error)=="function"){c.error(d)}return}if(c&&typeof(c.success)=="function"){c.success(d)}if(c&&typeof(c)=="function"){c(d)}};document.getElementsByTagName("body")[0].appendChild((function(){var d=document.createElement("script");d.type="application/javascript";d.src=a.replace("callback=?","callback="+b);return d})())}String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})};function agile_addDeal(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="opportunity={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/opportunity?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getDeals(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-deals?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setEmail(a){agile_guid.set_email(a)}function agile_getEmail(c){var b=agile_guid.get_email();var a=agile_id.getURL()+"/email?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}var _agile_synch_form_v2=function(){var f=document.getElementsByClassName("agile-button")[0];f.setAttribute("disabled","disabled");var p=document.getElementById("agile-error-msg");var k=document.getElementById("agile-form");var r=document.getElementById("agile-form-data").getAttribute("name").split(" ");var h={};var g=r[2];var c=r[1];var e=r[0];var q=e+" "+c+" "+g+" ";var l=document.getElementById("agile-form-data").getAttribute("name").replace(q,"");var b={};var d;var o=[];for(var m=0;m<k.length;m++){var s=k[m].getAttribute("name");var j=k[m].value;if(s&&j){if("address, city, state, country, zip".indexOf(s)!=-1){b[s]=j}else{if(s=="tags"){if(d){d=d+","+j}else{d=j}}else{if(s=="note"){var n={};n.subject=k[m].parentNode.parentNode.getElementsByTagName("label")[0].innerHTML;n.description=j;o.push(n)}else{h[s]=j}}}}}b=JSON.stringify(b);if(b.length>2){h.address=b}if(d){if(l){h.tags=d+","+l}else{h.tags=d}}else{if(l){h.tags=l}}var a=h.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,e);_agile.track_page_view()}if(a){_agile.set_email(a)}_agile.create_contact(h,{success:function(u){var t=u.id;var v=0;if(o.length>0){for(var i=0;i<o.length;i++){_agile.add_note(o[i],{success:function(w){v++;if(v==o.length){agile_formCallback(["",p],f,g,t,k)}},error:function(w){agile_formCallback(["There was an error in sending data",p],f,g)}})}}else{agile_formCallback(["",p],f,g,t,k)}},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(h,{success:function(v){var u=v.id;var w=0;if(o.length>0){for(var t=0;t<o.length;t++){_agile.add_note(o[t],{success:function(x){w++;if(w==o.length){agile_formCallback(["",p],f,g,u,k)}},error:function(x){agile_formCallback(["There was an error in sending data",p],f,g)}})}}else{agile_formCallback(["",p],f,g,u,k)}},error:function(t){agile_formCallback(["There was an error in sending data",p],f,g)}})}else{agile_formCallback(["There was an error in sending data",p],f,g)}}})};var _agile_synch_form=function(){var k=document.getElementsByClassName("agile-button")[0];k.setAttribute("disabled","disabled");var b=document.getElementById("agile-error-msg");var o=document.getElementById("agile-form");var d=document.getElementById("agile-form-data");var c={};var l=d.getAttribute("agile-redirect-url");var h=d.getAttribute("agile-api");var j=d.getAttribute("agile-domain");var e={};var n;for(var f=0;f<o.length;f++){var a=o[f].getAttribute("agile-field");var m=o[f].value;if(a&&m){if("address, city, state, country, zip".indexOf(a)!=-1){e[a]=m}else{if(a=="tags"){if(n){n=n+","+m}else{n=m}}else{c[a]=m}}}}e=JSON.stringify(e);if(e.length>2){c.address=e}if(n){c.tags=n}var g=c.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(h,j);_agile.track_page_view()}if(g){_agile.set_email(g)}_agile.create_contact(c,{success:function(i){agile_formCallback(["",b],k,l)},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(c,{success:function(p){agile_formCallback(["",b],k,l)},error:function(p){agile_formCallback(["There was an error in sending data",b],k,l)}})}else{agile_formCallback(["There was an error in sending data",b],k,l)}}})};var agile_guid={init:function(){this.cookie_name="agile-crm-guid";this.cookie_email="agile-email";this.cookie_original_ref="agile-original-referrer";this.new_guid=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var a=agile_read_cookie(this.cookie_name);if(!a){a=this.generate()}return a},generate:function(){guid=this.random();agile_create_cookie(this.cookie_name,guid,365*5);this.set_original_referrer();this.new_guid=true;return guid},reset:function(){agile_create_cookie(this.cookie_name,"",-1)},set_email:function(a){var b=agile_read_cookie(this.cookie_email);if(!b||(b!=a)){this.email=a;if(b){this.reset();agile_session.reset()}agile_create_cookie(this.cookie_email,this.email,365*5)}},get_email:function(){if(this.email){return this.email}var a=agile_read_cookie(this.cookie_email);return a},set_original_referrer:function(){var a=document.referrer;if(a){agile_create_cookie(this.cookie_original_ref,a,365*5)}}};agile_guid.init();var agile_id={set:function(b,a){this.id=b;this.namespace=a},get:function(){return this.id},getURL:function(){if(!this.namespace||this.namespace=="localhost"){return"http://localhost:8888/core/js/api"}else{return"https://"+this.namespace+"-dot-sandbox-dot-agilecrmbeta.appspot.com/core/js/api"}},getNamespace:function(){return this.namespace}};function agile_getPipelines(b){var a=agile_id.getURL()+"/milestone/get-pipelines?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones(b){var a=agile_id.getURL()+"/contact/get-milestones?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones_by_pipeline(b,c){var a=agile_id.getURL()+"/milestone/get-milestones?callback=?&id="+agile_id.get()+"&pipeline_id="+b;agile_json(a,c)}function agile_addNote(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-note?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getNotes(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-notes?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setProperty(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-property?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/get-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_removeProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/remove-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_addScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/add-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_subtractScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/subtract-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_getScore(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-score?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}var agile_session={init:function(){this.cookie_name="agile-crm-session_id";this.cookie_start_time="agile-crm-session_start_time";this.cookie_duration_secs=60*1000;this.new_session=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var b=agile_read_cookie(this.cookie_name);if(!b){return this.generate()}var a=agile_read_cookie(this.cookie_start_time);var c=new Date().getUTCSeconds();if((c<a)||(c>(a+this.cookie_duration_secs))){return this.generate()}return b},generate:function(){var a=this.random();agile_create_cookie(this.cookie_name,a,0);agile_create_cookie(this.cookie_start_time,new Date().getUTCSeconds(),0);this.new_session=true;return a},reset:function(){agile_create_cookie(this.cookie_name,"",-1);agile_create_cookie(this.cookie_start_time,"",-1)}};agile_session.init();function agile_addTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"add");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/add-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_removeTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"delete");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/remove-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTags(e,c){if(!c){if(!agile_guid.get_email()){return}else{c=agile_guid.get_email()}}var b=agile_read_cookie("agile-tags");var d="email={0}&tags={1}".format(encodeURIComponent(c),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/get-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_addTask(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="task={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/task?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTasks(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-tasks?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_trackPageview(h){var d=agile_guid.get();var e=agile_session.get();var c=document.location.href;if(c!==undefined&&c!=null){c=encodeURIComponent(c)}else{c=""}var a=agile_id.get();var g="";if(agile_session.new_session){var f=document.referrer;if(f!==undefined&&f!=null&&f!="null"){f=encodeURIComponent(f)}else{f=""}g="guid={0}&sid={1}&url={2}&agile={3}&new=1&ref={4}".format(d,e,c,a,f)}else{g="guid={0}&sid={1}&url={2}&agile={3}".format(d,e,c,a)}if(agile_guid.get_email()){g+="&email="+encodeURIComponent(agile_guid.get_email())}var b="https://"+agile_id.getNamespace()+".agilecrm.com/stats?callback=?&"+g;agile_json(b,h)}function agile_removeCommonTags(d,c){var f=d.length;while(--f>=0){var e=c.length;while(--e>=0){if(d[f]&&d[f].trim()==c[e].trim()){d.splice(f,1);f=d.length}}}return d}function agile_cookieTags(b,g){var h=agile_read_cookie("agile-tags");if(!h){if(g=="add"){agile_create_cookie("agile-tags",b,5*365)}return}var e=h.split(",");var a=b.split(",");agile_delete_cookie("agile-tags");if(g=="delete"){var f=agile_removeCommonTags(e,a);if(f.length>0){agile_create_cookie("agile-tags",f.toString(),5*365)}}if(g=="add"){var d=agile_removeCommonTags(a,e);var c=d.length;while(--c>=0){e.push(d[c])}agile_create_cookie("agile-tags",e.toString(),5*365)}return}function agile_formCallback(c,d,b,g,a){if(!c[0]){if(g){var f=document.getElementById("agile-form-data").innerHTML;var e=agile_id.getURL()+"/formsubmit?id="+agile_id.get()+"&contactid="+encodeURIComponent(g)+"&formname="+encodeURIComponent(f);agile_json(e)}}c[1].innerHTML=c[0];d.removeAttribute("disabled");setTimeout(function(){c[1].innerHTML="";if(a.getAttribute("action")){a.submit()}else{window.location.replace(b)}},1500)}function _agile_load_form_fields(){var a=agile_read_cookie("agile-email");if(!a){return}_agile.get_contact(a,{success:function(f){if(f){var b={};var g=f.properties;for(var e=0;e<g.length;e++){b[g[e].name]=g[e].value}var d=document.getElementById("agile-form");for(var c=0;c<d.length;c++){if(b[d[c].name]){d[c].value=b[d[c].name]}}}},error:function(b){return}})}function agile_webRules(b){var a=agile_id.getURL()+"/web-rules?callback=?&id="+agile_id.get();agile_json(a,b)}function _agile_execute_web_rules(){_agile_require_js("https://agilegrabbers.appspot.com/demo/agile-webrules-min.js",function(){_agile_webrules()})}function _agile_require_js(d,c){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=d;if((navigator.appVersion).indexOf("MSIE")>0){a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}else{a.onload=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}var b=document.getElementsByTagName("head")[0];b.appendChild(a)}function agile_read_cookie(b){b=agile_id.get()+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function agile_create_cookie(c,e,g){c=agile_id.get()+"-"+c;if(g){var b=new Date();b.setTime(b.getTime()+(g*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}var d="";var f=window.location.hostname.replace(/([a-zA-Z0-9]+.)/,"");if(f.length>5){d=";document=."+f}document.cookie=c+"="+escape(e)+a+"; path=/"+d}function agile_createCookieInAllAgileSubdomains(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/; domain=agilecrm.com"}function agile_delete_cookie(a){agile_create_cookie(a,"",-1)}function agile_enable_console_logging(){var a=false;if(typeof console==="undefined"||!a){console={log:function(){},error:function(){}}}if(typeof(console.log)==="undefined"||!a){console.log=function(){return 0}}if(typeof(console.error)==="undefined"||!a){console.error=function(){return 0}}};
>>>>>>> dc3d7d2... formbuilder changes
=======
function agile_setAccount(b,a){agile_id.set(b,a);agile_setEmailFromUrl()}function agile_setEmailFromUrl(){if(window.location.href.search("fwd=cd")!==-1){try{var a=decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI("data").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));if(a){agile_guid.set_email(JSON.parse(a).email)}}catch(b){console.log(b.message)}}}function agile_allowedDomains(b){var a=agile_id.getURL()+"/allowed-domains?callback=?&id="+agile_id.get();agile_json(a,b)}var _agile={set_account:function(b,a){agile_setAccount(b,a)},set_email:function(a){agile_setEmail(a)},track_page_view:function(a){agile_trackPageview(a)},create_contact:function(a,b){agile_createContact(a,b)},get_contact:function(a,b){agile_getContact(a,b)},delete_contact:function(a,b){agile_deleteContact(a,b)},add_tag:function(b,c,a){agile_addTag(b,c,a)},remove_tag:function(b,c,a){agile_removeTag(b,c,a)},add_score:function(b,c,a){agile_addScore(b,c,a)},subtract_score:function(b,c,a){agile_subtractScore(b,c,a)},add_note:function(b,c,a){agile_addNote(b,c,a)},set_property:function(b,c,a){agile_setProperty(b,c,a)},add_task:function(b,c,a){agile_addTask(b,c,a)},add_deal:function(b,c,a){agile_addDeal(b,c,a)},get_score:function(b,a){agile_getScore(b,a)},get_tags:function(b,a){agile_getTags(b,a)},get_notes:function(b,a){agile_getNotes(b,a)},get_tasks:function(b,a){agile_getTasks(b,a)},get_deals:function(b,a){agile_getDeals(b,a)},add_campaign:function(b,c,a){agile_addCampaign(b,c,a)},get_campaigns:function(b,a){agile_getCampaigns(b,a)},get_campaign_logs:function(b,a){agile_getCampaignlogs(b,a)},get_workflows:function(a){agile_getWorkflows(a)},get_pipelines:function(a){agile_getPipelines(a)},get_milestones:function(a){agile_getMilestones(a)},get_milestones_by_pipeline:function(a,b){agile_getMilestones_by_pipeline(a,b)},update_contact:function(b,c,a){agile_updateContact(b,c,a)},get_email:function(a){agile_getEmail(a)},create_company:function(a,b){agile_createCompany(a,b)},get_property:function(b,c,a){agile_getProperty(b,c,a)},remove_property:function(b,c,a){agile_removeProperty(b,c,a)},add_property:function(b,c,a){agile_setProperty(b,c,a)},web_rules:function(a){agile_webRules(a)},unsubscribe_campaign:function(b,c,a){agile_unsubscribeCampaign(b,c,a)},allowed_domains:function(a){agile_allowedDomains(a)}};function agile_addCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getCampaigns(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaigns?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getCampaignlogs(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaign-logs?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getWorkflows(b){var a=agile_id.getURL()+"/contacts/get-workflows?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_unsubscribeCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/unsubscribe-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createContact(d,k){var h=[];for(var j in d){if(d.hasOwnProperty(j)&&j!="tags"){h.push(agile_propertyJSON(j,d[j]))}}var g=agile_read_cookie(agile_guid.cookie_original_ref);if(g){h.push(agile_propertyJSON("original_ref",g))}var a=agile_read_cookie("agile-tags");var f={};f.properties=h;if(d.tags){var m=d.tags;var e=m.trim().replace("/ /g"," ");e=e.replace("/, /g",",");f.tags=e.split(",");for(var c=0;c<f.tags.length;c++){f.tags[c]=f.tags[c].trim()}}if(a){agile_delete_cookie("agile-tags");var e=a.trim().replace("/ /g"," ");e=e.replace("/, /g",",");var b=e.split(",");if(f.tags){for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}else{f.tags=[];for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}}var l=agile_id.getURL()+"/contacts?callback=?&id="+agile_id.get()+"&contact="+encodeURIComponent(JSON.stringify(f));agile_json(l,k)}function agile_deleteContact(b,c){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contact/delete?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}function agile_getContact(b,d){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var c="email={0}".format(encodeURIComponent(b));var a=agile_id.getURL()+"/contact/email?callback=?&id="+agile_id.get()+"&"+c;agile_json(a,d)}function agile_updateContact(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contact/update?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createCompany(e,f){var d=[];for(var c in e){if(e.hasOwnProperty(c)){d.push(agile_propertyJSON(c,e[c]))}}var b={};b.properties=d;var a=agile_id.getURL()+"/company?callback=?&id="+agile_id.get()+"&data="+encodeURIComponent(JSON.stringify(b));agile_json(a,f)}function agile_propertyJSON(a,d,c){var b={};if(c==undefined){switch(a){case"first_name":case"last_name":case"email":case"company":case"title":case"name":case"url":case"website":case"address":case"phone":case"original_ref":b.type="SYSTEM";break;default:b.type="CUSTOM";break}}else{b.type=c}b.name=a;b.value=d;return b}var agile_json_timer;function agile_json(a,c){if(!document.body){clearInterval(agile_json_timer);agile_json_timer=setInterval(function(){agile_json(a,c)},100);return}clearInterval(agile_json_timer);var b="json"+(Math.random()*100).toString().replace(/\./g,"");window[b]=function(d){if(d.error){if(c&&typeof(c.error)=="function"){c.error(d)}return}if(c&&typeof(c.success)=="function"){c.success(d)}if(c&&typeof(c)=="function"){c(d)}};document.getElementsByTagName("body")[0].appendChild((function(){var d=document.createElement("script");d.type="application/javascript";d.src=a.replace("callback=?","callback="+b);return d})())}String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})};function agile_addDeal(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="opportunity={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/opportunity?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getDeals(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-deals?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setEmail(a){agile_guid.set_email(a)}function agile_getEmail(c){var b=agile_guid.get_email();var a=agile_id.getURL()+"/email?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}var _agile_synch_form_v2=function(){var f=document.getElementsByClassName("agile-button")[0];f.setAttribute("disabled","disabled");var p=document.getElementById("agile-error-msg");var k=document.getElementById("agile-form");var r=document.getElementById("agile-form-data").getAttribute("name").split(" ");var h={};var g=r[2];var c=r[1];var e=r[0];var q=e+" "+c+" "+g+" ";var l=document.getElementById("agile-form-data").getAttribute("name").replace(q,"");var b={};var d;var o=[];for(var m=0;m<k.length;m++){var s=k[m].getAttribute("name");var j=k[m].value;if(s&&j){if("address, city, state, country, zip".indexOf(s)!=-1){b[s]=j}else{if(s=="tags"){if(d){d=d+","+j}else{d=j}}else{if(s=="note"){var n={};n.subject=k[m].parentNode.parentNode.getElementsByTagName("label")[0].innerHTML;n.description=j;o.push(n)}else{h[s]=j}}}}}b=JSON.stringify(b);if(b.length>2){h.address=b}if(d){if(l){h.tags=d+","+l}else{h.tags=d}}else{if(l){h.tags=l}}var a=h.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,e);_agile.track_page_view()}if(a){_agile.set_email(a)}_agile.create_contact(h,{success:function(u){var t=u.id;var v=0;if(o.length>0){for(var i=0;i<o.length;i++){_agile.add_note(o[i],{success:function(w){v++;if(v==o.length){agile_formCallback(["",p],f,g,t,k)}},error:function(w){agile_formCallback(["There was an error in sending data",p],f,g)}})}}else{agile_formCallback(["",p],f,g,t,k)}},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(h,{success:function(v){var u=v.id;var w=0;if(o.length>0){for(var t=0;t<o.length;t++){_agile.add_note(o[t],{success:function(x){w++;if(w==o.length){agile_formCallback(["",p],f,g,u,k)}},error:function(x){agile_formCallback(["There was an error in sending data",p],f,g)}})}}else{agile_formCallback(["",p],f,g,u,k)}},error:function(t){agile_formCallback(["There was an error in sending data",p],f,g)}})}else{agile_formCallback(["There was an error in sending data",p],f,g)}}})};var _agile_synch_form=function(){var k=document.getElementsByClassName("agile-button")[0];k.setAttribute("disabled","disabled");var b=document.getElementById("agile-error-msg");var o=document.getElementById("agile-form");var d=document.getElementById("agile-form-data");var c={};var l=d.getAttribute("agile-redirect-url");var h=d.getAttribute("agile-api");var j=d.getAttribute("agile-domain");var e={};var n;for(var f=0;f<o.length;f++){var a=o[f].getAttribute("agile-field");var m=o[f].value;if(a&&m){if("address, city, state, country, zip".indexOf(a)!=-1){e[a]=m}else{if(a=="tags"){if(n){n=n+","+m}else{n=m}}else{c[a]=m}}}}e=JSON.stringify(e);if(e.length>2){c.address=e}if(n){c.tags=n}var g=c.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(h,j);_agile.track_page_view()}if(g){_agile.set_email(g)}_agile.create_contact(c,{success:function(i){agile_formCallback(["",b],k,l)},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(c,{success:function(p){agile_formCallback(["",b],k,l)},error:function(p){agile_formCallback(["There was an error in sending data",b],k,l)}})}else{agile_formCallback(["There was an error in sending data",b],k,l)}}})};var agile_guid={init:function(){this.cookie_name="agile-crm-guid";this.cookie_email="agile-email";this.cookie_original_ref="agile-original-referrer";this.new_guid=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var a=agile_read_cookie(this.cookie_name);if(!a){a=this.generate()}return a},generate:function(){guid=this.random();agile_create_cookie(this.cookie_name,guid,365*5);this.set_original_referrer();this.new_guid=true;return guid},reset:function(){agile_create_cookie(this.cookie_name,"",-1)},set_email:function(a){var b=agile_read_cookie(this.cookie_email);if(!b||(b!=a)){this.email=a;if(b){this.reset();agile_session.reset()}agile_create_cookie(this.cookie_email,this.email,365*5)}},get_email:function(){if(this.email){return this.email}var a=agile_read_cookie(this.cookie_email);return a},set_original_referrer:function(){var a=document.referrer;if(a){agile_create_cookie(this.cookie_original_ref,a,365*5)}}};agile_guid.init();var agile_id={set:function(b,a){this.id=b;this.namespace=a},get:function(){return this.id},getURL:function(){if(!this.namespace||this.namespace=="localhost"){return"http://localhost:8888/core/js/api"}else{return"https://"+this.namespace+"-dot-sandbox-dot-agilecrmbeta.appspot.com/core/js/api"}},getNamespace:function(){return this.namespace}};function agile_getPipelines(b){var a=agile_id.getURL()+"/milestone/get-pipelines?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones(b){var a=agile_id.getURL()+"/contact/get-milestones?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones_by_pipeline(b,c){var a=agile_id.getURL()+"/milestone/get-milestones?callback=?&id="+agile_id.get()+"&pipeline_id="+b;agile_json(a,c)}function agile_addNote(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-note?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getNotes(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-notes?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setProperty(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-property?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/get-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_removeProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/remove-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_addScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/add-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_subtractScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/subtract-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_getScore(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-score?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}var agile_session={init:function(){this.cookie_name="agile-crm-session_id";this.cookie_start_time="agile-crm-session_start_time";this.cookie_duration_secs=60*1000;this.new_session=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var b=agile_read_cookie(this.cookie_name);if(!b){return this.generate()}var a=agile_read_cookie(this.cookie_start_time);var c=new Date().getUTCSeconds();if((c<a)||(c>(a+this.cookie_duration_secs))){return this.generate()}return b},generate:function(){var a=this.random();agile_create_cookie(this.cookie_name,a,0);agile_create_cookie(this.cookie_start_time,new Date().getUTCSeconds(),0);this.new_session=true;return a},reset:function(){agile_create_cookie(this.cookie_name,"",-1);agile_create_cookie(this.cookie_start_time,"",-1)}};agile_session.init();function agile_addTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"add");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/add-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_removeTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"delete");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/remove-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTags(e,c){if(!c){if(!agile_guid.get_email()){return}else{c=agile_guid.get_email()}}var b=agile_read_cookie("agile-tags");var d="email={0}&tags={1}".format(encodeURIComponent(c),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/get-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_addTask(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="task={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/task?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTasks(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-tasks?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_trackPageview(h){var d=agile_guid.get();var e=agile_session.get();var c=document.location.href;if(c!==undefined&&c!=null){c=encodeURIComponent(c)}else{c=""}var a=agile_id.get();var g="";if(agile_session.new_session){var f=document.referrer;if(f!==undefined&&f!=null&&f!="null"){f=encodeURIComponent(f)}else{f=""}g="guid={0}&sid={1}&url={2}&agile={3}&new=1&ref={4}".format(d,e,c,a,f)}else{g="guid={0}&sid={1}&url={2}&agile={3}".format(d,e,c,a)}if(agile_guid.get_email()){g+="&email="+encodeURIComponent(agile_guid.get_email())}var b="https://"+agile_id.getNamespace()+".agilecrm.com/stats?callback=?&"+g;agile_json(b,h)}function agile_removeCommonTags(d,c){var f=d.length;while(--f>=0){var e=c.length;while(--e>=0){if(d[f]&&d[f].trim()==c[e].trim()){d.splice(f,1);f=d.length}}}return d}function agile_cookieTags(b,g){var h=agile_read_cookie("agile-tags");if(!h){if(g=="add"){agile_create_cookie("agile-tags",b,5*365)}return}var e=h.split(",");var a=b.split(",");agile_delete_cookie("agile-tags");if(g=="delete"){var f=agile_removeCommonTags(e,a);if(f.length>0){agile_create_cookie("agile-tags",f.toString(),5*365)}}if(g=="add"){var d=agile_removeCommonTags(a,e);var c=d.length;while(--c>=0){e.push(d[c])}agile_create_cookie("agile-tags",e.toString(),5*365)}return}function agile_formCallback(c,d,b,g,a){if(!c[0]){if(g){var f=document.getElementById("agile-form-data").innerHTML;var e=agile_id.getURL()+"/formsubmit?id="+agile_id.get()+"&contactid="+encodeURIComponent(g)+"&formname="+encodeURIComponent(f);agile_json(e)}}c[1].innerHTML=c[0];d.removeAttribute("disabled");setTimeout(function(){c[1].innerHTML="";if(a&&a.getAttribute("action")){a.submit()}else{window.location.replace(b)}},1500)}function _agile_load_form_fields(){var a=agile_read_cookie("agile-email");if(!a){return}_agile.get_contact(a,{success:function(f){if(f){var b={};var g=f.properties;for(var e=0;e<g.length;e++){b[g[e].name]=g[e].value}var d=document.getElementById("agile-form");for(var c=0;c<d.length;c++){if(b[d[c].name]){d[c].value=b[d[c].name]}}}},error:function(b){return}})}function agile_webRules(b){var a=agile_id.getURL()+"/web-rules?callback=?&id="+agile_id.get();agile_json(a,b)}function _agile_execute_web_rules(){_agile_require_js("https://agilegrabbers.appspot.com/demo/agile-webrules-min.js",function(){_agile_webrules()})}function _agile_require_js(d,c){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=d;if((navigator.appVersion).indexOf("MSIE")>0){a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}else{a.onload=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}var b=document.getElementsByTagName("head")[0];b.appendChild(a)}function agile_read_cookie(b){b=agile_id.get()+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function agile_create_cookie(c,e,g){c=agile_id.get()+"-"+c;if(g){var b=new Date();b.setTime(b.getTime()+(g*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}var d="";var f=window.location.hostname.replace(/([a-zA-Z0-9]+.)/,"");if(f.length>5){d=";document=."+f}document.cookie=c+"="+escape(e)+a+"; path=/"+d}function agile_createCookieInAllAgileSubdomains(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/; domain=agilecrm.com"}function agile_delete_cookie(a){agile_create_cookie(a,"",-1)}function agile_enable_console_logging(){var a=false;if(typeof console==="undefined"||!a){console={log:function(){},error:function(){}}}if(typeof(console.log)==="undefined"||!a){console.log=function(){return 0}}if(typeof(console.error)==="undefined"||!a){console.error=function(){return 0}}};
>>>>>>> ba28fbd... support for old forms
=======
function agile_setAccount(b,a){agile_id.set(b,a);agile_setEmailFromUrl()}function agile_setEmailFromUrl(){if(window.location.href.search("fwd=cd")!==-1){try{var a=decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI("data").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));if(a){agile_guid.set_email(JSON.parse(a).email)}}catch(b){console.log(b.message)}}}function agile_allowedDomains(b){var a=agile_id.getURL()+"/allowed-domains?callback=?&id="+agile_id.get();agile_json(a,b)}var _agile={set_account:function(b,a){agile_setAccount(b,a)},set_email:function(a){agile_setEmail(a)},track_page_view:function(a){agile_trackPageview(a)},create_contact:function(a,b){agile_createContact(a,b)},get_contact:function(a,b){agile_getContact(a,b)},delete_contact:function(a,b){agile_deleteContact(a,b)},add_tag:function(b,c,a){agile_addTag(b,c,a)},remove_tag:function(b,c,a){agile_removeTag(b,c,a)},add_score:function(b,c,a){agile_addScore(b,c,a)},subtract_score:function(b,c,a){agile_subtractScore(b,c,a)},add_note:function(b,c,a){agile_addNote(b,c,a)},set_property:function(b,c,a){agile_setProperty(b,c,a)},add_task:function(b,c,a){agile_addTask(b,c,a)},add_deal:function(b,c,a){agile_addDeal(b,c,a)},get_score:function(b,a){agile_getScore(b,a)},get_tags:function(b,a){agile_getTags(b,a)},get_notes:function(b,a){agile_getNotes(b,a)},get_tasks:function(b,a){agile_getTasks(b,a)},get_deals:function(b,a){agile_getDeals(b,a)},add_campaign:function(b,c,a){agile_addCampaign(b,c,a)},get_campaigns:function(b,a){agile_getCampaigns(b,a)},get_campaign_logs:function(b,a){agile_getCampaignlogs(b,a)},get_workflows:function(a){agile_getWorkflows(a)},get_pipelines:function(a){agile_getPipelines(a)},get_milestones:function(a){agile_getMilestones(a)},get_milestones_by_pipeline:function(a,b){agile_getMilestones_by_pipeline(a,b)},update_contact:function(b,c,a){agile_updateContact(b,c,a)},get_email:function(a){agile_getEmail(a)},create_company:function(a,b){agile_createCompany(a,b)},get_property:function(b,c,a){agile_getProperty(b,c,a)},remove_property:function(b,c,a){agile_removeProperty(b,c,a)},add_property:function(b,c,a){agile_setProperty(b,c,a)},web_rules:function(a){agile_webRules(a)},unsubscribe_campaign:function(b,c,a){agile_unsubscribeCampaign(b,c,a)},allowed_domains:function(a){agile_allowedDomains(a)}};function agile_addCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getCampaigns(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaigns?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getCampaignlogs(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaign-logs?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getWorkflows(b){var a=agile_id.getURL()+"/contacts/get-workflows?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_unsubscribeCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/unsubscribe-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createContact(d,k){var h=[];for(var j in d){if(d.hasOwnProperty(j)&&j!="tags"){h.push(agile_propertyJSON(j,d[j]))}}var g=agile_read_cookie(agile_guid.cookie_original_ref);if(g){h.push(agile_propertyJSON("original_ref",g))}var a=agile_read_cookie("agile-tags");var f={};f.properties=h;if(d.tags){var m=d.tags;var e=m.trim().replace("/ /g"," ");e=e.replace("/, /g",",");f.tags=e.split(",");for(var c=0;c<f.tags.length;c++){f.tags[c]=f.tags[c].trim()}}if(a){agile_delete_cookie("agile-tags");var e=a.trim().replace("/ /g"," ");e=e.replace("/, /g",",");var b=e.split(",");if(f.tags){for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}else{f.tags=[];for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}}var l=agile_id.getURL()+"/contacts?callback=?&id="+agile_id.get()+"&contact="+encodeURIComponent(JSON.stringify(f));agile_json(l,k)}function agile_deleteContact(b,c){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contact/delete?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}function agile_getContact(b,d){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var c="email={0}".format(encodeURIComponent(b));var a=agile_id.getURL()+"/contact/email?callback=?&id="+agile_id.get()+"&"+c;agile_json(a,d)}function agile_updateContact(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contact/update?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createCompany(e,f){var d=[];for(var c in e){if(e.hasOwnProperty(c)){d.push(agile_propertyJSON(c,e[c]))}}var b={};b.properties=d;var a=agile_id.getURL()+"/company?callback=?&id="+agile_id.get()+"&data="+encodeURIComponent(JSON.stringify(b));agile_json(a,f)}function agile_propertyJSON(a,d,c){var b={};if(c==undefined){switch(a){case"first_name":case"last_name":case"email":case"company":case"title":case"name":case"url":case"website":case"address":case"phone":case"original_ref":b.type="SYSTEM";break;default:b.type="CUSTOM";break}}else{b.type=c}b.name=a;b.value=d;return b}var agile_json_timer;function agile_json(a,c){if(!document.body){clearInterval(agile_json_timer);agile_json_timer=setInterval(function(){agile_json(a,c)},100);return}clearInterval(agile_json_timer);var b="json"+(Math.random()*100).toString().replace(/\./g,"");window[b]=function(d){if(d.error){if(c&&typeof(c.error)=="function"){c.error(d)}return}if(c&&typeof(c.success)=="function"){c.success(d)}if(c&&typeof(c)=="function"){c(d)}};document.getElementsByTagName("body")[0].appendChild((function(){var d=document.createElement("script");d.type="application/javascript";d.src=a.replace("callback=?","callback="+b);return d})())}String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})};function agile_addDeal(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="opportunity={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/opportunity?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getDeals(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-deals?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setEmail(a){agile_guid.set_email(a)}function agile_getEmail(c){var b=agile_guid.get_email();var a=agile_id.getURL()+"/email?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}var _agile_synch_form_v2=function(){var f=document.getElementsByClassName("agile-button")[0];f.setAttribute("disabled","disabled");var p=document.getElementById("agile-error-msg");var k=document.getElementById("agile-form");var r=document.getElementById("agile-form-data").getAttribute("name").split(" ");var h={};var g=r[2];var c=r[1];var e=r[0];var q=e+" "+c+" "+g+" ";var l=document.getElementById("agile-form-data").getAttribute("name").replace(q,"");var b={};var d;var o=[];for(var m=0;m<k.length;m++){var s=k[m].getAttribute("name");var j=k[m].value;if(s&&j){if("address, city, state, country, zip".indexOf(s)!=-1){b[s]=j}else{if(s=="tags"){if(d){d=d+","+j}else{d=j}}else{if(s=="note"){var n={};n.subject=k[m].parentNode.parentNode.getElementsByTagName("label")[0].innerHTML;n.description=j;o.push(n)}else{h[s]=j}}}}}b=JSON.stringify(b);if(b.length>2){h.address=b}if(d){if(l){h.tags=d+","+l}else{h.tags=d}}else{if(l){h.tags=l}}var a=h.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,e);_agile.track_page_view()}if(a){_agile.set_email(a)}_agile.create_contact(h,{success:function(u){var t=u.id;var v=0;if(o.length>0){for(var i=0;i<o.length;i++){_agile.add_note(o[i],{success:function(w){v++;if(v==o.length){agile_formCallback(["",p],f,g,k,t)}},error:function(w){agile_formCallback(["There was an error in sending data",p],f,g,k)}})}}else{agile_formCallback(["",p],f,g,k,t)}},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(h,{success:function(v){var u=v.id;var w=0;if(o.length>0){for(var t=0;t<o.length;t++){_agile.add_note(o[t],{success:function(x){w++;if(w==o.length){agile_formCallback(["",p],f,g,k,u)}},error:function(x){agile_formCallback(["There was an error in sending data",p],f,g,k)}})}}else{agile_formCallback(["",p],f,g,k,u)}},error:function(t){agile_formCallback(["There was an error in sending data",p],f,g,k)}})}else{agile_formCallback(["There was an error in sending data",p],f,g,k)}}})};var _agile_synch_form=function(){var k=document.getElementsByClassName("agile-button")[0];k.setAttribute("disabled","disabled");var b=document.getElementById("agile-error-msg");var o=document.getElementById("agile-form");var d=document.getElementById("agile-form-data");var c={};var l=d.getAttribute("agile-redirect-url");var h=d.getAttribute("agile-api");var j=d.getAttribute("agile-domain");var e={};var n;for(var f=0;f<o.length;f++){var a=o[f].getAttribute("agile-field");var m=o[f].value;if(a&&m){if("address, city, state, country, zip".indexOf(a)!=-1){e[a]=m}else{if(a=="tags"){if(n){n=n+","+m}else{n=m}}else{c[a]=m}}}}e=JSON.stringify(e);if(e.length>2){c.address=e}if(n){c.tags=n}var g=c.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(h,j);_agile.track_page_view()}if(g){_agile.set_email(g)}_agile.create_contact(c,{success:function(i){agile_formCallback(["",b],k,l)},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(c,{success:function(p){agile_formCallback(["",b],k,l)},error:function(p){agile_formCallback(["There was an error in sending data",b],k,l)}})}else{agile_formCallback(["There was an error in sending data",b],k,l)}}})};var agile_guid={init:function(){this.cookie_name="agile-crm-guid";this.cookie_email="agile-email";this.cookie_original_ref="agile-original-referrer";this.new_guid=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var a=agile_read_cookie(this.cookie_name);if(!a){a=this.generate()}return a},generate:function(){guid=this.random();agile_create_cookie(this.cookie_name,guid,365*5);this.set_original_referrer();this.new_guid=true;return guid},reset:function(){agile_create_cookie(this.cookie_name,"",-1)},set_email:function(a){var b=agile_read_cookie(this.cookie_email);if(!b||(b!=a)){this.email=a;if(b){this.reset();agile_session.reset()}agile_create_cookie(this.cookie_email,this.email,365*5)}},get_email:function(){if(this.email){return this.email}var a=agile_read_cookie(this.cookie_email);return a},set_original_referrer:function(){var a=document.referrer;if(a){agile_create_cookie(this.cookie_original_ref,a,365*5)}}};agile_guid.init();var agile_id={set:function(b,a){this.id=b;this.namespace=a},get:function(){return this.id},getURL:function(){if(!this.namespace||this.namespace=="localhost"){return"http://localhost:8888/core/js/api"}else{return"https://"+this.namespace+"-dot-sandbox-dot-agilecrmbeta.appspot.com/core/js/api"}},getNamespace:function(){return this.namespace}};function agile_getPipelines(b){var a=agile_id.getURL()+"/milestone/get-pipelines?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones(b){var a=agile_id.getURL()+"/contact/get-milestones?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones_by_pipeline(b,c){var a=agile_id.getURL()+"/milestone/get-milestones?callback=?&id="+agile_id.get()+"&pipeline_id="+b;agile_json(a,c)}function agile_addNote(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-note?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getNotes(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-notes?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setProperty(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-property?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/get-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_removeProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/remove-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_addScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/add-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_subtractScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/subtract-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_getScore(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-score?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}var agile_session={init:function(){this.cookie_name="agile-crm-session_id";this.cookie_start_time="agile-crm-session_start_time";this.cookie_duration_secs=60*1000;this.new_session=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var b=agile_read_cookie(this.cookie_name);if(!b){return this.generate()}var a=agile_read_cookie(this.cookie_start_time);var c=new Date().getUTCSeconds();if((c<a)||(c>(a+this.cookie_duration_secs))){return this.generate()}return b},generate:function(){var a=this.random();agile_create_cookie(this.cookie_name,a,0);agile_create_cookie(this.cookie_start_time,new Date().getUTCSeconds(),0);this.new_session=true;return a},reset:function(){agile_create_cookie(this.cookie_name,"",-1);agile_create_cookie(this.cookie_start_time,"",-1)}};agile_session.init();function agile_addTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"add");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/add-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_removeTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"delete");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/remove-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTags(e,c){if(!c){if(!agile_guid.get_email()){return}else{c=agile_guid.get_email()}}var b=agile_read_cookie("agile-tags");var d="email={0}&tags={1}".format(encodeURIComponent(c),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/get-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_addTask(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="task={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/task?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTasks(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-tasks?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_trackPageview(h){var d=agile_guid.get();var e=agile_session.get();var c=document.location.href;if(c!==undefined&&c!=null){c=encodeURIComponent(c)}else{c=""}var a=agile_id.get();var g="";if(agile_session.new_session){var f=document.referrer;if(f!==undefined&&f!=null&&f!="null"){f=encodeURIComponent(f)}else{f=""}g="guid={0}&sid={1}&url={2}&agile={3}&new=1&ref={4}".format(d,e,c,a,f)}else{g="guid={0}&sid={1}&url={2}&agile={3}".format(d,e,c,a)}if(agile_guid.get_email()){g+="&email="+encodeURIComponent(agile_guid.get_email())}var b="https://"+agile_id.getNamespace()+".agilecrm.com/stats?callback=?&"+g;agile_json(b,h)}function agile_removeCommonTags(d,c){var f=d.length;while(--f>=0){var e=c.length;while(--e>=0){if(d[f]&&d[f].trim()==c[e].trim()){d.splice(f,1);f=d.length}}}return d}function agile_cookieTags(b,g){var h=agile_read_cookie("agile-tags");if(!h){if(g=="add"){agile_create_cookie("agile-tags",b,5*365)}return}var e=h.split(",");var a=b.split(",");agile_delete_cookie("agile-tags");if(g=="delete"){var f=agile_removeCommonTags(e,a);if(f.length>0){agile_create_cookie("agile-tags",f.toString(),5*365)}}if(g=="add"){var d=agile_removeCommonTags(a,e);var c=d.length;while(--c>=0){e.push(d[c])}agile_create_cookie("agile-tags",e.toString(),5*365)}return}function agile_formCallback(c,d,b,a,g){if(!c[0]){if(g){var f=document.getElementById("agile-form-data").innerHTML;var e=agile_id.getURL()+"/formsubmit?id="+agile_id.get()+"&contactid="+encodeURIComponent(g)+"&formname="+encodeURIComponent(f);agile_json(e)}}c[1].innerHTML=c[0];d.removeAttribute("disabled");setTimeout(function(){c[1].innerHTML="";if(a){if(!a.getAttribute("action")||a.getAttribute("action")=="#"){a.setAttribute("action",b)}a.submit()}else{window.location.replace(b)}},1500)}function _agile_load_form_fields(){var a=agile_read_cookie("agile-email");if(!a){return}_agile.get_contact(a,{success:function(f){if(f){var b={};var g=f.properties;for(var e=0;e<g.length;e++){b[g[e].name]=g[e].value}var d=document.getElementById("agile-form");for(var c=0;c<d.length;c++){if(b[d[c].name]){d[c].value=b[d[c].name]}}}},error:function(b){return}})}function agile_webRules(b){var a=agile_id.getURL()+"/web-rules?callback=?&id="+agile_id.get();agile_json(a,b)}function _agile_execute_web_rules(){_agile_require_js("https://agilegrabbers.appspot.com/demo/agile-webrules-min.js",function(){_agile_webrules()})}function _agile_require_js(d,c){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=d;if((navigator.appVersion).indexOf("MSIE")>0){a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}else{a.onload=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}var b=document.getElementsByTagName("head")[0];b.appendChild(a)}function agile_read_cookie(b){b=agile_id.get()+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function agile_create_cookie(c,e,g){c=agile_id.get()+"-"+c;if(g){var b=new Date();b.setTime(b.getTime()+(g*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}var d="";var f=window.location.hostname.replace(/([a-zA-Z0-9]+.)/,"");if(f.length>5){d=";document=."+f}document.cookie=c+"="+escape(e)+a+"; path=/"+d}function agile_createCookieInAllAgileSubdomains(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/; domain=agilecrm.com"}function agile_delete_cookie(a){agile_create_cookie(a,"",-1)}function agile_enable_console_logging(){var a=false;if(typeof console==="undefined"||!a){console={log:function(){},error:function(){}}}if(typeof(console.log)==="undefined"||!a){console.log=function(){return 0}}if(typeof(console.error)==="undefined"||!a){console.error=function(){return 0}}};
>>>>>>> bfb0e5c... formbuilder action, last modified
=======
function agile_setAccount(b,a){agile_id.set(b,a);agile_setEmailFromUrl()}function agile_setEmailFromUrl(){if(window.location.href.search("fwd=cd")!==-1){try{var a=decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI("data").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));if(a){agile_guid.set_email(JSON.parse(a).email)}}catch(b){console.log(b.message)}}}function agile_allowedDomains(b){var a=agile_id.getURL()+"/allowed-domains?callback=?&id="+agile_id.get();agile_json(a,b)}var _agile={set_account:function(b,a){agile_setAccount(b,a)},set_email:function(a){agile_setEmail(a)},track_page_view:function(a){agile_trackPageview(a)},create_contact:function(a,b){agile_createContact(a,b)},get_contact:function(a,b){agile_getContact(a,b)},delete_contact:function(a,b){agile_deleteContact(a,b)},add_tag:function(b,c,a){agile_addTag(b,c,a)},remove_tag:function(b,c,a){agile_removeTag(b,c,a)},add_score:function(b,c,a){agile_addScore(b,c,a)},subtract_score:function(b,c,a){agile_subtractScore(b,c,a)},add_note:function(b,c,a){agile_addNote(b,c,a)},set_property:function(b,c,a){agile_setProperty(b,c,a)},add_task:function(b,c,a){agile_addTask(b,c,a)},add_deal:function(b,c,a){agile_addDeal(b,c,a)},get_score:function(b,a){agile_getScore(b,a)},get_tags:function(b,a){agile_getTags(b,a)},get_notes:function(b,a){agile_getNotes(b,a)},get_tasks:function(b,a){agile_getTasks(b,a)},get_deals:function(b,a){agile_getDeals(b,a)},add_campaign:function(b,c,a){agile_addCampaign(b,c,a)},get_campaigns:function(b,a){agile_getCampaigns(b,a)},get_campaign_logs:function(b,a){agile_getCampaignlogs(b,a)},get_workflows:function(a){agile_getWorkflows(a)},get_pipelines:function(a){agile_getPipelines(a)},get_milestones:function(a){agile_getMilestones(a)},get_milestones_by_pipeline:function(a,b){agile_getMilestones_by_pipeline(a,b)},update_contact:function(b,c,a){agile_updateContact(b,c,a)},get_email:function(a){agile_getEmail(a)},create_company:function(a,b){agile_createCompany(a,b)},get_property:function(b,c,a){agile_getProperty(b,c,a)},remove_property:function(b,c,a){agile_removeProperty(b,c,a)},add_property:function(b,c,a){agile_setProperty(b,c,a)},web_rules:function(a){agile_webRules(a)},unsubscribe_campaign:function(b,c,a){agile_unsubscribeCampaign(b,c,a)},allowed_domains:function(a){agile_allowedDomains(a)}};function agile_addCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getCampaigns(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaigns?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getCampaignlogs(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-campaign-logs?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_getWorkflows(b){var a=agile_id.getURL()+"/contacts/get-workflows?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_unsubscribeCampaign(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/unsubscribe-campaign?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createContact(d,k){var h=[];for(var j in d){if(d.hasOwnProperty(j)&&j!="tags"){h.push(agile_propertyJSON(j,d[j]))}}var g=agile_read_cookie(agile_guid.cookie_original_ref);if(g){h.push(agile_propertyJSON("original_ref",g))}var a=agile_read_cookie("agile-tags");var f={};f.properties=h;if(d.tags){var m=d.tags;var e=m.trim().replace("/ /g"," ");e=e.replace("/, /g",",");f.tags=e.split(",");for(var c=0;c<f.tags.length;c++){f.tags[c]=f.tags[c].trim()}}if(a){agile_delete_cookie("agile-tags");var e=a.trim().replace("/ /g"," ");e=e.replace("/, /g",",");var b=e.split(",");if(f.tags){for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}else{f.tags=[];for(var c=0;c<b.length;c++){f.tags.push(b[c].trim())}}}var l=agile_id.getURL()+"/contacts?callback=?&id="+agile_id.get()+"&contact="+encodeURIComponent(JSON.stringify(f));agile_json(l,k)}function agile_deleteContact(b,c){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contact/delete?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}function agile_getContact(b,d){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var c="email={0}".format(encodeURIComponent(b));var a=agile_id.getURL()+"/contact/email?callback=?&id="+agile_id.get()+"&"+c;agile_json(a,d)}function agile_updateContact(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contact/update?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_createCompany(e,f){var d=[];for(var c in e){if(e.hasOwnProperty(c)){d.push(agile_propertyJSON(c,e[c]))}}var b={};b.properties=d;var a=agile_id.getURL()+"/company?callback=?&id="+agile_id.get()+"&data="+encodeURIComponent(JSON.stringify(b));agile_json(a,f)}function agile_propertyJSON(a,d,c){var b={};if(c==undefined){switch(a){case"first_name":case"last_name":case"email":case"company":case"title":case"name":case"url":case"website":case"address":case"phone":case"original_ref":b.type="SYSTEM";break;default:b.type="CUSTOM";break}}else{b.type=c}b.name=a;b.value=d;return b}var agile_json_timer;function agile_json(a,c){if(!document.body){clearInterval(agile_json_timer);agile_json_timer=setInterval(function(){agile_json(a,c)},100);return}clearInterval(agile_json_timer);var b="json"+(Math.random()*100).toString().replace(/\./g,"");window[b]=function(d){if(d.error){if(c&&typeof(c.error)=="function"){c.error(d)}return}if(c&&typeof(c.success)=="function"){c.success(d)}if(c&&typeof(c)=="function"){c(d)}};document.getElementsByTagName("body")[0].appendChild((function(){var d=document.createElement("script");d.type="application/javascript";d.src=a.replace("callback=?","callback="+b);return d})())}String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})};function agile_addDeal(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="opportunity={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/opportunity?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getDeals(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-deals?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setEmail(a){agile_guid.set_email(a)}function agile_getEmail(c){var b=agile_guid.get_email();var a=agile_id.getURL()+"/email?callback=?&id="+agile_id.get()+"&email="+encodeURIComponent(b);agile_json(a,c)}var _agile_synch_form_v2=function(){var f=document.getElementsByClassName("agile-button")[0];f.setAttribute("disabled","disabled");var q=document.getElementById("agile-error-msg");var h=document.createElement("img");h.src="https://s3.amazonaws.com/PopupTemplates/form/spin.gif";q.appendChild(h);var l=document.getElementById("agile-form");var s=document.getElementById("agile-form-data").getAttribute("name").split(" ");var j={};var g=s[2];var c=s[1];var e=s[0];var r=e+" "+c+" "+g+" ";var m=document.getElementById("agile-form-data").getAttribute("name").replace(r,"");var b={};var d;var p=[];for(var n=0;n<l.length;n++){var t=l[n].getAttribute("name");var k=l[n].value;if(t&&k){if("address, city, state, country, zip".indexOf(t)!=-1){b[t]=k}else{if(t=="tags"){if(d){d=d+","+k}else{d=k}}else{if(t=="note"){var o={};o.subject=l[n].parentNode.parentNode.getElementsByTagName("label")[0].innerHTML;o.description=k;p.push(o)}else{j[t]=k}}}}}b=JSON.stringify(b);if(b.length>2){j.address=b}if(d){if(m){j.tags=d+","+m}else{j.tags=d}}else{if(m){j.tags=m}}var a=j.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(c,e);_agile.track_page_view()}if(a){_agile.set_email(a)}_agile.create_contact(j,{success:function(v){var u=v.id;var w=0;if(p.length>0){for(var i=0;i<p.length;i++){_agile.add_note(p[i],{success:function(x){w++;if(w==p.length){agile_formCallback(["",q],f,g,l,u)}},error:function(x){agile_formCallback(["Error in sending data",q],f,g,l)}})}}else{agile_formCallback(["",q],f,g,l,u)}},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(j,{success:function(w){var v=w.id;var x=0;if(p.length>0){for(var u=0;u<p.length;u++){_agile.add_note(p[u],{success:function(y){x++;if(x==p.length){agile_formCallback(["",q],f,g,l,v)}},error:function(y){agile_formCallback(["Error in sending data",q],f,g,l)}})}}else{agile_formCallback(["",q],f,g,l,v)}},error:function(u){agile_formCallback(["Error in sending data",q],f,g,l)}})}else{agile_formCallback(["Error in sending data",q],f,g,l)}}})};var _agile_synch_form=function(){var k=document.getElementsByClassName("agile-button")[0];k.setAttribute("disabled","disabled");var b=document.getElementById("agile-error-msg");var o=document.getElementById("agile-form");var d=document.getElementById("agile-form-data");var c={};var l=d.getAttribute("agile-redirect-url");var h=d.getAttribute("agile-api");var j=d.getAttribute("agile-domain");var e={};var n;for(var f=0;f<o.length;f++){var a=o[f].getAttribute("agile-field");var m=o[f].value;if(a&&m){if("address, city, state, country, zip".indexOf(a)!=-1){e[a]=m}else{if(a=="tags"){if(n){n=n+","+m}else{n=m}}else{c[a]=m}}}}e=JSON.stringify(e);if(e.length>2){c.address=e}if(n){c.tags=n}var g=c.email;if(!(agile_id.get()&&agile_id.getNamespace())){_agile.set_account(h,j);_agile.track_page_view()}if(g){_agile.set_email(g)}_agile.create_contact(c,{success:function(i){agile_formCallback(["",b],k,l)},error:function(i){if(i.error.indexOf("Duplicate")!=-1){_agile.update_contact(c,{success:function(p){agile_formCallback(["",b],k,l)},error:function(p){agile_formCallback(["Error in sending data",b],k,l)}})}else{agile_formCallback(["Error in sending data",b],k,l)}}})};var agile_guid={init:function(){this.cookie_name="agile-crm-guid";this.cookie_email="agile-email";this.cookie_original_ref="agile-original-referrer";this.new_guid=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var a=agile_read_cookie(this.cookie_name);if(!a){a=this.generate()}return a},generate:function(){guid=this.random();agile_create_cookie(this.cookie_name,guid,365*5);this.set_original_referrer();this.new_guid=true;return guid},reset:function(){agile_create_cookie(this.cookie_name,"",-1)},set_email:function(a){var b=agile_read_cookie(this.cookie_email);if(!b||(b!=a)){this.email=a;if(b){this.reset();agile_session.reset()}agile_create_cookie(this.cookie_email,this.email,365*5)}},get_email:function(){if(this.email){return this.email}var a=agile_read_cookie(this.cookie_email);return a},set_original_referrer:function(){var a=document.referrer;if(a){agile_create_cookie(this.cookie_original_ref,a,365*5)}}};agile_guid.init();var agile_id={set:function(b,a){this.id=b;this.namespace=a},get:function(){return this.id},getURL:function(){if(!this.namespace||this.namespace=="localhost"){return"http://localhost:8888/core/js/api"}else{return"https://"+this.namespace+"-dot-sandbox-dot-agilecrmbeta.appspot.com/core/js/api"}},getNamespace:function(){return this.namespace}};function agile_getPipelines(b){var a=agile_id.getURL()+"/milestone/get-pipelines?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones(b){var a=agile_id.getURL()+"/contact/get-milestones?callback=?&id="+agile_id.get();agile_json(a,b)}function agile_getMilestones_by_pipeline(b,c){var a=agile_id.getURL()+"/milestone/get-milestones?callback=?&id="+agile_id.get()+"&pipeline_id="+b;agile_json(a,c)}function agile_addNote(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-note?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getNotes(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-notes?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_setProperty(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="data={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/add-property?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/get-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_removeProperty(c,d,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}if(!c){return}var a=agile_id.getURL()+"/contacts/remove-property?callback=?&id="+agile_id.get()+"&name="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_addScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/add-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_subtractScore(c,d,b){if(!c){return}if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/subtract-score?callback=?&id="+agile_id.get()+"&score="+c+"&email="+encodeURIComponent(b);agile_json(a,d)}function agile_getScore(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-score?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}var agile_session={init:function(){this.cookie_name="agile-crm-session_id";this.cookie_start_time="agile-crm-session_start_time";this.cookie_duration_secs=60*1000;this.new_session=false},random:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},get:function(){var b=agile_read_cookie(this.cookie_name);if(!b){return this.generate()}var a=agile_read_cookie(this.cookie_start_time);var c=new Date().getUTCSeconds();if((c<a)||(c>(a+this.cookie_duration_secs))){return this.generate()}return b},generate:function(){var a=this.random();agile_create_cookie(this.cookie_name,a,0);agile_create_cookie(this.cookie_start_time,new Date().getUTCSeconds(),0);this.new_session=true;return a},reset:function(){agile_create_cookie(this.cookie_name,"",-1);agile_create_cookie(this.cookie_start_time,"",-1)}};agile_session.init();function agile_addTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"add");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/add-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_removeTag(c,e,b){if(!c){return}if(!b){if(!agile_guid.get_email()){agile_cookieTags(c,"delete");return}else{b=agile_guid.get_email()}}var d="email={0}&tags={1}".format(encodeURIComponent(b),encodeURIComponent(c));var a=agile_id.getURL()+"/contacts/remove-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTags(e,c){if(!c){if(!agile_guid.get_email()){return}else{c=agile_guid.get_email()}}var b=agile_read_cookie("agile-tags");var d="email={0}&tags={1}".format(encodeURIComponent(c),encodeURIComponent(b));var a=agile_id.getURL()+"/contacts/get-tags?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_addTask(c,e,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var d="task={0}&email={1}".format(encodeURIComponent(JSON.stringify(c)),encodeURIComponent(b));var a=agile_id.getURL()+"/task?callback=?&id="+agile_id.get()+"&"+d;agile_json(a,e)}function agile_getTasks(c,b){if(!b){if(!agile_guid.get_email()){return}else{b=agile_guid.get_email()}}var a=agile_id.getURL()+"/contacts/get-tasks?callback=?&id="+agile_id.get()+"&"+"email={0}".format(encodeURIComponent(b));agile_json(a,c)}function agile_trackPageview(h){var d=agile_guid.get();var e=agile_session.get();var c=document.location.href;if(c!==undefined&&c!=null){c=encodeURIComponent(c)}else{c=""}var a=agile_id.get();var g="";if(agile_session.new_session){var f=document.referrer;if(f!==undefined&&f!=null&&f!="null"){f=encodeURIComponent(f)}else{f=""}g="guid={0}&sid={1}&url={2}&agile={3}&new=1&ref={4}".format(d,e,c,a,f)}else{g="guid={0}&sid={1}&url={2}&agile={3}".format(d,e,c,a)}if(agile_guid.get_email()){g+="&email="+encodeURIComponent(agile_guid.get_email())}var b="https://"+agile_id.getNamespace()+".agilecrm.com/stats?callback=?&"+g;agile_json(b,h)}function agile_removeCommonTags(d,c){var f=d.length;while(--f>=0){var e=c.length;while(--e>=0){if(d[f]&&d[f].trim()==c[e].trim()){d.splice(f,1);f=d.length}}}return d}function agile_cookieTags(b,g){var h=agile_read_cookie("agile-tags");if(!h){if(g=="add"){agile_create_cookie("agile-tags",b,5*365)}return}var e=h.split(",");var a=b.split(",");agile_delete_cookie("agile-tags");if(g=="delete"){var f=agile_removeCommonTags(e,a);if(f.length>0){agile_create_cookie("agile-tags",f.toString(),5*365)}}if(g=="add"){var d=agile_removeCommonTags(a,e);var c=d.length;while(--c>=0){e.push(d[c])}agile_create_cookie("agile-tags",e.toString(),5*365)}return}function agile_formCallback(c,d,b,a,g){if(!c[0]){if(g){var f=document.getElementById("agile-form-data").innerHTML;var e=agile_id.getURL()+"/formsubmit?id="+agile_id.get()+"&contactid="+encodeURIComponent(g)+"&formname="+encodeURIComponent(f);agile_json(e)}}else{c[1].innerHTML=c[0]}setTimeout(function(){c[1].innerHTML="";d.removeAttribute("disabled");if(a){if(!a.getAttribute("action")||a.getAttribute("action")=="#"){a.setAttribute("action",b)}a.submit()}else{window.location.replace(b)}},1500)}function _agile_load_form_fields(){var a=agile_read_cookie("agile-email");if(!a){return}_agile.get_contact(a,{success:function(f){if(f){var b={};var g=f.properties;for(var e=0;e<g.length;e++){b[g[e].name]=g[e].value}var d=document.getElementById("agile-form");for(var c=0;c<d.length;c++){if(b[d[c].name]){d[c].value=b[d[c].name]}}}},error:function(b){return}})}function agile_webRules(b){var a=agile_id.getURL()+"/web-rules?callback=?&id="+agile_id.get();agile_json(a,b)}function _agile_execute_web_rules(){_agile_require_js("https://agilegrabbers.appspot.com/demo/agile-webrules-min.js",function(){_agile_webrules()})}function _agile_require_js(d,c){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=d;if((navigator.appVersion).indexOf("MSIE")>0){a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}else{a.onload=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){c()}}}var b=document.getElementsByTagName("head")[0];b.appendChild(a)}function agile_read_cookie(b){b=agile_id.get()+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function agile_create_cookie(c,e,g){c=agile_id.get()+"-"+c;if(g){var b=new Date();b.setTime(b.getTime()+(g*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}var d="";var f=window.location.hostname.replace(/([a-zA-Z0-9]+.)/,"");if(f.length>5){d=";document=."+f}document.cookie=c+"="+escape(e)+a+"; path=/"+d}function agile_createCookieInAllAgileSubdomains(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/; domain=agilecrm.com"}function agile_delete_cookie(a){agile_create_cookie(a,"",-1)}function agile_enable_console_logging(){var a=false;if(typeof console==="undefined"||!a){console={log:function(){},error:function(){}}}if(typeof(console.log)==="undefined"||!a){console.log=function(){return 0}}if(typeof(console.error)==="undefined"||!a){console.error=function(){return 0}}};
>>>>>>> 0dbd64f... form builder loading img, changes as suggested
