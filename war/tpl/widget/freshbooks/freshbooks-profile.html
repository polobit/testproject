<script id="freshbooks-login-template" type="text/html">
	<div display:inline;  line-height:12px;word-wrap: break-word;">
		<form class="widget_content" style="border-bottom:none;" id="freshbooks_login_form" name="freshbooks_login_form" method="post">
	    	<fieldset>
				<p style='line-height:140%;'>Create and manage customer invoices and track payments with Freshbooks. </p>
				<p>
				<label>Enter your Freshbooks details: </label>
				<div class="control-group" style="margin-bottom:0px;"><div class="controls"><input type="url" id="freshbooks_url" class="input-medium required" style="width:90%" placeholder="https://company.freshbooks.com" value="" name="freshbooks_url"></input></div></div>
				<div class="control-group" style="margin-bottom:0px;"><div class="controls"><input type="text" id="freshbooks_apiKey" class="input-medium required" style="width:90%" placeholder="API Token" value="" name="freshbooks_apiKey"></input></div></div>
				</p>
				<a href="#" id="freshbooks_save_token" class="btn btn-primary" style="text-decoration:none;">Save</a>
				<a href="#add-widget" class="btn ml_5" style="text-decoration:none;">Cancel</a>
			 </fieldset>
	    </form>
	</div>
</script>

<script id="freshbooks-profile-template" type="text/html">
{{#if_equals total "0"}}
	<div class="widget_content">
		<div>No clients matching this contact.</div>
		<a class="btn" id="freshbooks_add_client" style="margin-top:10px;cursor:pointer;"><i class="icon-plus"></i>Add client</a>
	</div>
{{else}}
	<div class="widget_content">
		{{#isArray client}}
			{{#if client.0.username}}
				<div  style="display:inline-block;font-size:13px;">
					<div  class="title_txt" style="display:inline-block;">
						<a href="{{client.0.links.statement}}" target="_blank"><h4 style="text-transform: capitalize;">
							{{#if_equals client.0.first_name ""}}{{#if_equals client.0.last_name ""}}
								{{getCurrentContactProperty "first_name"}} {{getCurrentContactProperty "last_name"}}{{/if_equals}}
							{{else}}
								{{client.0.first_name}} {{client.0.last_name}}
							{{/if_equals}}
						</h4></a>
					</div>
					{{#if_equals client.0.organization ""}}<div></div>{{else}}, <div style="display:inline-block;"><a href="{{client.0.links.view}}" target="_blank"><h4 style="text-transform: capitalize;">{{client.0.organization}}</h4></a></div>{{/if_equals}}
				</div>
			{{/if}}
			<p style="font-size:14px;margin-bottom:0px;">
				{{#if client.0.p_street1}}
					{{client.0.p_street1}}
				{{/if}}
				{{#if client.0.p_street2}}
					{{client.0.p_street2}}
				{{/if}}
				{{#if client.0.p_state}}			
					{{client.0.p_state}}, 
				{{/if}}
				{{#if client.0.p_country}}
					{{client.0.p_country}}
				{{/if}}
			</p>
			{{#if client.0.home_phone}}<i class="icon-phone"></i><a href="tel:{{client.0.home_phone}}" > {{client.0.home_phone}} (home)<br> </a>{{/if}}
			{{#if client.0.work_phone}}<i class="icon-phone"></i><a href="tel:{{client.0.work_phone}}" > {{client.0.work_phone}} (work)<br> </a>{{/if}}
			{{#if client.0.mobile}}<i class="icon-mobile-phone"></i><a href="tel:{{client.0.mobile}}"> {{client.0.mobile}} (mobile)</a>{{/if}}
		{{else}}
			{{#if client.username}}
				<div style="display:inline-block;">
					<div class="title_txt" style="display:inline-block;">
						<a href="{{client.links.statement}}" target="_blank"><h4 style="text-transform: capitalize;"><b>
							{{#if_equals client.first_name ""}}{{#if_equals client.last_name ""}}
								{{getCurrentContactProperty "first_name"}} {{getCurrentContactProperty "last_name"}}{{/if_equals}}
							{{else}}
								{{client.first_name}} {{client.last_name}}
							{{/if_equals}}
						</b></h4></a>
					</div>
					{{#if_equals client.organization ""}}<div></div>{{else}}, <div style="display:inline-block;"><a href="{{client.links.view}}" target="_blank"><h4 style="text-transform: capitalize;">{{client.organization}}</h4></a></div>{{/if_equals}}
				</div>
			{{/if}}
			<p style="font-size:14px;margin-bottom:6px;">
				{{#if client.p_street1}}
					{{client.p_street1}},
				{{/if}}
				{{#if client.p_street2}}
					{{client.p_street2}},
				{{/if}}
				{{#if client.p_state}}			
					{{client.p_state}}, 
				{{/if}}
				{{#if client.p_country}}
					{{client.p_country}}
				{{/if}}
			</p>	
			{{#if client.home_phone}}<i class="icon-phone"></i><a href="tel:{{client.home_phone}}" > {{client.home_phone}} (home)<br> </a>{{/if}}
			{{#if client.work_phone}}<i class="icon-phone"></i><a href="tel:{{client.work_phone}}" > {{client.work_phone}} (work)<br> </a>{{/if}}
			{{#if client.mobile}}<i class="icon-phone"></i><a href="tel:{{client.mobile}}"> {{client.mobile}} (mobile)</a>{{/if}}
		{{/isArray}}
		<div><a class="btn" id="freshbooks_add_invoice" item_name={{name}} rel="tooltip" title="Generate invoice and send an email for this item" style="display:none; cursor:pointer">Add Invoice</a></div>
	</div>
	<div class="sub_header">
		{{#isArray client}}
			<a href="{{client.0.links.statement}}" target="_blank"><h4>Invoices</h4></a>
		{{else}}
			<a href="{{client.links.statement}}" target="_blank"><h4>Invoices</h4></a>
		{{/isArray}}
	</div>
	<ul style="margin:0px;" id="freshbooks_invoice_panel">
		<li>
			<center><img id="freshbooks_invoice_load" src="img/ajax-loader-cursor.gif" style="margin-top: 14px;margin-bottom: 10px;"></img></center>
		</li>
	</ul>
{{/if_equals}}
</script>

<script id="freshbooks-invoice-template" type="text/html">
	{{#if_equals total "0"}}
		<li class="sub_header_li" style='color: #999;'>
	    	No invoices			
		</li>		
	{{else}}
		<li class="sub_header row-fluid" style="padding-bottom: 0px;">
			<div class="span6" style="font-size:14px;">Status</div>
			<div class="span6" style="text-align: right;font-size:14px;">Amount</div>
		</li>
		{{#isArray invoice}}
			{{#each invoice}}
				<li class="row-fluid sub_header_li">
					<a class="pull-left" data-toggle="collapse" href="#collapse-{{invoice_id}}" >{{ucfirst status}}</a>
					<div class="pull-right">$ {{amount}}</div><br>
					<div id="collapse-{{invoice_id}}" class="collapse" style="color: rgba(0, 0, 0, 0.5);">
						{{#isArray lines.line}}						
							{{#each lines.line}}	
								{{#if name}}
									<div class="pull-left">{{name}}</div>					
									<div class="pull-right">$ {{amount}}</div><br>
									{{#if tax1_name}}				
										<div class="pull-left">{{tax1_name}}</div>
										<div class="pull-right">{{tax1_percent}}%</div><br>
									{{/if}}
									{{#if tax2_name}}				
										<div class="pull-left">{{tax2_name}}</div>
										<div class="pull-right">{{tax2_percent}}%</div><br>
									{{/if}}
								{{/if}}	         
							{{/each}}					
						{{else}}
							{{#if lines.line.name}}
								<div class="pull-left">{{lines.line.name}}</div>
								<div class="pull-right">$ {{lines.line.amount}}</div><br>
								{{#if lines.line.tax1_name}}				
									<div class="pull-left">{{lines.line.tax1_name}}</div>
									<div class="pull-right">{{lines.line.tax1_percent}}%</div><br>
								{{/if}}
								{{#if lines.line.tax2_name}}				
									<div class="pull-left">{{lines.line.tax2_name}}</div>
									<div class="pull-right">{{lines.line.tax2_percent}}%</div><br>
								{{/if}}
							{{/if}}
						{{/isArray}}
						{{#if discount}}
							<div class="pull-left">Discount</div>
							<div class="pull-right">{{discount}}%</div><br>
						{{/if}}
					</div>
					<small><time class="time-ago pull-left" datetime="{{updated}}">{{updated}}</time></small>
				</li>
			{{/each}}
		{{else}}
			<li class="row-fluid sub_header_li">
					<a class="pull-left" data-toggle="collapse" href="#collapse-{{invoice.invoice_id}}" >{{ucfirst invoice.status}}</a>
					<div class="pull-right">{{invoice.amount}}</div><br>
					<div id="collapse-{{invoice.invoice_id}}" class="collapse" style="color: rgba(0, 0, 0, 0.5);">
						{{#isArray invoice.lines.line}}      
							{{#each invoice.lines.line}}	
								{{#if name}}
									<div class="pull-left">{{name}}</div>					
									<div class="pull-right">$ {{amount}}</div><br>
									{{#if tax1_name}}
										<div class="pull-left">{{tax1_name}}</div>
										<div class="pull-right">{{tax1_percent}}%</div><br>
									{{/if}}
									{{#if tax2_name}}<br>				
										<div class="pull-left">{{tax2_name}}</div>
										<div class="pull-right">{{tax2_percent}}%</div><br>
									{{/if}}
								{{/if}}
							{{/each}}
						{{else}}
							{{#if invoice.lines.line.name}}
								<div class="pull-left">{{invoice.lines.line.name}}</div>
								<div class="pull-right">$ {{invoice.lines.line.amount}}</div><br>
								{{#if invoice.lines.line.tax1_name}}				
									<div class="pull-left">{{invoice.lines.line.tax1_name}}</div>
									<div class="pull-right">{{invoice.lines.line.tax1_percent}}%</div><br>
								{{/if}}
								{{#if invoice.lines.line.tax2_name}}
									<div class="pull-left">{{invoice.lines.line.tax2_name}}</div>
									<div class="pull-right">{{invoice.lines.line.tax2_percent}}%</div><br>
								{{/if}}
							{{/if}}
						{{/isArray}}
						{{#if invoice.discount}}
							<div class="pull-left">Discount</div>
							<div class="pull-right">{{invoice.discount}}%</div><br>
						{{/if}}
					</div>
					<small><time class="time-ago pull-left" datetime="{{invoice.updated}}">{{invoice.updated}}</time></small>
			</li>
		{{/isArray}}
	{{/if_equals}}
</script>

<script id="freshbooks-items-template" type="text/html">
	{{#if_equals total "0"}}
		<li class="sub_header_li" style='color: #999;'>
	    	No Items available. Add an item in your account to generate invoice.
		</li>		
	{{else}}
		<li class="sub_header row-fluid" style="padding-bottom: 0px;">
			<div class="span6">Item name</div>
			<div class="span6" style="text-align: right;">Unit cost</div>
		</li>
		{{#isArray item}}
			{{#each item}}
				<li class="row-fluid">
					<div class="pull-left" rel="tooltip" title="{{description}}">{{name}}</div>
					<div class="pull-right">{{unit_cost}}</div><br>
					<ul class="widget_tab_link" style="float:left;margin:0px">
						<li><a href="#add" id="freshbooks_add_invoice" item_name={{name}} rel="tooltip" title="Generate invoice and send an email for this item">Add Invoice</a></li>
						<li><small><time class="time-ago pull-left l_border" datetime="{{updated}}">{{updated}}</time></small></li>
					</ul>
				</li>
			{{/each}}
		{{else}}
			<li class="row-fluid">
				<div class="pull-left" rel="tooltip" title="{{item.description}}">{{item.name}}</div>
				<div class="pull-right">{{item.unit_cost}}</div><br>
				<small><time class="time-ago pull-left" datetime="{{item.updated}}">{{item.updated}}</time></small>
				<ul class="widget_tab_link" style="float:left;margin:0px">
					<li><a href="#add" id="freshbooks_add_invoice" item_name={{item.name}} rel="tooltip" title="Generate invoice and send an email for this item">Add Invoice</a></li>
					<li><small><time class="time-ago pull-left l_border" datetime="{{item.updated}}">{{item.updated}}</time></small></li>
				</ul>
			</li>
		{{/isArray}}
	{{/if_equals}}
</script>

<script id="freshbooks-modal-template" type="text/html">
	<div class="modal hide fade message-modal" id="freshbooks_addModal">
	    <div class="modal-header">
	        <button class="close" data-dismiss="modal">x</button>
			<h3><i class="icon-plus-sign"></i> {{headline}}</h3>
	    </div>
	    <div class="modal-body agile-modal-body">
	        <form id="freshbooks_addForm" name="freshbooks_addForm" method="post">
	            <fieldset>
					<div style="margin-bottom:10px;">{{info}}</div>
	                <input name="freshbooks_id" type="hidden" value="" />
	                <div class="control-group">	                    
	                    <div class="controls">
							<table id="invoice-table" class="table table-bordered" table-layout:fixed;width:auto;>
								<thead style="background: rgba(240, 240, 240, .2);">
									<tr>
									<th >Item</th>
									<th >Description</th>
									<th >Unit Cost</th>
									<th >Quantity</th>
									<th >Tax1</th>
									<th >Tax2</th>
									<th >Line Total</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td id="item_names">
											<select name="items_name" id="item-select" style="width:auto;">
												<option value=""></option>
												{{#isArray items.item}}
													{{#each items.item}}
														<option value="{{name}}">{{name}}</option>
													{{/each}}
												{{else}}
													<option value="{{items.item.name}}">{{items.item.name}}</option>
												{{/isArray}}
											</select>
										</td>
										<td id="item_description" >
												<input  name="description" style="width:auto;"/>
												{{#isArray items.item}}
													{{#each items.item}}
														<input type="text" name="description" id="item_desc" class="{{name}}" style="width:auto;" value="{{description}}"/>
													{{/each}}
												{{else}}
													<input type="text" name="description" id="item_desc" class="{{items.item.name}}" style="width:auto;" value="{{items.item.description}}"/>
												{{/isArray}}
										</td>
										<td id="item_cost" >
												<input type="text" style="width:auto;"/>
												{{#isArray items.item}}
													{{#each items.item}}
														<input type="text" value="{{unit_cost}}" name="unit_cost" id="unit-cost" max="100" min="1" class="{{name}} number" style="width:auto;"/>
													{{/each}}
												{{else}}
													<input type="text" value="{{items.item.unit_cost}}" name="unit_cost" max="100" min="1" id="unit-cost" class="{{items.item.name}} number"  style="width:auto;" />
												{{/isArray}}
										</td>
										<td id="item_quantity" >
											<input type="text" style="width:auto;"/>
												{{#isArray items.item}}
													{{#each items.item}}
														<input type="number" value="1" name="quantity" id="quantity" max="100" min="1"  class="{{name}} digits" style="width:auto;"/>
													{{/each}}
												{{else}}
													<input type="number" value="1" name="quantity" id="quantity" max="30" min="1" class="{{items.item.name}} digits" style="width:auto;"/>
												{{/isArray}}
										</td>
										<td id="item_tax1" >
											<select name="tax_name" id="item-tax1" style="width:auto;" >
												<option value=""></option>
												{{#isArray taxes.tax}}
													{{#each taxes.tax}}
														<option value="{{name}}_tax1" rate="{{rate}}">{{name}}</option>
													{{/each}}
												{{else}}
													<option value="{{taxes.tax.name}}_tax1" rate="{{taxes.tax.rate}}">{{taxes.tax.name}}</option>
												{{/isArray}}
											</select>
										</td>
										<td id="item_tax2" >
											<select name="tax_name" id="item-tax2" style="width:auto;" >
												<option value=""></option>	
												{{#isArray taxes.tax}}
													{{#each taxes.tax}}
														<option value="{{name}}_tax2" rate="{{rate}}">{{name}}</option>
													{{/each}}
												{{else}}
													<option value="{{taxes.tax.name}}_tax2" rate="{{taxes.tax.rate}}">{{taxes.tax.name}}</option>
												{{/isArray}}
											</select>
										</td>
										<td id="item_total">
											<input type="text" placeholder="total" name="line_total" id="line-total" class="" style="width:auto;"/>
										</td>
									</tr>
								</tbody>
							</table>
							<i class="add_lines icon-plus"></i>
						</div>
                	</div>
                </div>
            </fieldset>
        </form>
    </div>
    <div class="modal-footer">
       <a href="#" class="btn btn-primary" id="send_request">Send</a>
       <span class="save-status"></span>
    </div>
</div>
</script>

<script id="freshbooks-error-template" type="text/html">
{{#check_length message "140"}}
	<div class="ellipsis-multi-line collapse-25" title="{{message}}" style="height:110px;overflow: hidden;line-height:160%;word-wrap: break-word;padding:0px">
		{{message}}
	</div>
{{else}}
	<div style="line-height:160%;word-wrap: break-word;padding:0px">
		{{message}}
	</div>
{{/check_length}}
</script>