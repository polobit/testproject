<script id="opportunities-by-milestones-collection-template" type="text/html">
<div class="row">
    <div class="span12">
        <div class="page-header">
            <h1>Deals <small>Opportunities</small></h1>
			<a href="#deals-add" class="deals-add btn right" style="top:-30px;position: relative;"><i class="icon-plus-sign" /> Add Deal</a>
			<div class="btn-group right" id="deals-view"
				style="display: inline; top: -30px;margin-right:20px;">
					<div class="btn"><i class="icon-list" style="margin-right:3px"></i></div>
					<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
						<span class="caret"></span>
					</a>
					<ul class="dropdown-menu pull-right">
						<li><a href="#" class="deals-list-view">List</a></li>
						<li><a href="#" class="deals-pipelined-view">Milestone</a></li>
					</ul>
			</div>
        </div>
    </div>
</div>
<div class="row">
    <div class="span9">
        <div id="slate">
        </div>
        {{#if this.length}}
        <div id="total-pipeline-chart" style="width:100%; height:300px"></div>
        <br /><br />
        <div class="row-fluid">
			<span><a id="deals-full-screen" href="#deals-full-screen" style="float:right;margin-top:-16px;"><i class="icon-resize-full"></i></a></span>
			<div id="opportunities-by-milestones-model-list"></div>
        </div>
        {{/if}}
    </div>
    <div class="span3">
        <div class="data-block">
            <div class="well">
                <header>
                    <h3><span><i class="icon-flag"></i></span> Milestones</h3>
                </header>
                <div id="pie-deals-chart" style="width:100%; height:400px"></div>
                <h3 style="margin-top:10px;">
                    What are Milestones?
                </h3>
                <br />
                <p>
                    Milestones are used to define the status of the deal.
                </p>
                <p>
                    e.g. Use 'Won' in case of a successfully completed deal or 'New' for a newly added deal. You can define custom milestones.
                </p>
                <br />
                <h3>
                    What are Deals?
                </h3>
                <br />
                <p>
                    Deals are opportunities you can continuously track throughout its life cycle. You may add contacts related to the deal, add description, monetary value and timelines. You can also setup milestones to constantly track the status of the deal.
                </p>
            </div>
        </div>
    </div>
</div>
</script>

<script id="opportunities-by-milestones-model-template" type="text/html">
{{#deals_by_milestones this}}{{/deals_by_milestones}}
</script>

<script id="opportunities-grid-view-template" type="text/html">
<div data="{{id}}" class="data agile-overflow-ellipsis">
	<div>
		<b style="max-width: 65%;overflow: hidden;display: inline-block;text-overflow: ellipsis;line-height: 14px;float:left;">{{name}}</b>
		<span class="right deal-options" style="visibility:hidden;">
			<a title="Edit" class="deal-edit" style="cursor:pointer;text-decoration:none;"> <i style="width: 0.9em!important;" class="icon-pencil"></i> </a>
            <a title="Delete" class="deal-delete" style="cursor:pointer;text-decoration:none;"><i style="width: 0.9em!important;" class="icon-trash"></i></a>
        </span>
		<span class="right" style="padding-right:5px;">
			{{#if notes}}
             <a title="Notes" data-toggle="tooltip" data-placement="top" data-trigger="hover" data-container="No Notes" class="deal-notes" style="cursor:pointer;text-decoration:none;"><i class="deal-action icon icon-comment deal-notes" data="{{id}}" title="Notes"></i></a>
              <span class="txt-small note-count" title="Notes">{{notes.length}}</span>
			{{else}}
				<a href="#" data-toggle="tooltip" data-placement="top" data-trigger="hover" data-container="No Notes" title="Notes" class="deal-notes" style="cursor:pointer;text-decoration:none;"><i class="task-action icon icon-comment-alt deal-notes" data="{{id}}" title="Notes"></i></a>
			{{/if}}
		</span>
		<div class="clearfix"</div>
	</div>
	<div class="agile-overflow-ellipsis">
		<span>{{currencySymbol}} {{numberWithCommas expected_value}}</span>
		{{#if this.contacts}}
			<span style="margin:0px 5px;border:1px solid #d5d5d5"></span>
			{{#related_to_one contacts}}{{/related_to_one}}
		{{/if}}{{#if_greater this.contacts.length "5"}}<span>,..</span>{{/if_greater}}
	</div>
	<div>
		<small>
			<time class="deal-close-time" datetime="{{epochToHumanDate "" close_date}}" style="border-bottom:dotted 1px #999;">{{epochToHumanDate "ddd mmm dd yyyy HH:MM:ss" close_date}}</time>
		</small>
	</div>
</div>
</script>

<script id="related-to-contacts-template" type="text/html">
	{{#if_contact_type "PERSON"}}	
		<a href="#contact/{{id}}">{{getPropertyValue properties "first_name"}} {{getPropertyValue properties "last_name"}}</a>
    {{/if_contact_type}}
	{{#if_contact_type "COMPANY"}}
     	<a href="#contact/{{id}}">{{getPropertyValue properties "name"}}</a>
    {{/if_contact_type}}
</script>